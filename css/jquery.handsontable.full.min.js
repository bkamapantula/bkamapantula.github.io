var Handsontable={extension:{},helper:{}};(function(e,t,i){"use strict";if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e){var t=this.length>>>0;var i=Number(arguments[1])||0;i=i<0?Math.ceil(i):Math.floor(i);if(i<0)i+=t;for(;i<t;i++){if(i in this&&this[i]===e)return i}return-1}}if(!Array.prototype.filter){Array.prototype.filter=function(e,t){"use strict";if(typeof this==="undefined"||this===null){throw new TypeError}if(typeof e!=="function"){throw new TypeError}t=t||this;if(s(t)){t=a(t)}var i=t.length,o=[],n,r;for(n=0;n<i;n+=1){if(t.hasOwnProperty(n)){r=t[n];if(e.call(t,r,n,t)){o.push(r)}}}return o;function s(e){return/NodeList/i.test(e.item)}function a(e){var t=[];for(var i=0,o=e.length;i<o;i++){t[i]=e[i]}return t}}}if(typeof WeakMap==="undefined"){(function(){var e=Object.defineProperty;try{var i=true;e(function(){},"foo",{})}catch(o){i=false}var n=+new Date%1e9;var r=function(){this.name="__st"+(Math.random()*1e9>>>0)+(n++ +"__");if(!i){this._wmCache=[]}};if(i){r.prototype={set:function(t,i){var o=t[this.name];if(o&&o[0]===t)o[1]=i;else e(t,this.name,{value:[t,i],writable:true})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:undefined},delete:function(e){this.set(e,undefined)}}}else{r.prototype={set:function(e,t){if(typeof e=="undefined"||typeof t=="undefined")return;for(var i=0,o=this._wmCache.length;i<o;i++){if(this._wmCache[i].key==e){this._wmCache[i].value=t;return}}this._wmCache.push({key:e,value:t})},get:function(e){if(typeof e=="undefined")return;for(var t=0,i=this._wmCache.length;t<i;t++){if(this._wmCache[t].key==e){return this._wmCache[t].value}}return},delete:function(e){if(typeof e=="undefined")return;for(var t=0,i=this._wmCache.length;t<i;t++){if(this._wmCache[t].key==e){Array.prototype.slice.call(this._wmCache,t,1)}}}}}t.WeakMap=r})()}i.activeGuid=null;i.Core=function(n,r){var s,a,l,c,h,u,f=this,d=function(){};i.helper.extend(d.prototype,o.prototype);i.helper.extend(d.prototype,r);i.helper.extend(d.prototype,C(r));this.rootElement=n;var p=e(document.documentElement);var g=e(document.body);this.guid="ht_"+i.helper.randomString();if(!this.rootElement[0].id){this.rootElement[0].id=this.guid}s={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new d,settingsFromDOM:{},selStart:new i.SelectionPoint,selEnd:new i.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:true};l={alter:function(e,t,o,n,r){var h;o=o||1;switch(e){case"insert_row":h=a.createRow(t,o);if(h){if(s.selStart.exists()&&s.selStart.row()>=t){s.selStart.row(s.selStart.row()+h);c.transformEnd(h,0)}else{c.refreshBorders()}}break;case"insert_col":h=a.createCol(t,o);if(h){if(i.helper.isArray(f.getSettings().colHeaders)){var u=[t,0];u.length+=h;Array.prototype.splice.apply(f.getSettings().colHeaders,u)}if(s.selStart.exists()&&s.selStart.col()>=t){s.selStart.col(s.selStart.col()+h);c.transformEnd(0,h)}else{c.refreshBorders()}}break;case"remove_row":a.removeRow(t,o);s.cellSettings.splice(t,o);l.adjustRowsAndCols();c.refreshBorders();break;case"remove_col":a.removeCol(t,o);for(var d=0,p=a.getAll().length;d<p;d++){if(d in s.cellSettings){s.cellSettings[d].splice(t,o)}}if(i.helper.isArray(f.getSettings().colHeaders)){if(typeof t=="undefined"){t=-1}f.getSettings().colHeaders.splice(t,o)}s.columnSettings.splice(t,o);l.adjustRowsAndCols();c.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"');break}if(!r){l.adjustRowsAndCols()}},adjustRowsAndCols:function(){var e,t,i=f.countEmptyRows(true),o;t=f.countRows();if(t<s.settings.minRows){for(e=0;e<s.settings.minRows-t;e++){a.createRow(f.countRows(),1,true)}}if(i<s.settings.minSpareRows){for(;i<s.settings.minSpareRows&&f.countRows()<s.settings.maxRows;i++){a.createRow(f.countRows(),1,true)}}o=f.countEmptyCols(true);if(!s.settings.columns&&f.countCols()<s.settings.minCols){for(;f.countCols()<s.settings.minCols;o++){a.createCol(f.countCols(),1,true)}}if(!s.settings.columns&&f.dataType==="array"&&o<s.settings.minSpareCols){for(;o<s.settings.minSpareCols&&f.countCols()<s.settings.maxCols;o++){a.createCol(f.countCols(),1,true)}}if(s.settings.enterBeginsEditing){for(;(s.settings.minRows||s.settings.minSpareRows)&&f.countRows()>s.settings.minRows&&(s.settings.minSpareRows&&i>s.settings.minSpareRows);i--){a.removeRow()}}if(s.settings.enterBeginsEditing&&!s.settings.columns){for(;(s.settings.minCols||s.settings.minSpareCols)&&f.countCols()>s.settings.minCols&&(s.settings.minSpareCols&&o>s.settings.minSpareCols);o--){a.removeCol()}}var n=f.countRows();var r=f.countCols();if(n===0||r===0){c.deselect()}if(s.selStart.exists()){var l;var h=s.selStart.row();var u=s.selStart.col();var d=s.selEnd.row();var p=s.selEnd.col();if(h>n-1){h=n-1;l=true;if(d>h){d=h}}else if(d>n-1){d=n-1;l=true;if(h>d){h=d}}if(u>r-1){u=r-1;l=true;if(p>u){p=u}}else if(p>r-1){p=r-1;l=true;if(u>p){u=p}}if(l){f.selectCell(h,u,d,p)}}},populateFromArray:function(e,t,o,n,r){var a,l,c,h,u=[],d={};l=t.length;if(l===0){return false}var p,g,m,v;switch(r){case"shift_down":p=o?o.col-e.col+1:0;g=o?o.row-e.row+1:0;t=i.helper.translateRowsToColumns(t);for(c=0,h=t.length,m=Math.max(h,p);c<m;c++){if(c<h){for(a=0,l=t[c].length;a<g-l;a++){t[c].push(t[c][a%l])}t[c].unshift(e.col+c,e.row,0);f.spliceCol.apply(f,t[c])}else{t[c%h][0]=e.col+c;f.spliceCol.apply(f,t[c%h])}}break;case"shift_right":p=o?o.col-e.col+1:0;g=o?o.row-e.row+1:0;for(a=0,l=t.length,v=Math.max(l,g);a<v;a++){if(a<l){for(c=0,h=t[a].length;c<p-h;c++){t[a].push(t[a][c%h])}t[a].unshift(e.row+a,e.col,0);f.spliceRow.apply(f,t[a])}else{t[a%l][0]=e.row+a;f.spliceRow.apply(f,t[a%l])}}break;case"overwrite":default:d.row=e.row;d.col=e.col;for(a=0;a<l;a++){if(o&&d.row>o.row||!s.settings.minSpareRows&&d.row>f.countRows()-1||d.row>=s.settings.maxRows){break}d.col=e.col;h=t[a]?t[a].length:0;for(c=0;c<h;c++){if(o&&d.col>o.col||!s.settings.minSpareCols&&d.col>f.countCols()-1||d.col>=s.settings.maxCols){break}if(!f.getCellMeta(d.row,d.col).readOnly){u.push([d.row,d.col,t[a][c]])}d.col++;if(o&&c===h-1){c=-1}}d.row++;if(o&&a===l-1){a=-1}}f.setDataAtCell(u,null,null,n||"populateFromArray");break}},getCornerCoords:function(t){function i(t,i,o){function n(e){return e[o]}if(Array.prototype.map){return t.apply(Math,i.map(n))}return t.apply(Math,e.map(i,n))}return{TL:{row:i(Math.min,t,"row"),col:i(Math.min,t,"col")},BR:{row:i(Math.max,t,"row"),col:i(Math.max,t,"col")}}},getCellsAtCoords:function(e,t){var i=l.getCornerCoords([e,t]);var o,n,r=[];for(o=i.TL.row;o<=i.BR.row;o++){for(n=i.TL.col;n<=i.BR.col;n++){r.push(f.view.getCellAtCoords({row:o,col:n}))}}return r}};this.selection=c={inProgress:false,begin:function(){f.selection.inProgress=true},finish:function(){var e=f.getSelected();f.PluginHooks.run("afterSelectionEnd",e[0],e[1],e[2],e[3]);f.PluginHooks.run("afterSelectionEndByProp",e[0],f.colToProp(e[1]),e[2],f.colToProp(e[3]));f.selection.inProgress=false},isInProgress:function(){return f.selection.inProgress},setRangeStart:function(e){s.selStart.coords(e);c.setRangeEnd(e)},setRangeEnd:function(e,t){f.selection.begin();s.selEnd.coords(e);if(!s.settings.multiSelect){s.selStart.coords(e)}f.view.wt.selections.current.clear();f.view.wt.selections.current.add(s.selStart.arr());f.view.wt.selections.area.clear();if(c.isMultiple()){f.view.wt.selections.area.add(s.selStart.arr());f.view.wt.selections.area.add(s.selEnd.arr())}if(s.settings.currentRowClassName||s.settings.currentColClassName){f.view.wt.selections.highlight.clear();f.view.wt.selections.highlight.add(s.selStart.arr());f.view.wt.selections.highlight.add(s.selEnd.arr())}f.PluginHooks.run("afterSelection",s.selStart.row(),s.selStart.col(),s.selEnd.row(),s.selEnd.col());f.PluginHooks.run("afterSelectionByProp",s.selStart.row(),a.colToProp(s.selStart.col()),s.selEnd.row(),a.colToProp(s.selEnd.col()));if(t!==false){f.view.scrollViewport(e)}c.refreshBorders()},refreshBorders:function(e,t){if(!t){h.destroyEditor(e)}f.view.render();if(c.isSelected()&&!t){h.prepareEditor()}},isMultiple:function(){return!(s.selEnd.col()===s.selStart.col()&&s.selEnd.row()===s.selStart.row())},transformStart:function(e,t,i){if(s.selStart.row()+e>f.countRows()-1){if(i&&s.settings.minSpareRows>0){f.alter("insert_row",f.countRows())}else if(s.settings.autoWrapCol){e=1-f.countRows();t=s.selStart.col()+t==f.countCols()-1?1-f.countCols():1}}else if(s.settings.autoWrapCol&&s.selStart.row()+e<0&&s.selStart.col()+t>=0){e=f.countRows()-1;t=s.selStart.col()+t==0?f.countCols()-1:-1}if(s.selStart.col()+t>f.countCols()-1){if(i&&s.settings.minSpareCols>0){f.alter("insert_col",f.countCols())}else if(s.settings.autoWrapRow){e=s.selStart.row()+e==f.countRows()-1?1-f.countRows():1;t=1-f.countCols()}}else if(s.settings.autoWrapRow&&s.selStart.col()+t<0&&s.selStart.row()+e>=0){e=s.selStart.row()+e==0?f.countRows()-1:-1;t=f.countCols()-1}var o=f.countRows();var n=f.countCols();var r={row:s.selStart.row()+e,col:s.selStart.col()+t};if(r.row<0){r.row=0}else if(r.row>0&&r.row>=o){r.row=o-1}if(r.col<0){r.col=0}else if(r.col>0&&r.col>=n){r.col=n-1}c.setRangeStart(r)},transformEnd:function(e,t){if(s.selEnd.exists()){var i=f.countRows();var o=f.countCols();var n={row:s.selEnd.row()+e,col:s.selEnd.col()+t};if(n.row<0){n.row=0}else if(n.row>0&&n.row>=i){n.row=i-1}if(n.col<0){n.col=0}else if(n.col>0&&n.col>=o){n.col=o-1}c.setRangeEnd(n)}},isSelected:function(){return s.selEnd.exists()},inInSelection:function(e){if(!c.isSelected()){return false}var t=l.getCornerCoords([s.selStart.coords(),s.selEnd.coords()]);return t.TL.row<=e.row&&t.BR.row>=e.row&&t.TL.col<=e.col&&t.BR.col>=e.col},deselect:function(){if(!c.isSelected()){return}f.selection.inProgress=false;s.selEnd=new i.SelectionPoint;f.view.wt.selections.current.clear();f.view.wt.selections.area.clear();h.destroyEditor();c.refreshBorders();f.PluginHooks.run("afterDeselect")},selectAll:function(){if(!s.settings.multiSelect){return}c.setRangeStart({row:0,col:0});c.setRangeEnd({row:f.countRows()-1,col:f.countCols()-1},false)},empty:function(){if(!c.isSelected()){return}var e=l.getCornerCoords([s.selStart.coords(),s.selEnd.coords()]);var t,i,o=[];for(t=e.TL.row;t<=e.BR.row;t++){for(i=e.TL.col;i<=e.BR.col;i++){if(!f.getCellMeta(t,i).readOnly){o.push([t,i,""])}}}f.setDataAtCell(o)}};this.autofill=u={handle:null,init:function(){if(!u.handle){u.handle={}}else{u.handle.disabled=false}},disable:function(){u.handle.disabled=true},selectAdjacent:function(){var e,t,i,o,n;if(c.isMultiple()){e=f.view.wt.selections.area.getCorners()}else{e=f.view.wt.selections.current.getCorners()}t=a.getAll();e:for(i=e[2]+1;i<f.countRows();i++){for(n=e[1];n<=e[3];n++){if(t[i][n]){break e}}if(!!t[i][e[1]-1]||!!t[i][e[3]+1]){o=i}}if(o){f.view.wt.selections.fill.clear();f.view.wt.selections.fill.add([e[0],e[1]]);f.view.wt.selections.fill.add([o,e[3]]);u.apply()}},apply:function(){var e,t,i,o,n;u.handle.isDragged=0;e=f.view.wt.selections.fill.getCorners();if(!e){return}f.view.wt.selections.fill.clear();if(c.isMultiple()){t=f.view.wt.selections.area.getCorners()}else{t=f.view.wt.selections.current.getCorners()}if(e[0]===t[0]&&e[1]<t[1]){i={row:e[0],col:e[1]};o={row:e[2],col:t[1]-1}}else if(e[0]===t[0]&&e[3]>t[3]){i={row:e[0],col:t[3]+1};o={row:e[2],col:e[3]}}else if(e[0]<t[0]&&e[1]===t[1]){i={row:e[0],col:e[1]};o={row:t[0]-1,col:e[3]}}else if(e[2]>t[2]&&e[1]===t[1]){i={row:t[2]+1,col:e[1]};o={row:e[2],col:e[3]}}if(i){n=SheetClip.parse(a.getText(s.selStart.coords(),s.selEnd.coords()));f.PluginHooks.run("beforeAutofill",i,o,n);l.populateFromArray(i,n,o,"autofill");c.setRangeStart({row:e[0],col:e[1]});c.setRangeEnd({row:e[2],col:e[3]})}},showBorder:function(e){e.row=e[0];e.col=e[1];var t=l.getCornerCoords([s.selStart.coords(),s.selEnd.coords()]);if(s.settings.fillHandle!=="horizontal"&&(t.BR.row<e.row||t.TL.row>e.row)){e=[e.row,t.BR.col]}else if(s.settings.fillHandle!=="vertical"){e=[t.BR.row,e.col]}else{return}f.view.wt.selections.fill.clear();f.view.wt.selections.fill.add([s.selStart.coords().row,s.selStart.coords().col]);f.view.wt.selections.fill.add([s.selEnd.coords().row,s.selEnd.coords().col]);f.view.wt.selections.fill.add(e);f.view.render()}};this.init=function(){f.PluginHooks.run("beforeInit");this.view=new i.TableView(this);h=new i.EditorManager(f,s,c,a);this.updateSettings(s.settings,true);this.parseSettingsFromDOM();this.forceFullRender=true;this.view.render();if(typeof s.firstRun==="object"){f.PluginHooks.run("afterChange",s.firstRun[0],s.firstRun[1]);s.firstRun=false}f.PluginHooks.run("afterInit")};function m(){var e=false;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;e=false},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&e==false){e=true;this.onQueueEmpty()}}}}function v(t,i,o){var n=new m;n.onQueueEmpty=u;for(var r=t.length-1;r>=0;r--){if(t[r]===null){t.splice(r,1)}else{var s=t[r][0];var l=a.propToCol(t[r][1]);var c=f.runHooksAndReturn("modifyCol",l);var h=f.getCellMeta(s,c);if(h.type==="numeric"&&typeof t[r][3]==="string"){if(t[r][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(t[r][3])){t[r][3]=numeral().unformat(t[r][3]||"0")}}if(f.getCellValidator(h)){n.addValidatorToQueue();f.validateCell(t[r][3],h,function(e,i){return function(o){if(typeof o!=="boolean"){throw new Error("Validation error: result is not boolean")}if(o===false&&i.allowInvalid===false){t.splice(e,1);i.valid=true;--e}n.removeValidatorFormQueue()}}(r,h),i)}}}n.checkIfQueueIsEmpty();function u(){var n;if(t.length){n=f.PluginHooks.execute("beforeChange",t,i);if(typeof n==="function"){e.when(result).then(function(){o()})}else if(n===false){t.splice(0,t.length)}}if(typeof n!=="function"){o()}}}function w(e,t){var i=e.length-1;if(i<0){return}for(;0<=i;i--){if(e[i]===null){e.splice(i,1);continue}if(s.settings.minSpareRows){while(e[i][0]>f.countRows()-1){a.createRow()}}if(f.dataType==="array"&&s.settings.minSpareCols){while(a.propToCol(e[i][1])>f.countCols()-1){a.createCol()}}a.set(e[i][0],e[i][1],e[i][3])}f.forceFullRender=true;l.adjustRowsAndCols();c.refreshBorders(null,true);f.PluginHooks.run("afterChange",e,t||"edit")}this.validateCell=function(e,t,i,o){var n=f.getCellValidator(t);if(Object.prototype.toString.call(n)==="[object RegExp]"){n=function(e){return function(t,i){i(e.test(t))}}(n)}if(typeof n=="function"){e=f.PluginHooks.execute("beforeValidate",e,t.row,t.prop,o);setTimeout(function(){n.call(t,e,function(n){t.valid=n;n=f.PluginHooks.execute("afterValidate",n,e,t.row,t.prop,o);i(n)})})}else{t.valid=true;i(true)}};function y(t,i,o){if(typeof t==="object"){return t}else if(e.isPlainObject(o)){return o}else{return[[t,i,o]]}}this.setDataAtCell=function(e,t,i,o){var n=y(e,t,i),r,s,l=[],c;for(r=0,s=n.length;r<s;r++){if(typeof n[r]!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof n[r][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}c=a.colToProp(n[r][1]);l.push([n[r][0],c,a.get(n[r][0],c),n[r][2]])}if(!o&&typeof e==="object"){o=t}v(l,o,function(){w(l,o)})};this.setDataAtRowProp=function(e,t,i,o){var n=y(e,t,i),r,s,l=[];for(r=0,s=n.length;r<s;r++){l.push([n[r][0],n[r][1],a.get(n[r][0],n[r][1]),n[r][2]])}if(!o&&typeof e==="object"){o=t}v(l,o,function(){w(l,o)})};this.listen=function(){i.activeGuid=f.guid;if(document.activeElement&&document.activeElement!==document.body){document.activeElement.blur()}else if(!document.activeElement){document.body.focus()}};this.unlisten=function(){i.activeGuid=null};this.isListening=function(){return i.activeGuid===f.guid};this.destroyEditor=function(e){c.refreshBorders(e)};this.populateFromArray=function(e,t,i,o,n,r,s){if(!(typeof i==="object"&&typeof i[0]==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}return l.populateFromArray({row:e,col:t},i,typeof o==="number"?{row:o,col:n}:null,r,s)};this.spliceCol=function(e,t,i){return a.spliceCol.apply(a,arguments)};this.spliceRow=function(e,t,i){return a.spliceRow.apply(a,arguments)};this.getCornerCoords=function(e){return l.getCornerCoords(e)};this.getSelected=function(){if(c.isSelected()){return[s.selStart.row(),s.selStart.col(),s.selEnd.row(),s.selEnd.col()]}};this.parseSettingsFromDOM=function(){var e=this.rootElement.css("overflow");if(e==="scroll"||e==="auto"){this.rootElement[0].style.overflow="visible";s.settingsFromDOM.overflow=e}else if(s.settings.width===void 0||s.settings.height===void 0){s.settingsFromDOM.overflow="auto"}if(s.settings.width===void 0){s.settingsFromDOM.width=this.rootElement.width()}else{s.settingsFromDOM.width=void 0}s.settingsFromDOM.height=void 0;if(s.settings.height===void 0){if(s.settingsFromDOM.overflow==="scroll"||s.settingsFromDOM.overflow==="auto"){var i=this.rootElement[0].cloneNode(false);var o=this.rootElement[0].parentNode;if(o){i.removeAttribute("id");o.appendChild(i);var n=parseInt(t.getComputedStyle(i,null).getPropertyValue("height"),10);if(isNaN(n)&&i.currentStyle){n=parseInt(i.currentStyle.height,10)}if(n>0){s.settingsFromDOM.height=n}o.removeChild(i)}}}};this.render=function(){if(f.view){f.forceFullRender=true;f.parseSettingsFromDOM();c.refreshBorders(null,true)}};this.loadData=function(e){if(typeof e==="object"&&e!==null){if(!(e.push&&e.splice)){e=[e]}}else if(e===null){e=[];var t;for(var o=0,n=s.settings.startRows;o<n;o++){t=[];for(var r=0,c=s.settings.startCols;r<c;r++){t.push(null)}e.push(t)}}else{throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)")}s.isPopulated=false;d.prototype.data=e;if(s.settings.dataSchema instanceof Array||e[0]instanceof Array){f.dataType="array"}else if(typeof s.settings.dataSchema==="function"){f.dataType="function"}else{f.dataType="object"}a=new i.DataMap(f,s,d);h();l.adjustRowsAndCols();f.PluginHooks.run("afterLoadData");if(s.firstRun){s.firstRun=[null,"loadData"]}else{f.PluginHooks.run("afterChange",null,"loadData");f.render()}s.isPopulated=true;function h(){s.cellSettings.length=0}};this.getData=function(e,t,i,o){if(typeof e==="undefined"){return a.getAll()}else{return a.getRange({row:e,col:t},{row:i,col:o},a.DESTINATION_RENDERER)}};this.getCopyableData=function(e,t,i,o){return a.getCopyableText({row:e,col:t},{row:i,col:o})};this.updateSettings=function(e,t){var o,n;if(typeof e.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof e.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}for(o in e){if(o==="data"){continue}else{if(f.PluginHooks.hooks[o]!==void 0||f.PluginHooks.legacy[o]!==void 0){if(typeof e[o]==="function"||i.helper.isArray(e[o])){f.PluginHooks.add(o,e[o])}}else{if(!t&&e.hasOwnProperty(o)){d.prototype[o]=e[o]}if(i.extension[o]){s.extensions[o]=new i.extension[o](f,e[o])}}}}if(e.data===void 0&&s.settings.data===void 0){f.loadData(null)}else if(e.data!==void 0){f.loadData(e.data)}else if(e.columns!==void 0){a.createMap()}n=f.countCols();s.cellSettings.length=0;if(n>0){var r,h;for(o=0;o<n;o++){s.columnSettings[o]=i.helper.columnFactory(d,s.columnsSettingConflicts);r=s.columnSettings[o].prototype;if(d.prototype.columns){h=d.prototype.columns[o];i.helper.extend(r,h);i.helper.extend(r,C(h))}}}if(typeof e.fillHandle!=="undefined"){if(u.handle&&e.fillHandle===false){u.disable()}else if(!u.handle&&e.fillHandle!==false){u.init()}}if(typeof e.className!=="undefined"){if(d.prototype.className){f.rootElement.removeClass(d.prototype.className)}if(e.className){f.rootElement.addClass(e.className)}}if(!t){f.PluginHooks.run("afterUpdateSettings")}l.adjustRowsAndCols();if(f.view&&!s.firstRun){f.forceFullRender=true;c.refreshBorders(null,true)}};this.getValue=function(){var e=f.getSelected();if(d.prototype.getValue){if(typeof d.prototype.getValue==="function"){return d.prototype.getValue.call(f)}else if(e){return f.getData()[e[0]][d.prototype.getValue]}}else if(e){return f.getDataAtCell(e[0],e[1])}};function C(e){if(!e.hasOwnProperty("type"))return;var t,o={};if(typeof e.type==="object"){t=e.type}else if(typeof e.type==="string"){t=i.cellTypes[e.type];if(t===void 0){throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}for(var n in t){if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n)){o[n]=t[n]}}return o}this.getSettings=function(){return s.settings};this.getSettingsFromDOM=function(){return s.settingsFromDOM};this.clear=function(){c.selectAll();c.empty()};this.alter=function(e,t,i,o,n){l.alter(e,t,i,o,n)};this.getCell=function(e,t){return f.view.getCellAtCoords({row:e,col:t})};this.colToProp=function(e){return a.colToProp(e)};this.propToCol=function(e){return a.propToCol(e)};this.getDataAtCell=function(e,t){return a.get(e,a.colToProp(t))};this.getDataAtRowProp=function(e,t){return a.get(e,t)};this.getDataAtCol=function(e){return[].concat.apply([],a.getRange({row:0,col:e},{row:s.settings.data.length-1,col:e},a.DESTINATION_RENDERER))};this.getDataAtProp=function(e){return[].concat.apply([],a.getRange({row:0,col:a.propToCol(e)},{row:s.settings.data.length-1,col:a.propToCol(e)},a.DESTINATION_RENDERER))};this.getDataAtRow=function(e){return s.settings.data[e]};this.getCellMeta=function(e,t){var o=a.colToProp(t),n;e=l(e);t=c(t);if("undefined"===typeof s.columnSettings[t]){s.columnSettings[t]=i.helper.columnFactory(d,s.columnsSettingConflicts)}if(!s.cellSettings[e]){s.cellSettings[e]=[]}if(!s.cellSettings[e][t]){s.cellSettings[e][t]=new s.columnSettings[t]}n=s.cellSettings[e][t];n.row=e;n.col=t;n.prop=o;n.instance=f;f.PluginHooks.run("beforeGetCellMeta",e,t,n);i.helper.extend(n,C(n));if(n.cells){var r=n.cells.call(n,e,t,o);if(r){i.helper.extend(n,r);i.helper.extend(n,C(r))}}f.PluginHooks.run("afterGetCellMeta",e,t,n);return n;function l(e){var t={row:e};f.PluginHooks.execute("beforeGet",t);return t.row}function c(e){return i.PluginHooks.execute(f,"modifyCol",e)}};var b=i.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,t){var o=b.call(this,e,t);return i.renderers.getRenderer(o)};this.getCellEditor=i.helper.cellMethodLookupFactory("editor");this.getCellValidator=i.helper.cellMethodLookupFactory("validator");this.validateCells=function(e){var t=new m;t.onQueueEmpty=e;var i=f.countRows()-1;while(i>=0){var o=f.countCols()-1;while(o>=0){t.addValidatorToQueue();f.validateCell(f.getDataAtCell(i,o),f.getCellMeta(i,o),function(){t.removeValidatorFormQueue()},"validateCells");o--}i--}t.checkIfQueueIsEmpty()};this.getRowHeader=function(e){if(e===void 0){var t=[];for(var i=0,o=f.countRows();i<o;i++){t.push(f.getRowHeader(i))}return t}else if(Object.prototype.toString.call(s.settings.rowHeaders)==="[object Array]"&&s.settings.rowHeaders[e]!==void 0){return s.settings.rowHeaders[e]}else if(typeof s.settings.rowHeaders==="function"){return s.settings.rowHeaders(e)}else if(s.settings.rowHeaders&&typeof s.settings.rowHeaders!=="string"&&typeof s.settings.rowHeaders!=="number"){return e+1}else{return s.settings.rowHeaders}};this.hasRowHeaders=function(){return!!s.settings.rowHeaders};this.hasColHeaders=function(){if(s.settings.colHeaders!==void 0&&s.settings.colHeaders!==null){return!!s.settings.colHeaders}for(var e=0,t=f.countCols();e<t;e++){if(f.getColHeader(e)){return true}}return false};this.getColHeader=function(e){if(e===void 0){var t=[];for(var o=0,n=f.countCols();o<n;o++){t.push(f.getColHeader(o))}return t}else{e=i.PluginHooks.execute(f,"modifyCol",e);if(s.settings.columns&&s.settings.columns[e]&&s.settings.columns[e].title){return s.settings.columns[e].title}else if(Object.prototype.toString.call(s.settings.colHeaders)==="[object Array]"&&s.settings.colHeaders[e]!==void 0){return s.settings.colHeaders[e]}else if(typeof s.settings.colHeaders==="function"){return s.settings.colHeaders(e)}else if(s.settings.colHeaders&&typeof s.settings.colHeaders!=="string"&&typeof s.settings.colHeaders!=="number"){return i.helper.spreadsheetColumnLabel(e)}else{return s.settings.colHeaders}}};this._getColWidthFromSettings=function(e){var t=f.getCellMeta(0,e);var i=t.width;if(i===void 0||i===s.settings.width){i=t.colWidths}if(i!==void 0&&i!==null){switch(typeof i){case"object":i=i[e];break;case"function":i=i(e);break}if(typeof i==="string"){i=parseInt(i,10)}}return i};this.getColWidth=function(e){e=i.PluginHooks.execute(f,"modifyCol",e);var t={width:f._getColWidthFromSettings(e)};if(!t.width){t.width=50}f.PluginHooks.run("afterGetColWidth",e,t);return t.width};this.countRows=function(){return s.settings.data.length};this.countCols=function(){if(f.dataType==="object"||f.dataType==="function"){if(s.settings.columns&&s.settings.columns.length){return s.settings.columns.length}else{return a.colToPropCache.length}}else if(f.dataType==="array"){if(s.settings.columns&&s.settings.columns.length){return s.settings.columns.length}else if(s.settings.data&&s.settings.data[0]&&s.settings.data[0].length){return s.settings.data[0].length}else{return 0}}};this.rowOffset=function(){return f.view.wt.getSetting("offsetRow")};this.colOffset=function(){return f.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return f.view.wt.drawn?f.view.wt.wtTable.rowStrategy.countVisible():-1};this.countVisibleCols=function(){return f.view.wt.drawn?f.view.wt.wtTable.columnStrategy.countVisible():-1};this.countEmptyRows=function(e){var t=f.countRows()-1,i=0;while(t>=0){a.get(t,0);if(f.isEmptyRow(a.getVars.row)){i++}else if(e){break}t--}return i};this.countEmptyCols=function(e){if(f.countRows()<1){return 0}var t=f.countCols()-1,i=0;while(t>=0){if(f.isEmptyCol(t)){i++}else if(e){break}t--}return i};this.isEmptyRow=function(e){return s.settings.isEmptyRow.call(f,e)};this.isEmptyCol=function(e){return s.settings.isEmptyCol.call(f,e)};this.selectCell=function(e,t,i,o,n){if(typeof e!=="number"||e<0||e>=f.countRows()){return false}if(typeof t!=="number"||t<0||t>=f.countCols()){return false}if(typeof i!=="undefined"){if(typeof i!=="number"||i<0||i>=f.countRows()){return false}if(typeof o!=="number"||o<0||o>=f.countCols()){return false}}s.selStart.coords({row:e,col:t});if(document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body){document.activeElement.blur()}f.listen();if(typeof i==="undefined"){c.setRangeEnd({row:e,col:t},n)}else{c.setRangeEnd({row:i,col:o},n)}f.selection.finish();return true};this.selectCellByProp=function(e,t,i,o,n){arguments[1]=a.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=a.propToCol(arguments[3])}return f.selectCell.apply(f,arguments)};this.deselectCell=function(){c.deselect()};this.destroy=function(){f.clearTimeouts();if(f.view){f.view.wt.destroy()}f.rootElement.empty();f.rootElement.removeData("handsontable");f.rootElement.off(".handsontable");e(t).off("."+f.guid);p.off("."+f.guid);g.off("."+f.guid);f.PluginHooks.run("afterDestroy")};this.getActiveEditor=function(){return h.getActiveEditor()};this.getInstance=function(){return f.rootElement.data("handsontable")};(function(){f.PluginHooks=new i.PluginHookClass;var e=f.PluginHooks.run,t=f.PluginHooks.execute;f.PluginHooks.run=function(t,o,n,r,s,a){e.call(this,f,t,o,n,r,s,a);i.PluginHooks.run(f,t,o,n,r,s,a)};f.PluginHooks.execute=function(e,o,n,r,s,a){var l=i.PluginHooks.execute(f,e,o,n,r,s,a);var c=t.call(this,f,e,l,n,r,s,a);return typeof c=="undefined"?l:c};f.addHook=function(){f.PluginHooks.add.apply(f.PluginHooks,arguments)};f.addHookOnce=function(){f.PluginHooks.once.apply(f.PluginHooks,arguments)};f.removeHook=function(){f.PluginHooks.remove.apply(f.PluginHooks,arguments)};f.runHooks=function(){f.PluginHooks.run.apply(f.PluginHooks,arguments)};f.runHooksAndReturn=function(){return f.PluginHooks.execute.apply(f.PluginHooks,arguments)}})();this.timeouts={};this.registerTimeout=function(e,t,i){clearTimeout(this.timeouts[e]);this.timeouts[e]=setTimeout(t,i||0)};this.clearTimeouts=function(){for(var e in this.timeouts){if(this.timeouts.hasOwnProperty(e)){clearTimeout(this.timeouts[e])}}};this.version="0.10.3"};var o=function(){};o.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(e){var t;for(var i=0,o=this.countCols();i<o;i++){t=this.getDataAtCell(e,i);if(t!==""&&t!==null&&typeof t!=="undefined"){return false}}return true},isEmptyCol:function(e){var t;for(var i=0,o=this.countRows();i<o;i++){t=this.getDataAtCell(i,e);if(t!==""&&t!==null&&typeof t!=="undefined"){return false}}return true},observeDOMVisibility:true,allowInvalid:true,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:false,readOnly:false,nativeScrollbars:false,type:"text",copyable:true,debug:false};i.DefaultSettings=o;e.fn.handsontable=function(e){var t,o,n,r,s,a=this.first(),l=a.data("handsontable");if(typeof e!=="string"){s=e||{};if(l){l.updateSettings(s)}else{l=new i.Core(a,s);a.data("handsontable",l);l.init()}return a}else{n=[];if(arguments.length>1){for(t=1,o=arguments.length;t<o;t++){n.push(arguments[t])}}if(l){if(typeof l[e]!=="undefined"){r=l[e].apply(l,n)}else{throw new Error("Handsontable do not provide action: "+e)}}return r}};i.TableView=function(o){var n=this,r=e(t),s=e(document.documentElement);this.instance=o;this.settings=o.getSettings();this.settingsFromDOM=o.getSettingsFromDOM();o.rootElement.data("originalStyle",o.rootElement[0].getAttribute("style"));o.rootElement.addClass("handsontable");var a=document.createElement("TABLE");a.className="htCore";this.THEAD=document.createElement("THEAD");a.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");a.appendChild(this.TBODY);o.$table=e(a);o.rootElement.prepend(o.$table);o.rootElement.on("mousedown.handsontable",function(e){if(!n.isTextSelectionAllowed(e.target)){c();e.preventDefault();t.focus()}});s.on("keyup."+o.guid,function(e){if(o.selection.isInProgress()&&!e.shiftKey){o.selection.finish()}});var l;s.on("mouseup."+o.guid,function(e){if(o.selection.isInProgress()&&e.which===1){o.selection.finish()}l=false;if(o.autofill.handle&&o.autofill.handle.isDragged){if(o.autofill.handle.isDragged>1){o.autofill.apply()}o.autofill.handle.isDragged=0}if(i.helper.isOutsideInput(document.activeElement)){o.unlisten()}});s.on("mousedown."+o.guid,function(e){var t=e.target;if(t!==n.wt.wtTable.spreader){while(t!==document.documentElement){if(t===null){return}if(t===o.rootElement[0]||t.nodeName==="HANDSONTABLE-TABLE"){return}t=t.parentNode}}if(n.settings.outsideClickDeselects){o.deselectCell()}else{o.destroyEditor()}});o.rootElement.on("mousedown.handsontable",".dragdealer",function(){o.destroyEditor()});o.$table.on("selectstart",function(e){if(n.settings.fragmentSelection){return}e.preventDefault()});var c=function(){if(t.getSelection){if(t.getSelection().empty){t.getSelection().empty()}else if(t.getSelection().removeAllRanges){t.getSelection().removeAllRanges()}}else if(document.selection){document.selection.empty()}};var h={debug:function(){return n.settings.debug},table:a,stretchH:this.settings.stretchH,data:o.getDataAtCell,totalRows:o.countRows,totalColumns:o.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop
},rowHeaders:function(){return o.hasRowHeaders()?[function(e,t){n.appendRowHeader(e,t)}]:[]},columnHeaders:function(){return o.hasColHeaders()?[function(e,t){n.appendColHeader(e,t)}]:[]},columnWidth:o.getColWidth,cellRenderer:function(e,t,i){var o=n.instance.colToProp(t),r=n.instance.getCellMeta(e,t),s=n.instance.getCellRenderer(r);var a=n.instance.getDataAtRowProp(e,o);s(n.instance,i,e,t,o,a,r);n.instance.PluginHooks.run("afterRenderer",i,e,t,o,a,r)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!o.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&o.selection.isMultiple()}}},highlight:{highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(e,t,i){o.listen();l=true;var n={row:t[0],col:t[1]};if(e.button===2&&o.selection.inInSelection(n)){}else if(e.shiftKey){o.selection.setRangeEnd(n)}else{o.selection.setRangeStart(n)}o.PluginHooks.run("afterOnCellMouseDown",e,t,i)},onCellMouseOver:function(e,t,i){var n={row:t[0],col:t[1]};if(l){o.selection.setRangeEnd(n)}else if(o.autofill.handle&&o.autofill.handle.isDragged){o.autofill.handle.isDragged++;o.autofill.showBorder(t)}o.PluginHooks.run("afterOnCellMouseOver",e,t,i)},onCellCornerMouseDown:function(e){o.autofill.handle.isDragged=1;e.preventDefault();o.PluginHooks.run("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:function(){o.autofill.selectAdjacent()},beforeDraw:function(e){n.beforeRender(e)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){o.runHooks("afterScrollVertically")},onScrollHorizontally:function(){o.runHooks("afterScrollHorizontally")}};o.PluginHooks.run("beforeInitWalkontable",h);this.wt=new D(h);r.on("resize."+o.guid,function(){o.registerTimeout("resizeTimeout",function(){o.parseSettingsFromDOM();var e=n.getWidth();var t=n.getHeight();if(h.width!==e||h.height!==t){o.forceFullRender=true;n.render();h.width=e;h.height=t}},60)});e(n.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(e){if(e.target===n.wt.wtTable.spreader&&e.which===3){e.stopPropagation()}});s.on("click."+o.guid,function(){if(n.settings.observeDOMVisibility){if(n.wt.drawInterrupted){n.instance.forceFullRender=true;n.render()}}})};i.TableView.prototype.isTextSelectionAllowed=function(e){if(i.helper.isInput(e)){return true}if(this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(e,this.TBODY)){return true}return false};i.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()};i.TableView.prototype.getWidth=function(){var e=this.settings.width!==void 0?this.settings.width:this.settingsFromDOM.width;return typeof e==="function"?e():e};i.TableView.prototype.getHeight=function(){var e=this.settings.height!==void 0?this.settings.height:this.settingsFromDOM.height;return typeof e==="function"?e():e};i.TableView.prototype.beforeRender=function(e){if(e){this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender);this.wt.update("width",this.getWidth());this.wt.update("height",this.getHeight())}};i.TableView.prototype.onDraw=function(e){if(e){this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)}};i.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.rootElement.triggerHandler("render.handsontable")};i.TableView.prototype.getCellAtCoords=function(e){var t=this.wt.wtTable.getCell([e.row,e.col]);if(t<0){return null}else{return t}};i.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport([e.row,e.col])};i.TableView.prototype.appendRowHeader=function(e,t){if(e>-1){this.wt.wtDom.fastInnerHTML(t,this.instance.getRowHeader(e))}else{var i=document.createElement("DIV");i.className="relative";this.wt.wtDom.fastInnerText(i,"Ã‚ ");this.wt.wtDom.empty(t);t.appendChild(i)}};i.TableView.prototype.appendColHeader=function(e,t){var i=document.createElement("DIV"),o=document.createElement("SPAN");i.className="relative";o.className="colHeader";this.wt.wtDom.fastInnerHTML(o,this.instance.getColHeader(e));i.appendChild(o);this.wt.wtDom.empty(t);t.appendChild(i);this.instance.PluginHooks.run("afterGetColHeader",e,t)};i.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth();if(this.settings.nativeScrollbars){return t}return t-e};i.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight();if(this.settings.nativeScrollbars){return t}return t-e};(function(e){"use strict";function t(e){var t,i;i={};t=e;this.getInstance=function(e){if(!(e.guid in i)){i[e.guid]=new t(e)}return i[e.guid]}}var i={};var o=new WeakMap;e.editors={registerEditor:function(e,n){var r=new t(n);if(typeof e==="string"){i[e]=r}o.set(n,r)},getEditor:function(e,t){var n;if(typeof e=="function"){if(!o.get(e)){this.registerEditor(null,e)}n=o.get(e)}else if(typeof e=="string"){n=i[e]}else{throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!n){throw Error('No editor registered under name "'+e+'"')}return n.getInstance(t)}}})(i);(function(t){"use strict";t.EditorManager=function(i,o,n){var r=this;var s=e(document);var a=t.helper.keyCode;var l;var c=function(){function e(e){if(!i.isListening()){return}if(o.settings.beforeOnKeyDown){o.settings.beforeOnKeyDown.call(i,e)}i.PluginHooks.run("beforeKeyDown",e);if(!e.isImmediatePropagationStopped()){o.lastKeyCode=e.keyCode;if(n.isSelected()){var s=(e.ctrlKey||e.metaKey)&&!e.altKey;if(!l.isWaiting()){if(!t.helper.isMetaKey(e.keyCode)&&!s){r.openEditor("");e.stopPropagation();return}}var c=e.shiftKey?n.setRangeEnd:n.setRangeStart;switch(e.keyCode){case a.A:if(s){n.selectAll();e.preventDefault();e.stopPropagation();break}case a.ARROW_UP:if(r.isEditorOpened()&&!l.isWaiting()){r.closeEditorAndSaveChanges(s)}u(e.shiftKey);e.preventDefault();e.stopPropagation();break;case a.ARROW_DOWN:if(r.isEditorOpened()&&!l.isWaiting()){r.closeEditorAndSaveChanges(s)}f(e.shiftKey);e.preventDefault();e.stopPropagation();break;case a.ARROW_RIGHT:if(r.isEditorOpened()&&!l.isWaiting()){r.closeEditorAndSaveChanges(s)}d(e.shiftKey);e.preventDefault();e.stopPropagation();break;case a.ARROW_LEFT:if(r.isEditorOpened()&&!l.isWaiting()){r.closeEditorAndSaveChanges(s)}p(e.shiftKey);e.preventDefault();e.stopPropagation();break;case a.TAB:var g=typeof o.settings.tabMoves==="function"?o.settings.tabMoves(e):o.settings.tabMoves;if(e.shiftKey){n.transformStart(-g.row,-g.col)}else{n.transformStart(g.row,g.col,true)}e.preventDefault();e.stopPropagation();break;case a.BACKSPACE:case a.DELETE:n.empty(e);r.prepareEditor();e.preventDefault();break;case a.F2:r.openEditor();e.preventDefault();break;case a.ENTER:if(r.isEditorOpened()){if(l.state!==t.EditorState.WAITING){r.closeEditorAndSaveChanges(s)}h(e.shiftKey)}else{if(i.getSettings().enterBeginsEditing){r.openEditor()}else{h(e.shiftKey)}}e.preventDefault();e.stopImmediatePropagation();break;case a.ESCAPE:if(r.isEditorOpened()){r.closeEditorAndRestoreOriginalValue(s)}e.preventDefault();break;case a.HOME:if(e.ctrlKey||e.metaKey){c({row:0,col:o.selStart.col()})}else{c({row:o.selStart.row(),col:0})}e.preventDefault();e.stopPropagation();break;case a.END:if(e.ctrlKey||e.metaKey){c({row:i.countRows()-1,col:o.selStart.col()})}else{c({row:o.selStart.row(),col:i.countCols()-1})}e.preventDefault();e.stopPropagation();break;case a.PAGE_UP:n.transformStart(-i.countVisibleRows(),0);i.view.wt.scrollVertical(-i.countVisibleRows());i.view.render();e.preventDefault();e.stopPropagation();break;case a.PAGE_DOWN:n.transformStart(i.countVisibleRows(),0);i.view.wt.scrollVertical(i.countVisibleRows());i.view.render();e.preventDefault();e.stopPropagation();break;default:break}}}}s.on("keydown.handsontable."+i.guid,e);function c(){r.openEditor()}i.view.wt.update("onCellDblClick",c);i.addHook("afterDestroy",function(){s.off("keydown.handsontable."+i.guid)});function h(e){var t=typeof o.settings.enterMoves==="function"?o.settings.enterMoves(event):o.settings.enterMoves;if(e){n.transformStart(-t.row,-t.col)}else{n.transformStart(t.row,t.col,true)}}function u(e){if(e){n.transformEnd(-1,0)}else{n.transformStart(-1,0)}}function f(e){if(e){n.transformEnd(1,0)}else{n.transformStart(1,0)}}function d(e){if(e){n.transformEnd(0,1)}else{n.transformStart(0,1)}}function p(e){if(e){n.transformEnd(0,-1)}else{n.transformStart(0,-1)}}};this.destroyEditor=function(e){this.closeEditor(e)};this.getActiveEditor=function(){return l};this.prepareEditor=function(){if(l&&l.isWaiting()){this.closeEditor(false,false,function(e){if(e){r.prepareEditor()}});return}var e=o.selStart.row();var n=o.selStart.col();var s=i.colToProp(n);var a=i.getCell(e,n);var c=i.getDataAtCell(e,n);var h=i.getCellMeta(e,n);var u=i.getCellEditor(h);l=t.editors.getEditor(u,i);l.prepare(e,n,s,a,c,h)};this.isEditorOpened=function(){return l.isOpened()};this.openEditor=function(e){l.beginEditing(e)};this.closeEditor=function(e,t,i){if(!l){if(i){i(false)}}else{l.finishEditing(e,t,i)}};this.closeEditorAndSaveChanges=function(e){return this.closeEditor(false,e)};this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(true,e)};c()}})(i);(function(e){"use strict";var t={};e.renderers={registerRenderer:function(e,i){t[e]=i},getRenderer:function(e){if(typeof e=="function"){return e}if(typeof e!="string"){throw Error('Only strings and functions can be passed as "renderer" parameter ')}if(!(e in t)){throw Error('No editor registered under name "'+e+'"')}return t[e]}}})(i);i.Dom=new H;i.helper.isPrintableChar=function(e){return e==32||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90};i.helper.isMetaKey=function(e){var t=i.helper.keyCode;var o=[t.ARROW_DOWN,t.ARROW_UP,t.ARROW_LEFT,t.ARROW_RIGHT,t.HOME,t.END,t.DELETE,t.BACKSPACE,t.F1,t.F2,t.F3,t.F4,t.F5,t.F6,t.F7,t.F8,t.F9,t.F10,t.F11,t.F12,t.TAB,t.PAGE_DOWN,t.PAGE_UP,t.ENTER,t.ESCAPE,t.SHIFT,t.CAPS_LOCK,t.ALT];return o.indexOf(e)!=-1};i.helper.isCtrlKey=function(e){var t=i.helper.keyCode;return[t.CONTROL_LEFT,224,t.COMMAND_LEFT,t.COMMAND_RIGHT].indexOf(e)!=-1};i.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";break;case"object":if(e===null){return""}else{return e.toString()}break;case"undefined":return"";break;default:return e.toString()}};i.helper.spreadsheetColumnLabel=function(e){var t=e+1;var i="";var o;while(t>0){o=(t-1)%26;i=String.fromCharCode(65+o)+i;t=parseInt((t-o)/26,10)}return i};i.helper.isNumeric=function(e){var t=typeof e;return t=="number"?!isNaN(e)&&isFinite(e):t=="string"?!e.length?false:e.length==1?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e):t=="object"?!!e&&typeof e.valueOf()=="number"&&!(e instanceof Date):false};i.helper.isArray=function(e){return Object.prototype.toString.call(e).match(/array/i)!==null};i.helper.isDescendant=function(e,t){var i=t.parentNode;while(i!=null){if(i==e){return true}i=i.parentNode}return false};i.helper.randomString=function(){return O()};i.helper.inherit=function(e,t){t.prototype.constructor=t;e.prototype=new t;e.prototype.constructor=e;return e};i.helper.extend=function(e,t){for(var i in t){if(t.hasOwnProperty(i)){e[i]=t[i]}}};i.helper.getPrototypeOf=function(e){var t;if(typeof e.__proto__=="object"){t=e.__proto__}else{var i,o=e.constructor;if(typeof e.constructor=="function"){i=o;if(delete e.constructor){o=e.constructor;e.constructor=i}}t=o?o.prototype:null}return t};i.helper.columnFactory=function(e,t){function o(){}i.helper.inherit(o,e);for(var n=0,r=t.length;n<r;n++){o.prototype[t[n]]=void 0}return o};i.helper.translateRowsToColumns=function(e){var t,i,o,n,r=[],s=0;for(t=0,i=e.length;t<i;t++){for(o=0,n=e[t].length;o<n;o++){if(o==s){r.push([]);s++}r[o].push(e[t][o])}}return r};i.helper.to2dArray=function(e){var t=0,i=e.length;while(t<i){e[t]=[e[t]];t++}};i.helper.extendArray=function(e,t){var i=0,o=t.length;while(i<o){e.push(t[i]);i++}};i.helper.isInput=function(e){var t=["INPUT","SELECT","TEXTAREA"];return t.indexOf(e.nodeName)>-1};i.helper.isOutsideInput=function(e){return i.helper.isInput(e)&&e.className.indexOf("handsontableInput")==-1};i.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};i.helper.isObject=function(e){return Object.prototype.toString.call(e)=="[object Object]"};i.helper.isArray=function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)=="[object Array]"};i.helper.pivot=function(e){var t=[];if(!e||e.length==0||!e[0]||e[0].length==0){return t}var i=e.length;var o=e[0].length;for(var n=0;n<i;n++){for(var r=0;r<o;r++){if(!t[r]){t[r]=[]}t[r][n]=e[n][r]}}return t};i.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}};i.helper.cellMethodLookupFactory=function(e,t){t=typeof t=="undefined"?true:t;return function n(r,s){return function n(r){if(!r){return}else if(r.hasOwnProperty(e)&&r[e]){return r[e]}else if(r.hasOwnProperty("type")&&r.type){var s;if(typeof r.type!="string"){throw new Error("Cell type must be a string ")}s=o(r.type);if(s.hasOwnProperty(e)){return s[e]}else if(t){return}}return n(i.helper.getPrototypeOf(r))}(typeof r=="number"?this.getCellMeta(r,s):r)};function o(e){var t=i.cellTypes[e];if(typeof t=="undefined"){throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}return t}};i.SelectionPoint=function(){this._row=null;this._col=null};i.SelectionPoint.prototype.exists=function(){return this._row!==null};i.SelectionPoint.prototype.row=function(e){if(e!==void 0){this._row=e}return this._row};i.SelectionPoint.prototype.col=function(e){if(e!==void 0){this._col=e}return this._col};i.SelectionPoint.prototype.coords=function(e){if(e!==void 0){this._row=e.row;this._col=e.col}return{row:this._row,col:this._col}};i.SelectionPoint.prototype.arr=function(e){if(e!==void 0){this._row=e[0];this._col=e[1]}return[this._row,this._col]};(function(t){"use strict";t.DataMap=function(e,t,i){this.instance=e;this.priv=t;this.GridSettings=i;this.dataSource=this.instance.getSettings().data;if(this.dataSource[0]){this.duckSchema=this.recursiveDuckSchema(this.dataSource[0])}else{this.duckSchema={}}this.createMap();this.getVars={};this.setVars={}};t.DataMap.prototype.DESTINATION_RENDERER=1;t.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2;t.DataMap.prototype.recursiveDuckSchema=function(t){var i;if(e.isPlainObject(t)){i={};for(var o in t){if(t.hasOwnProperty(o)){if(e.isPlainObject(t[o])){i[o]=this.recursiveDuckSchema(t[o])}else{i[o]=null}}}}else{i=[]}return i};t.DataMap.prototype.recursiveDuckColumns=function(t,i,o){var n,r;if(typeof i==="undefined"){i=0;o=""}if(e.isPlainObject(t)){for(r in t){if(t.hasOwnProperty(r)){if(t[r]===null){n=o+r;this.colToPropCache.push(n);this.propToColCache[n]=i;i++}else{i=this.recursiveDuckColumns(t[r],i,r+".")}}}}return i};t.DataMap.prototype.createMap=function(){if(typeof this.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}var e,t,i=this.getSchema();this.colToPropCache=[];this.propToColCache={};var o=this.instance.getSettings().columns;if(o){for(e=0,t=o.length;e<t;e++){this.colToPropCache[e]=o[e].data;this.propToColCache[o[e].data]=e}}else{this.recursiveDuckColumns(i)}};t.DataMap.prototype.colToProp=function(e){e=t.PluginHooks.execute(this.instance,"modifyCol",e);if(this.colToPropCache&&typeof this.colToPropCache[e]!=="undefined"){return this.colToPropCache[e]}else{return e}};t.DataMap.prototype.propToCol=function(e){var i;if(typeof this.propToColCache[e]!=="undefined"){i=this.propToColCache[e]}else{i=e}i=t.PluginHooks.execute(this.instance,"modifyCol",i);return i};t.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;if(e){if(typeof e==="function"){return e()}return e}return this.duckSchema};t.DataMap.prototype.createRow=function(t,i,o){var n,r=this.instance.countCols(),s=0,a;if(!i){i=1}if(typeof t!=="number"||t>=this.instance.countRows()){t=this.instance.countRows()}a=t;var l=this.instance.getSettings().maxRows;while(s<i&&this.instance.countRows()<l){if(this.instance.dataType==="array"){n=[];for(var c=0;c<r;c++){n.push(null)}}else if(this.instance.dataType==="function"){n=this.instance.getSettings().dataSchema(t)}else{n=e.extend(true,{},this.getSchema())}if(t===this.instance.countRows()){this.dataSource.push(n)}else{this.dataSource.splice(t,0,n)}s++;a++}this.instance.PluginHooks.run("afterCreateRow",t,s,o);this.instance.forceFullRender=true;return s};t.DataMap.prototype.createCol=function(e,i,o){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("Cannot create new column. When data source in an object, "+"you can only have as much columns as defined in first data row, data schema or in the 'columns' setting."+"If you want to be able to add new columns, you have to use array datasource.")}var n=this.instance.countRows(),r=this.dataSource,s,a=0,l;if(!i){i=1}l=e;var c=this.instance.getSettings().maxCols;while(a<i&&this.instance.countCols()<c){s=t.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts);if(typeof e!=="number"||e>=this.instance.countCols()){for(var h=0;h<n;h++){if(typeof r[h]==="undefined"){r[h]=[]}r[h].push(null)}this.priv.columnSettings.push(s)}else{for(var h=0;h<n;h++){r[h].splice(l,0,null)}this.priv.columnSettings.splice(l,0,s)}a++;l++}this.instance.PluginHooks.run("afterCreateCol",e,a,o);this.instance.forceFullRender=true;return a};t.DataMap.prototype.removeRow=function(e,t){if(!t){t=1}if(typeof e!=="number"){e=-t}e=(this.instance.countRows()+e)%this.instance.countRows();var i=this.physicalRowsToLogical(e,t);var o=this.instance.PluginHooks.execute("beforeRemoveRow",e,t);if(o===false){return}var n=this.dataSource;var r=n.filter(function(e,t){return i.indexOf(t)==-1});n.length=0;Array.prototype.push.apply(n,r);this.instance.PluginHooks.run("afterRemoveRow",e,t);this.instance.forceFullRender=true};t.DataMap.prototype.removeCol=function(e,t){if(this.instance.dataType==="object"||this.instance.getSettings().columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!t){t=1}if(typeof e!=="number"){e=-t}e=(this.instance.countCols()+e)%this.instance.countCols();var i=this.instance.PluginHooks.execute("beforeRemoveCol",e,t);if(i===false){return}var o=this.dataSource;for(var n=0,r=this.instance.countRows();n<r;n++){o[n].splice(e,t)}this.priv.columnSettings.splice(e,t);this.instance.PluginHooks.run("afterRemoveCol",e,t);this.instance.forceFullRender=true};t.DataMap.prototype.spliceCol=function(e,i,o){var n=4<=arguments.length?[].slice.call(arguments,3):[];var r=this.instance.getDataAtCol(e);var s=r.slice(i,i+o);var a=r.slice(i+o);t.helper.extendArray(n,a);var l=0;while(l<o){n.push(null);l++}t.helper.to2dArray(n);this.instance.populateFromArray(i,e,n,null,null,"spliceCol");return s};t.DataMap.prototype.spliceRow=function(e,i,o){var n=4<=arguments.length?[].slice.call(arguments,3):[];var r=this.instance.getDataAtRow(e);var s=r.slice(i,i+o);var a=r.slice(i+o);t.helper.extendArray(n,a);var l=0;while(l<o){n.push(null);l++}this.instance.populateFromArray(e,i,[n],null,null,"spliceRow");return s};t.DataMap.prototype.get=function(e,t){this.getVars.row=e;this.getVars.prop=t;this.instance.PluginHooks.run("beforeGet",this.getVars);if(typeof this.getVars.prop==="string"&&this.getVars.prop.indexOf(".")>-1){var i=this.getVars.prop.split(".");var o=this.dataSource[this.getVars.row];if(!o){return null}for(var n=0,r=i.length;n<r;n++){o=o[i[n]];if(typeof o==="undefined"){return null}}return o}else if(typeof this.getVars.prop==="function"){return this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0])}else{return this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null}};var i=t.helper.cellMethodLookupFactory("copyable",false);t.DataMap.prototype.getCopyable=function(e,t){if(i.call(this.instance,e,this.propToCol(t))){return this.get(e,t)}return""};t.DataMap.prototype.set=function(e,t,i,o){this.setVars.row=e;this.setVars.prop=t;this.setVars.value=i;this.instance.PluginHooks.run("beforeSet",this.setVars,o||"datamapGet");if(typeof this.setVars.prop==="string"&&this.setVars.prop.indexOf(".")>-1){var n=this.setVars.prop.split(".");var r=this.dataSource[this.setVars.row];for(var s=0,a=n.length-1;s<a;s++){r=r[n[s]]}r[n[s]]=this.setVars.value}else if(typeof this.setVars.prop==="function"){this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value)}else{this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value}};t.DataMap.prototype.physicalRowsToLogical=function(e,t){var i=this.instance.countRows();var o=(i+e)%i;var n=[];var r=t;while(o<i&&r){this.get(o,0);n.push(this.getVars.row);r--;o++}return n};t.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++){for(var t=0;t<this.instance.countCols();t++){this.set(e,this.colToProp(t),"")}}};t.DataMap.prototype.getAll=function(){return this.dataSource};t.DataMap.prototype.getRange=function(e,t,i){var o,n,r,s,a=[],l;var c=i===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;n=Math.max(e.row,t.row);s=Math.max(e.col,t.col);for(o=Math.min(e.row,t.row);o<=n;o++){l=[];for(r=Math.min(e.col,t.col);r<=s;r++){l.push(c.call(this,o,this.colToProp(r)))}a.push(l)}return a};t.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))};t.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}})(i);(function(e){"use strict";e.renderers.cellDecorator=function(e,t,i,o,n,r,s){if(s.readOnly){e.view.wt.wtDom.addClass(t,s.readOnlyCellClassName)}if(s.valid===false&&s.invalidCellClassName){e.view.wt.wtDom.addClass(t,s.invalidCellClassName)}if(!r&&s.placeholder){e.view.wt.wtDom.addClass(t,s.placeholderCellClassName)}}})(i);(function(e){"use strict";var t=function(t,i,o,n,r,s,a){e.renderers.cellDecorator.apply(this,arguments);if(!s&&a.placeholder){s=a.placeholder}var l=e.helper.stringify(s);if(a.rendererTemplate){t.view.wt.wtDom.empty(i);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}");c.innerHTML=a.rendererTemplate;HTMLTemplateElement.decorate(c);c.model=t.getDataAtRow(o);i.appendChild(c)}else{t.view.wt.wtDom.fastInnerText(i,l)}};e.renderers.TextRenderer=t;e.renderers.registerRenderer("text",t)})(i);(function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var i=document.createElement("DIV");i.className="htAutocompleteArrow";i.appendChild(document.createTextNode("Ã¢â€“Â¼"));var o=function(t,i){i.innerHTML=t.innerHTML;e.Dom.empty(t);t.appendChild(i)};var n=function(o,n,r,s,a,l,c){var h=t.cloneNode(true);var u=i.cloneNode(true);e.renderers.TextRenderer(o,n,r,s,a,l,c);n.appendChild(u);e.Dom.addClass(n,"htAutocomplete");if(!n.firstChild){n.appendChild(document.createTextNode("Ã‚ "))}if(!o.acArrowListener){o.acArrowListener=function(){o.view.wt.getSetting("onCellDblClick")};o.rootElement.on("mousedown",".htAutocompleteArrow",o.acArrowListener)}};e.AutocompleteRenderer=n;e.renderers.AutocompleteRenderer=n;e.renderers.registerRenderer("autocomplete",n)})(i);(function(t){"use strict";var i=document.createElement("INPUT");i.className="htCheckboxRendererInput";i.type="checkbox";i.setAttribute("autocomplete","off");var o=function(o,n,r,s,a,l,c){if(typeof c.checkedTemplate==="undefined"){c.checkedTemplate=true}if(typeof c.uncheckedTemplate==="undefined"){c.uncheckedTemplate=false}o.view.wt.wtDom.empty(n);var h=i.cloneNode(false);if(l===c.checkedTemplate||l===t.helper.stringify(c.checkedTemplate)){h.checked=true;n.appendChild(h)}else if(l===c.uncheckedTemplate||l===t.helper.stringify(c.uncheckedTemplate)){n.appendChild(h)}else if(l===null){h.className+=" noValue";n.appendChild(h)}else{o.view.wt.wtDom.fastInnerText(n,"#bad value#")}var u=e(h);if(c.readOnly){u.on("click",function(e){e.preventDefault()})}else{u.on("mousedown",function(e){e.stopPropagation()});u.on("mouseup",function(e){e.stopPropagation()});u.on("change",function(){if(this.checked){o.setDataAtRowProp(r,a,c.checkedTemplate)}else{o.setDataAtRowProp(r,a,c.uncheckedTemplate)}})}if(!o.CheckboxRenderer||!o.CheckboxRenderer.beforeKeyDownHookBound){o.CheckboxRenderer={beforeKeyDownHookBound:true};o.addHook("beforeKeyDown",function(i){if(i.keyCode==t.helper.keyCode.SPACE){var n=o.getSelected();var r,s,a;var l={row:Math.min(n[0],n[2]),col:Math.min(n[1],n[3])};var c={row:Math.max(n[0],n[2]),col:Math.max(n[1],n[3])};for(var h=l.row;h<=c.row;h++){for(var u=c.col;u<=c.col;u++){r=o.getCell(h,u);a=o.getCellMeta(h,u);s=r.querySelectorAll("input[type=checkbox]");if(s.length>0&&!a.readOnly){if(!i.isImmediatePropagationStopped()){i.stopImmediatePropagation();i.preventDefault()}for(var f=0,d=s.length;f<d;f++){s[f].checked=!s[f].checked;e(s[f]).trigger("change")}}}}}})}};t.CheckboxRenderer=o;t.renderers.CheckboxRenderer=o;t.renderers.registerRenderer("checkbox",o)})(i);(function(e){"use strict";var t=function(t,i,o,n,r,s,a){if(e.helper.isNumeric(s)){if(typeof a.language!=="undefined"){numeral.language(a.language)}s=numeral(s).format(a.format||"0");t.view.wt.wtDom.addClass(i,"htNumeric")}e.renderers.TextRenderer(t,i,o,n,r,s,a)};e.NumericRenderer=t;e.renderers.NumericRenderer=t;e.renderers.registerRenderer("numeric",t)})(i);(function(e){"use strict";var t=function(e,t,o,n,r,s,a){i.renderers.TextRenderer.apply(this,arguments);s=t.innerHTML;var l;var c=a.hashLength||s.length;var h=a.hashSymbol||"*";for(l="";l.split(h).length-1<c;l+=h);e.view.wt.wtDom.fastInnerHTML(t,l)};e.PasswordRenderer=t;e.renderers.PasswordRenderer=t;e.renderers.registerRenderer("password",t)})(i);(function(e){function t(t,i,o,n,r,s,a){e.renderers.cellDecorator.apply(this,arguments);e.Dom.fastInnerHTML(i,s)}e.renderers.registerRenderer("html",t);e.renderers.HtmlRenderer=t})(i);(function(e){"use strict";e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};function t(t){this.instance=t;this.state=e.EditorState.VIRGIN;this._opened=false;this._closeCallback=null;this.init()}t.prototype._fireCallbacks=function(e){if(this._closeCallback){this._closeCallback(e);this._closeCallback=null}};t.prototype.init=function(){};t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};t.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")};t.prototype.open=function(){throw Error("Editor open() method unimplemented")};t.prototype.close=function(){throw Error("Editor close() method unimplemented")};t.prototype.prepare=function(t,i,o,n,r,s){this.TD=n;this.row=t;this.col=i;this.prop=o;this.originalValue=r;this.cellProperties=s;this.state=e.EditorState.VIRGIN};t.prototype.extend=function(){var e=this.constructor;function t(){e.apply(this,arguments)}function i(e,t){function i(){}i.prototype=t.prototype;e.prototype=new i;e.prototype.constructor=e;return e}return i(t,e)};t.prototype.saveValue=function(e,t){if(t){var i=this.instance.getSelected();this.instance.populateFromArray(i[0],i[1],e,i[2],i[3],"edit")}else{this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")}};t.prototype.beginEditing=function(t){if(this.state!=e.EditorState.VIRGIN){return}if(this.cellProperties.readOnly){return}this.instance.view.scrollViewport({row:this.row,col:this.col});this.instance.view.render();this.state=e.EditorState.EDITING;t=typeof t=="string"?t:this.originalValue;this.setValue(e.helper.stringify(t));this.open();this._opened=true;this.focus();this.instance.view.render()};t.prototype.finishEditing=function(t,i,o){if(o){var n=this._closeCallback;this._closeCallback=function(e){if(n){n(e)}o(e)}}if(this.isWaiting()){return}if(this.state==e.EditorState.VIRGIN){var r=this;setTimeout(function(){r._fireCallbacks(true)});return}if(this.state==e.EditorState.EDITING){if(t){this.cancelChanges();return}var s=[[String.prototype.trim.call(this.getValue())]];this.state=e.EditorState.WAITING;this.saveValue(s,i);if(this.instance.getCellValidator(this.cellProperties)){var r=this;this.instance.addHookOnce("afterValidate",function(t){r.state=e.EditorState.FINISHED;r.discardEditor(t)})}else{this.state=e.EditorState.FINISHED;this.discardEditor(true)}}};t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED;this.discardEditor()};t.prototype.discardEditor=function(t){if(this.state!==e.EditorState.FINISHED){return}if(t===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=e.EditorState.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this.state=e.EditorState.VIRGIN;this._fireCallbacks(true)}};t.prototype.isOpened=function(){return this._opened};t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING};e.editors.BaseEditor=t})(i);(function(t){var i=t.editors.BaseEditor.prototype.extend();i.prototype.init=function(){this.createElements();this.bindEvents()};i.prototype.getValue=function(){return this.TEXTAREA.value};i.prototype.setValue=function(e){this.TEXTAREA.value=e};var o=function e(i){var o=this;var n=o.getActiveEditor();var r=t.helper.keyCode;var s=(i.ctrlKey||i.metaKey)&&!i.altKey;if(i.target!==n.TEXTAREA||i.isImmediatePropagationStopped()){return}if(i.keyCode===17||i.keyCode===224||i.keyCode===91||i.keyCode===93){i.stopImmediatePropagation();return}switch(i.keyCode){case r.ARROW_RIGHT:if(n.wtDom.getCaretPosition(n.TEXTAREA)!==n.TEXTAREA.value.length){i.stopImmediatePropagation()}break;case r.ARROW_LEFT:if(n.wtDom.getCaretPosition(n.TEXTAREA)!==0){i.stopImmediatePropagation()}break;case r.ENTER:var a=n.instance.getSelected();var l=!(a[0]===a[2]&&a[1]===a[3]);if(s&&!l||i.altKey){if(n.isOpened()){n.setValue(n.getValue()+"\n");n.focus()}else{n.beginEditing(n.originalValue+"\n")}i.stopImmediatePropagation()}i.preventDefault();break;case r.A:case r.X:case r.C:case r.V:if(s){i.stopImmediatePropagation();break}case r.BACKSPACE:case r.DELETE:case r.HOME:case r.END:i.stopImmediatePropagation();break}};i.prototype.open=function(){this.refreshDimensions();this.instance.addHook("beforeKeyDown",o)};i.prototype.close=function(){this.textareaParentStyle.display="none";if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.instance.removeHook("beforeKeyDown",o)};i.prototype.focus=function(){this.TEXTAREA.focus();this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)};i.prototype.createElements=function(){this.$body=e(document.body);this.wtDom=new H;this.TEXTAREA=document.createElement("TEXTAREA");this.$textarea=e(this.TEXTAREA);this.wtDom.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);
var i=this;t.PluginHooks.add("afterRender",function(){i.instance.registerTimeout("refresh_editor_dimensions",function(){i.refreshDimensions()},0)})};i.prototype.refreshDimensions=function(){if(this.state!==t.EditorState.EDITING){return}this.TD=this.instance.getCell(this.row,this.col);if(!this.TD){return}var i=e(this.TD);var o=this.wtDom.offset(this.TD);var n=this.wtDom.offset(this.instance.rootElement[0]);var r=this.instance.rootElement.scrollTop();var s=this.instance.rootElement.scrollLeft();var a=o.top-n.top+r-1;var l=o.left-n.left+s-1;var c=this.instance.getSettings();var h=c.rowHeaders===false?0:1;var u=c.colHeaders===false?0:1;if(a<0){a=0}if(l<0){l=0}if(h>0&&parseInt(i.css("border-top-width"),10)>0){a+=1}if(u>0&&parseInt(i.css("border-left-width"),10)>0){l+=1}this.textareaParentStyle.top=a+"px";this.textareaParentStyle.left=l+"px";var f=i.width(),d=this.instance.view.maximumVisibleElementWidth(l)-10,p=i.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(a)-5;if(parseInt(i.css("border-top-width"),10)>0){p-=1}if(parseInt(i.css("border-left-width"),10)>0){if(h>0){f-=1}}this.$textarea.autoResize({minHeight:Math.min(p,g),maxHeight:g,minWidth:Math.min(f,d),maxWidth:d,animate:false,extraSpace:0});this.textareaParentStyle.display="block"};i.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(e){e.stopPropagation()});this.$textarea.on("paste.editor",function(e){e.stopPropagation()})};t.editors.TextEditor=i;t.editors.registerEditor("text",t.editors.TextEditor)})(i);(function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){this.saveValue([[!this.originalValue]])};t.prototype.finishEditing=function(){};t.prototype.init=function(){};t.prototype.open=function(){};t.prototype.close=function(){};t.prototype.getValue=function(){};t.prototype.setValue=function(){};t.prototype.focus=function(){};e.editors.CheckboxEditor=t;e.editors.registerEditor("checkbox",t)})(i);(function(t){var i=t.editors.TextEditor.prototype.extend();i.prototype.init=function(){if(!e.datepicker){throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?")}t.editors.TextEditor.prototype.init.apply(this,arguments);this.isCellEdited=false;var i=this;this.instance.addHook("afterDestroy",function(){i.destroyElements()})};i.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);this.datePicker=document.createElement("DIV");this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=99;document.body.appendChild(this.datePicker);this.$datePicker=e(this.datePicker);var i=this;var o={dateFormat:"yy-mm-dd",showButtonPanel:true,changeMonth:true,changeYear:true,onSelect:function(e){i.setValue(e);i.finishEditing(false)}};this.$datePicker.datepicker(o);this.$datePicker.on("mousedown",function(e){e.stopPropagation()});this.hideDatepicker()};i.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy");this.$datePicker.remove()};i.prototype.beginEditing=function(e,i,o,n,r){t.editors.TextEditor.prototype.beginEditing.apply(this,arguments);this.showDatepicker()};i.prototype.finishEditing=function(e,i){this.hideDatepicker();t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};i.prototype.showDatepicker=function(){var t=e(this.TD);var i=t.offset();this.datePickerStyle.top=i.top+t.height()+"px";this.datePickerStyle.left=i.left+"px";var o={defaultDate:this.originalValue||void 0};e.extend(o,this.cellProperties);this.$datePicker.datepicker("option",o);if(this.originalValue){this.$datePicker.datepicker("setDate",this.originalValue)}this.datePickerStyle.display="block"};i.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"};t.editors.DateEditor=i;t.editors.registerEditor("date",i)})(i);(function(t){"use strict";var i=t.editors.TextEditor.prototype.extend();i.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);var i=document.createElement("DIV");i.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(i);this.$htContainer=e(i);this.$htContainer.handsontable()};i.prototype.prepare=function(i,o,n,r,s,a){t.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this;var c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:false,cells:function(){return{readOnly:true}},fillHandle:false,afterOnCellMouseDown:function(){var e=this.getValue();if(e!==void 0){l.setValue(e)}l.instance.destroyEditor()},beforeOnKeyDown:function(e){var i=this;switch(e.keyCode){case t.helper.keyCode.ESCAPE:l.instance.destroyEditor(true);e.stopImmediatePropagation();e.preventDefault();break;case t.helper.keyCode.ENTER:var o=i.getSelected();var n=this.getDataAtCell(o[0],o[1]);if(n!==void 0){l.setValue(n)}l.instance.destroyEditor();break;case t.helper.keyCode.ARROW_UP:if(i.getSelected()&&i.getSelected()[0]==0&&!l.cellProperties.strict){i.deselectCell();l.instance.listen();l.focus();e.preventDefault();e.stopImmediatePropagation()}break}}};if(this.cellProperties.handsontable){c=e.extend(c,a.handsontable)}this.$htContainer.handsontable("destroy");this.$htContainer.handsontable(c)};var o=function(e){if(e.isImmediatePropagationStopped()){return}var i=this.getActiveEditor();var o=i.$htContainer.handsontable("getInstance");if(e.keyCode==t.helper.keyCode.ARROW_DOWN){if(!o.getSelected()){o.selectCell(0,0)}else{var n=o.getSelected()[0];var r=n<o.countRows()-1?n+1:n;o.selectCell(r,0)}e.preventDefault();e.stopImmediatePropagation()}};i.prototype.open=function(){this.instance.addHook("beforeKeyDown",o);t.editors.TextEditor.prototype.open.apply(this,arguments);this.$htContainer.handsontable("render");if(this.cellProperties.strict){this.$htContainer.handsontable("selectCell",0,0);this.$textarea[0].style.visibility="hidden"}else{this.$htContainer.handsontable("deselectCell");this.$textarea[0].style.visibility="visible"}this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)};i.prototype.close=function(){this.instance.removeHook("beforeKeyDown",o);this.instance.listen();t.editors.TextEditor.prototype.close.apply(this,arguments)};i.prototype.focus=function(){this.instance.listen();t.editors.TextEditor.prototype.focus.apply(this,arguments)};i.prototype.beginEditing=function(e){var i=this.instance.getSettings().onBeginEditing;if(i&&i()===false){return}t.editors.TextEditor.prototype.beginEditing.apply(this,arguments)};i.prototype.finishEditing=function(e,i){if(this.$htContainer.handsontable("isListening")){this.instance.listen()}if(this.$htContainer.handsontable("getSelected")){var o=this.$htContainer.handsontable("getInstance").getValue();if(o!==void 0){this.setValue(o)}}return t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};t.editors.HandsontableEditor=i;t.editors.registerEditor("handsontable",i)})(i);(function(e){var t=e.editors.HandsontableEditor.prototype.extend();t.prototype.init=function(){e.editors.HandsontableEditor.prototype.init.apply(this,arguments);this.query=null};t.prototype.createElements=function(){e.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);this.$htContainer.addClass("autocompleteEditor")};t.prototype.bindEvents=function(){var t=this;this.$textarea.on("keydown.autocompleteEditor",function(i){if(!e.helper.isMetaKey(i.keyCode)||[e.helper.keyCode.BACKSPACE,e.helper.keyCode.DELETE].indexOf(i.keyCode)!=-1){setTimeout(function(){t.queryChoices(t.$textarea.val())})}else if(i.keyCode==e.helper.keyCode.ENTER&&t.cellProperties.strict!==true){t.$htContainer.handsontable("deselectCell")}});this.$htContainer.on("mouseenter",function(){t.$htContainer.handsontable("deselectCell")});this.$htContainer.on("mouseleave",function(){t.queryChoices(t.query)});e.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)};t.prototype.beginEditing=function(){e.editors.HandsontableEditor.prototype.beginEditing.apply(this,arguments);var t=this;setTimeout(function(){t.queryChoices(t.TEXTAREA.value)});var i=this.$htContainer.handsontable("getInstance");i.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(e,i,o,n,r){var s=this.getCellMeta(i,o).filteringCaseSensitive===true;var a=s?r.indexOf(t.query):r.toLowerCase().indexOf(t.query.toLowerCase());if(a!=-1){var l=r.substr(a,t.query.length);e.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}})};var i;t.prototype.open=function(){var t=this;i=function(i){var o=this;if(i.keyCode==e.helper.keyCode.ARROW_UP){if(o.getSelected()&&o.getSelected()[0]==0){if(!t.cellProperties.strict){o.deselectCell()}t.instance.listen();t.focus();i.preventDefault();i.stopImmediatePropagation()}}};this.$htContainer.handsontable("getInstance").addHook("beforeKeyDown",i);e.editors.HandsontableEditor.prototype.open.apply(this,arguments);this.$textarea[0].style.visibility="visible";t.focus()};t.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",i);e.editors.HandsontableEditor.prototype.close.apply(this,arguments)};t.prototype.queryChoices=function(t){this.query=t;if(typeof this.cellProperties.source=="function"){var i=this;this.cellProperties.source(t,function(e){i.updateChoicesList(e)})}else if(e.helper.isArray(this.cellProperties.source)){var o;if(!t||this.cellProperties.filter===false){o=this.cellProperties.source}else{var n=this.cellProperties.filteringCaseSensitive===true;var r=t.toLowerCase();o=this.cellProperties.source.filter(function(e){if(n){return e.indexOf(t)!=-1}else{return e.toLowerCase().indexOf(r)!=-1}})}this.updateChoicesList(o)}else{this.updateChoicesList([])}};function o(e,t){var i={};var o=t.length;var n;var r;var s;for(var a=0,l=e.length;a<l;a++){n=e[a];if(o>0){r=n.indexOf(t)}else{r=n===t?0:-1}if(r==-1)continue;s=n.length-r-o;if(typeof i.indexOfValue=="undefined"||i.indexOfValue>r||i.indexOfValue==r&&i.charsLeft>s){i.indexOfValue=r;i.charsLeft=s;i.index=a}}return i.index}t.prototype.updateChoicesList=function(t){this.$htContainer.handsontable("loadData",e.helper.pivot([t]));var i=this.getValue();var n;if(this.cellProperties.strict===true){n=o(t,i);if(typeof n=="undefined"&&this.cellProperties.allowInvalid===false){n=0}}if(typeof n=="undefined"){this.$htContainer.handsontable("deselectCell")}else{this.$htContainer.handsontable("selectCell",n,0)}this.focus()};e.editors.AutocompleteEditor=t;e.editors.registerEditor("autocomplete",t)})(i);(function(t){var i=t.editors.TextEditor.prototype.extend();var o=new H;i.prototype.createElements=function(){t.editors.TextEditor.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=e(this.TEXTAREA);o.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};t.editors.PasswordEditor=i;t.editors.registerEditor("password",i)})(i);(function(t){var i=t.editors.BaseEditor.prototype.extend();i.prototype.init=function(){this.select=e("<select />").addClass("htSelectEditor").hide();this.instance.rootElement.append(this.select)};i.prototype.prepare=function(){t.editors.BaseEditor.prototype.prepare.apply(this,arguments);var i=this.cellProperties.selectOptions;var o;if(typeof i=="function"){o=this.prepareOptions(i(this.row,this.col,this.prop))}else{o=this.prepareOptions(i)}var n=[];for(var r in o){if(o.hasOwnProperty(r)){var s=e("<option />");s.val(r);s.html(o[r]);n.push(s)}}this.select.empty();this.select.append(n)};i.prototype.prepareOptions=function(e){var i={};if(t.helper.isArray(e)){for(var o=0,n=e.length;o<n;o++){i[e[o]]=e[o]}}else if(typeof e=="object"){i=e}return i};i.prototype.getValue=function(){return this.select.val()};i.prototype.setValue=function(e){this.select.val(e)};var o=function(e){var i=this;var o=i.getActiveEditor();switch(e.keyCode){case t.helper.keyCode.ARROW_UP:var n=o.select.find("option:selected").prev();if(n.length==1){n.prop("selected",true)}e.stopImmediatePropagation();e.preventDefault();break;case t.helper.keyCode.ARROW_DOWN:var r=o.select.find("option:selected").next();if(r.length==1){r.prop("selected",true)}e.stopImmediatePropagation();e.preventDefault();break}};i.prototype.open=function(){this.select.css({height:e(this.TD).height(),"min-width":e(this.TD).outerWidth()});this.select.show();this.select.offset(e(this.TD).offset());this.instance.addHook("beforeKeyDown",o)};i.prototype.close=function(){this.select.hide();this.instance.removeHook("beforeKeyDown",o)};i.prototype.focus=function(){this.select.focus()};t.editors.SelectEditor=i;t.editors.registerEditor("select",i)})(i);(function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments);this.cellProperties.filter=false;this.cellProperties.strict=true};e.editors.DropdownEditor=t;e.editors.registerEditor("dropdown",t)})(i);i.NumericValidator=function(e,t){if(e===null){e=""}t(/^-?\d*\.?\d*$/.test(e))};var n=function(e,t){var i=e;var o=typeof i==="string"?i.toLowerCase():null;return function(e){var n=false;for(var r=0,s=e.length;r<s;r++){if(i===e[r]){n=true;break}else if(o===e[r].toLowerCase()){n=true;break}}t(n)}};i.AutocompleteValidator=function(e,t){if(this.strict&&this.source){typeof this.source==="function"?this.source(e,n(e,t)):n(e,t)(this.source)}else{t(true)}};i.AutocompleteCell={editor:i.editors.AutocompleteEditor,renderer:i.renderers.AutocompleteRenderer,validator:i.AutocompleteValidator};i.CheckboxCell={editor:i.editors.CheckboxEditor,renderer:i.renderers.CheckboxRenderer};i.TextCell={editor:i.editors.TextEditor,renderer:i.renderers.TextRenderer};i.NumericCell={editor:i.editors.TextEditor,renderer:i.renderers.NumericRenderer,validator:i.NumericValidator,dataType:"number"};i.DateCell={editor:i.editors.DateEditor,renderer:i.renderers.AutocompleteRenderer};i.HandsontableCell={editor:i.editors.HandsontableEditor,renderer:i.renderers.AutocompleteRenderer};i.PasswordCell={editor:i.editors.PasswordEditor,renderer:i.renderers.PasswordRenderer,copyable:false};i.DropdownCell={editor:i.editors.DropdownEditor,renderer:i.renderers.AutocompleteRenderer,validator:i.AutocompleteValidator};i.cellTypes={text:i.TextCell,date:i.DateCell,numeric:i.NumericCell,checkbox:i.CheckboxCell,autocomplete:i.AutocompleteCell,handsontable:i.HandsontableCell,password:i.PasswordCell,dropdown:i.DropdownCell};i.cellLookup={validator:{numeric:i.NumericValidator,autocomplete:i.AutocompleteValidator}};(function(e){t.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};t.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];t.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"};t.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";t.AutoResizer=i;e.fn.autoResize=t;function t(o){this.filter(t.resizableFilterSelector).each(function(){new i(e(this),o)});return this}function i(i,o){if(this.clones)return;this.config=e.extend({},t.defaults,o);this.el=i;this.nodeName=i[0].nodeName.toLowerCase();this.previousScrollTop=null;if(o.maxWidth==="original")o.maxWidth=i.width();if(o.minWidth==="original")o.minWidth=i.width();if(o.maxHeight==="original")o.maxHeight=i.height();if(o.minHeight==="original")o.minHeight=i.height();if(this.nodeName==="textarea"){i.css({resize:"none",overflowY:"none"})}i.data("AutoResizer",this);this.createClone();this.injectClone();this.bind()}i.prototype={bind:function(){var t=e.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",t).bind("change.autoResize",t);this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var i=this.el,o=this,n=this.config;this.clones=e();if(n.minHeight!=="original"||n.maxHeight!=="original"){this.hClone=i.clone().height("auto");this.clones=this.clones.add(this.hClone)}if(n.minWidth!=="original"||n.maxWidth!=="original"){this.wClone=e("<div/>").width("auto").css({whiteSpace:"nowrap",float:"left"});this.clones=this.clones.add(this.wClone)}e.each(t.cloneCSSProperties,function(e,t){o.clones.css(t,i.css(t))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(t.cloneCSSValues).css("overflowY","scroll")},check:function(e,t){var i=this.config,o=this.wClone,n=this.hClone,r=this.el,s=r.val();if(o){o.text(s);var a=o.outerWidth(),l=a+i.extraSpace>=i.minWidth?a+i.extraSpace:i.minWidth,c=r.width();l=Math.min(l,i.maxWidth);if(l<c&&l>=i.minWidth||l>=i.minWidth&&l<=i.maxWidth){i.onResize.call(r);r.scrollLeft(0);i.animate&&!t?r.stop(1,1).animate({width:l},i.animate):r.width(l)}}if(n){if(l){n.width(l)}n.height(0).val(s).scrollTop(1e4);var h=n[0].scrollTop+i.extraSpace;if(this.previousScrollTop===h){return}this.previousScrollTop=h;if(h>=i.maxHeight){h=i.maxHeight}if(h<i.minHeight){h=i.minHeight}if(h==i.maxHeight&&l==i.maxWidth){r.css("overflowY","scroll")}else{r.css("overflowY","hidden")}i.onResize.call(r);i.animate&&!t?r.stop(1,1).animate({height:h},i.animate):r.height(h)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(t.cloneContainer||(t.cloneContainer=e("<arclones/>").appendTo("body"))).empty().append(this.clones)}}})(jQuery);(function(e){"use strict";function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var i,o,n,r=[],s=0,a,l,c,h;n=e.split("\n");if(n.length>1&&n[n.length-1]===""){n.pop()}for(i=0,o=n.length;i<o;i+=1){n[i]=n[i].split("	");for(a=0,l=n[i].length;a<l;a+=1){if(!r[s]){r[s]=[]}if(c&&a===0){h=r[s].length-1;r[s][h]=r[s][h]+"\n"+n[i][0];if(c&&t(n[i][0])&1){c=false;r[s][h]=r[s][h].substring(0,r[s][h].length-1).replace(/""/g,'"')}}else{if(a===l-1&&n[i][a].indexOf('"')===0){r[s].push(n[i][a].substring(1).replace(/""/g,'"'));c=true}else{r[s].push(n[i][a].replace(/""/g,'"'));c=false}}}if(!c){s+=1}}return r},stringify:function(e){var t,i,o,n,r="",s;for(t=0,i=e.length;t<i;t+=1){for(o=0,n=e[t].length;o<n;o+=1){if(o>0){r+="	"}s=e[t][o];if(typeof s==="string"){if(s.indexOf("\n")>-1){r+='"'+s.replace(/"/g,'""')+'"'}else{r+=s}}else if(s===null||s===void 0){r+=""}else{r+=s}}r+="\n"}return r}}})(t);var r=function(){var e;return{getInstance:function(){if(!e){e=new s}else if(e.hasBeenDestroyed()){e.init()}e.refCounter++;return e}}}();function s(){this.refCounter=0;this.init()}s.prototype.init=function(){var e=this,t,i;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];this.listenerElement=document.documentElement;i=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("DIV");this.elDiv.id="CopyPasteDiv";t=this.elDiv.style;t.position="fixed";t.top=0;t.left=0;i.appendChild(this.elDiv);this.elTextarea=document.createElement("TEXTAREA");this.elTextarea.className="copyPaste";t=this.elTextarea.style;t.width="1px";t.height="1px";this.elDiv.appendChild(this.elTextarea);if(typeof t.opacity!=="undefined"){t.opacity=0}else{}}this.keydownListener=function(t){var i=false;if(t.metaKey){i=true}else if(t.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){i=true}if(i){if(document.activeElement!==e.elTextarea&&(e.getSelectionText()!=""||["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)!=-1)){return}e.selectNodeText(e.elTextarea);setTimeout(function(){e.selectNodeText(e.elTextarea)},0)}if(i&&(t.keyCode===67||t.keyCode===86||t.keyCode===88)){if(t.keyCode===88){setTimeout(function(){e.triggerCut(t)},0)}else if(t.keyCode===86){setTimeout(function(){e.triggerPaste(t)},0)}}};this._bindEvent(this.listenerElement,"keydown",this.keydownListener)};s.prototype.selectNodeText=function(e){e.select()};s.prototype.getSelectionText=function(){var e="";if(t.getSelection){e=t.getSelection().toString()}else if(document.selection&&document.selection.type!="Control"){e=document.selection.createRange().text}return e};s.prototype.copyable=function(e){if(typeof e!=="string"&&e.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=e};s.prototype.onCut=function(e){this.cutCallbacks.push(e)};s.prototype.onPaste=function(e){this.pasteCallbacks.push(e)};s.prototype.removeCallback=function(e){var t,i;for(t=0,i=this.copyCallbacks.length;t<i;t++){if(this.copyCallbacks[t]===e){this.copyCallbacks.splice(t,1);return true}}for(t=0,i=this.cutCallbacks.length;t<i;t++){if(this.cutCallbacks[t]===e){this.cutCallbacks.splice(t,1);return true}}for(t=0,i=this.pasteCallbacks.length;t<i;t++){if(this.pasteCallbacks[t]===e){this.pasteCallbacks.splice(t,1);return true}}return false};s.prototype.triggerCut=function(e){var t=this;if(t.cutCallbacks){setTimeout(function(){for(var i=0,o=t.cutCallbacks.length;i<o;i++){t.cutCallbacks[i](e)}},50)}};s.prototype.triggerPaste=function(e,t){var i=this;if(i.pasteCallbacks){setTimeout(function(){var o=(t||i.elTextarea.value).replace(/\n$/,"");for(var n=0,r=i.pasteCallbacks.length;n<r;n++){i.pasteCallbacks[n](o,e)}},50)}};s.prototype.destroy=function(){if(!this.hasBeenDestroyed()&&--this.refCounter==0){if(this.elDiv&&this.elDiv.parentNode){this.elDiv.parentNode.removeChild(this.elDiv)}this._unbindEvent(this.listenerElement,"keydown",this.keydownListener)}};s.prototype.hasBeenDestroyed=function(){return!this.refCounter};s.prototype._bindEvent=function(){if(t.jQuery){return function(t,i,o){e(t).on(i+".copypaste",o)}}else{return function(e,t,i){e.addEventListener(t,i,false)}}}();s.prototype._unbindEvent=function(){if(t.jQuery){return function(t,i,o){e(t).off(i+".copypaste",o)}}else{return function(e,t,i){e.removeEventListener(t,i,false)}}}();var a;(function(e){var i={add:function(e,t){e[t]=this.value;return true},remove:function(e,t){delete e[t];return true},replace:function(e,t){e[t]=this.value;return true},move:function(e,t,i){var o={op:"_get",path:this.from};S(i,[o]);S(i,[{op:"remove",path:this.from}]);S(i,[{op:"add",path:this.path,value:o.value}]);return true},copy:function(e,t,i){var o={op:"_get",path:this.from};S(i,[o]);S(i,[{op:"add",path:this.path,value:o.value}]);return true},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}};var o={add:function(e,t){e.splice(t,0,this.value);return true},remove:function(e,t){e.splice(t,1);return true},replace:function(e,t){e[t]=this.value;return true},move:i.move,copy:i.copy,test:i.test,_get:i._get};var n={add:function(e,t){var i={op:"add",path:t+r(this.name),value:this.object[this.name]};e.push(i)},delete:function(e,t){var i={op:"remove",path:t+r(this.name)};e.push(i)},update:function(e,t){var i={op:"replace",path:t+r(this.name),value:this.object[this.name]};e.push(i)}};function r(e){if(e.indexOf("/")===-1&&e.indexOf("~")===-1)return e;return e.replace(/~/g,"~0").replace(/\//g,"~1")}function s(e,t){var i;for(var o in e){if(e.hasOwnProperty(o)){if(e[o]===t){return r(o)+"/"}else if(typeof e[o]==="object"){i=s(e[o],t);if(i!=""){return r(o)+"/"+i}}}}return""}function a(e,t){if(e===t){return"/"}var i=s(e,t);if(i===""){throw new Error("Object not found in root")}return"/"+i}var l=[];e.intervals;var c=function(){function e(e){this.observers=[];this.obj=e}return e}();var h=function(){function e(e,t){this.callback=e;this.observer=t}return e}();function u(e){for(var t=0,i=l.length;t<i;t++){if(l[t].obj===e){return l[t]}}}function f(e,t){for(var i=0,o=e.observers.length;i<o;i++){if(e.observers[i].callback===t){return e.observers[i].observer}}}function d(e,t){for(var i=0,o=e.observers.length;i<o;i++){if(e.observers[i].observer===t){e.observers.splice(i,1);return}}}function p(e,t){w(t);if(Object.observe){v(t,e)}else{clearTimeout(t.next)}var i=u(e);d(i,t)}e.unobserve=p;function g(e,i){var o=[];var r=e;var s;var d=u(e);if(!d){d=new c(e);l.push(d)}else{s=f(d,i)}if(s){return s}if(Object.observe){s=function(t){v(s,e);m(s,e);var l=0,c=t.length;while(l<c){if(!(t[l].name==="length"&&b(t[l].object))&&!(t[l].name==="__Jasmine_been_here_before__")){var h=t[l].type;switch(h){case"new":h="add";break;case"deleted":h="delete";break;case"updated":h="update";break}n[h].call(t[l],o,a(r,t[l].object))}l++}if(o){if(i){i(o)}}s.patches=o;o=[]}}else{s={};d.value=JSON.parse(JSON.stringify(e));if(i){s.callback=i;s.next=null;var p=this.intervals||[100,1e3,1e4,6e4];var g=0;var y=function(){w(s)};var C=function(){clearTimeout(s.next);s.next=setTimeout(function(){y();g=0;s.next=setTimeout(S,p[g++])},0)};var S=function(){y();if(g==p.length)g=p.length-1;s.next=setTimeout(S,p[g++])};if(typeof t!=="undefined"){if(t.addEventListener){t.addEventListener("mousedown",C);t.addEventListener("mouseup",C);t.addEventListener("keydown",C)}else{t.attachEvent("onmousedown",C);t.attachEvent("onmouseup",C);t.attachEvent("onkeydown",C)}}s.next=setTimeout(S,p[g++])}}s.patches=o;s.object=e;d.observers.push(new h(i,s));return m(s,e)}e.observe=g;function m(e,t){if(Object.observe){Object.observe(t,e);for(var i in t){if(t.hasOwnProperty(i)){var o=t[i];if(o&&typeof o==="object"){m(e,o)}}}}return e}function v(e,t){if(Object.observe){Object.unobserve(t,e);for(var i in t){if(t.hasOwnProperty(i)){var o=t[i];if(o&&typeof o==="object"){v(e,o)}}}}return e}function w(e){if(Object.observe){Object.deliverChangeRecords(e)}else{var t;for(var i=0,o=l.length;i<o;i++){if(l[i].obj===e.object){t=l[i];break}}C(t.value,e.object,e.patches,"")}var n=e.patches;if(n.length>0){e.patches=[];if(e.callback){e.callback(n)}}return n}e.generate=w;var y;if(Object.keys){y=Object.keys}else{y=function(e){var t=[];for(var i in e){if(e.hasOwnProperty(i)){t.push(i)}}return t}}function C(e,t,i,o){var n=y(t);var s=y(e);var a=false;var l=false;for(var c=s.length-1;c>=0;c--){var h=s[c];var u=e[h];if(t.hasOwnProperty(h)){var f=t[h];if(u instanceof Object){C(u,f,i,o+"/"+r(h))}else{if(u!=f){a=true;i.push({op:"replace",path:o+"/"+r(h),value:f});e[h]=f}}}else{i.push({op:"remove",path:o+"/"+r(h)});delete e[h];l=true}}if(!l&&n.length==s.length){return}for(var c=0;c<n.length;c++){var h=n[c];if(!e.hasOwnProperty(h)){i.push({op:"add",path:o+"/"+r(h),value:t[h]});e[h]=JSON.parse(JSON.stringify(t[h]))}}}var b;if(Array.isArray){b=Array.isArray}else{b=function(e){return e.push&&typeof e.length==="number"}}function S(e,t){var n=false,r=0,s=t.length,a;while(r<s){a=t[r];var l=a.path.split("/");var c=e;var h=1;var u=l.length;while(true){if(b(c)){var f=parseInt(l[h],10);h++;if(h>=u){n=o[a.op].call(a,c,f,e);break}c=c[f]}else{var d=l[h];if(d.indexOf("~")!=-1)d=d.replace(/~1/g,"/").replace(/~0/g,"~");h++;if(h>=u){n=i[a.op].call(a,c,d,e);break}c=c[d]}}r++}return n}e.apply=S})(a||(a={}));if(typeof exports!=="undefined"){exports.apply=a.apply;exports.observe=a.observe;exports.unobserve=a.unobserve;exports.generate=a.generate}i.PluginHookClass=function(){var e=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}};var t={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};function o(){this.hooks=e();this.legacy=t}o.prototype.add=function(e,o){if(i.helper.isArray(o)){for(var n=0,r=o.length;n<r;n++){this.add(e,o[n])}}else{if(e in t){e=t[e]}if(typeof this.hooks[e]==="undefined"){this.hooks[e]=[]}if(this.hooks[e].indexOf(o)==-1){this.hooks[e].push(o)}}return this};o.prototype.once=function(e,t){if(i.helper.isArray(t)){for(var o=0,n=t.length;o<n;o++){t[o].runOnce=true;this.add(e,t[o])}}else{t.runOnce=true;this.add(e,t)}};o.prototype.remove=function(e,i){var o=false;if(e in t){e=t[e]}if(typeof this.hooks[e]!=="undefined"){for(var n=0,r=this.hooks[e].length;n<r;n++){if(this.hooks[e][n]==i){delete this.hooks[e][n].runOnce;this.hooks[e].splice(n,1);o=true;break}}}return o};o.prototype.run=function(e,i,o,n,r,s,a){if(i in t){i=t[i]}if(typeof this.hooks[i]!=="undefined"){var l=Array.prototype.slice.call(this.hooks[i]);for(var c=0,h=l.length;c<h;c++){l[c].call(e,o,n,r,s,a);if(l[c].runOnce){this.remove(i,l[c])}}}};o.prototype.execute=function(e,i,o,n,r,s,a){var l,c;if(i in t){i=t[i]}if(typeof this.hooks[i]!=="undefined"){c=Array.prototype.slice.call(this.hooks[i]);for(var h=0,u=c.length;h<u;h++){l=c[h].call(e,o,n,r,s,a);if(l!==void 0){o=l}if(c[h].runOnce){this.remove(i,c[h])}if(l===false){return false}}}return o};return o}();i.PluginHooks=new i.PluginHookClass;(function(e){function t(){var t=this,o=5;this.beforeInit=function(){var e=this;e.autoColumnWidths=[];if(e.getSettings().autoColumnSize!==false){if(!e.autoColumnSizeTmp){e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:true};e.addHook("beforeRender",i.determineIfChanged);e.addHook("afterGetColWidth",i.getColWidth);e.addHook("afterDestroy",i.afterDestroy);e.determineColumnWidth=t.determineColumnWidth}}else{if(e.autoColumnSizeTmp){e.removeHook("beforeRender",i.determineIfChanged);e.removeHook("afterGetColWidth",i.getColWidth);e.removeHook("afterDestroy",i.afterDestroy);delete e.determineColumnWidth;t.afterDestroy.call(e)}}};this.determineIfChanged=function(e){if(e){i.determineColumnsWidth.apply(this,arguments)}};this.determineColumnWidth=function(t){var i=this,r=i.autoColumnSizeTmp;if(!r.container){n.call(r,i)}r.container.className=i.rootElement[0].className+" htAutoColumnSize";r.table.className=i.$table[0].className;var s=i.countRows();var a={};var l=0;for(var c=0;c<s;c++){var h=e.helper.stringify(i.getDataAtCell(c,t));var u=h.length;if(u>l){l=u}if(!a[u]){a[u]={needed:o,strings:[]}}if(a[u].needed){a[u].strings.push({value:h,row:c});a[u].needed--}}var f=i.getSettings();if(f.colHeaders){i.view.appendColHeader(t,r.theadTh)}i.view.wt.wtDom.empty(r.tbody);for(var d in a){if(a.hasOwnProperty(d)){for(var p=0,g=a[d].strings.length;p<g;p++){var m=a[d].strings[p].row;var v=i.getCellMeta(m,t);v.col=t;v.row=m;var w=i.getCellRenderer(v);var y=document.createElement("tr");var C=document.createElement("td");w(i,C,m,t,i.colToProp(t),a[d].strings[p].value,v);c++;y.appendChild(C);r.tbody.appendChild(y)}}}var b=i.rootElement[0].parentNode;b.appendChild(r.container);var S=i.view.wt.wtDom.outerWidth(r.table);b.removeChild(r.container);if(!f.nativeScrollbars){var T=i.view.wt.wtViewport.getViewportWidth()-2;if(S>T){S=T}}return S};this.determineColumnsWidth=function(){var e=this;var i=this.getSettings();if(i.autoColumnSize||!i.colWidths){var o=this.countCols();for(var n=0;n<o;n++){if(!e._getColWidthFromSettings(n)){this.autoColumnWidths[n]=t.determineColumnWidth.call(e,n)
}}}};this.getColWidth=function(e,t){if(this.autoColumnWidths[e]&&this.autoColumnWidths[e]>t.width){t.width=this.autoColumnWidths[e]}};this.afterDestroy=function(){var e=this;if(e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode){e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container)}e.autoColumnSizeTmp=null};function n(e){var t=document,i=this;i.table=t.createElement("table");i.theadTh=t.createElement("th");i.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(i.theadTh);i.tableStyle=i.table.style;i.tableStyle.tableLayout="auto";i.tableStyle.width="auto";i.tbody=t.createElement("tbody");i.table.appendChild(i.tbody);i.container=t.createElement("div");i.container.className=e.rootElement[0].className+" hidden";i.containerStyle=i.container.style;i.container.appendChild(i.table)}}var i=new t;e.PluginHooks.add("beforeInit",i.beforeInit);e.PluginHooks.add("afterUpdateSettings",i.beforeInit)})(i);function l(){var e=this;this.init=function(t){var r=this;var s=r.getSettings().columnSorting;var a,l;r.sortingEnabled=!!s;if(r.sortingEnabled){r.sortIndex=[];var c=i.call(r);if(typeof c!="undefined"){a=c.sortColumn;l=c.sortOrder}else{a=s.column;l=s.sortOrder}e.sortByColumn.call(r,a,l);r.sort=function(){var t=Array.prototype.slice.call(arguments);return e.sortByColumn.apply(r,t)};if(typeof r.getSettings().observeChanges=="undefined"){n.call(r)}if(t=="afterInit"){o.call(r);r.addHook("afterCreateRow",e.afterCreateRow);r.addHook("afterRemoveRow",e.afterRemoveRow);r.addHook("afterLoadData",e.init)}}else{delete r.sort;r.removeHook("afterCreateRow",e.afterCreateRow);r.removeHook("afterRemoveRow",e.afterRemoveRow);r.removeHook("afterLoadData",e.init)}};this.setSortingColumn=function(e,t){var i=this;if(typeof e=="undefined"){delete i.sortColumn;delete i.sortOrder;return}else if(i.sortColumn===e&&typeof t=="undefined"){i.sortOrder=!i.sortOrder}else{i.sortOrder=typeof t!="undefined"?t:true}i.sortColumn=e};this.sortByColumn=function(i,o){var n=this;e.setSortingColumn.call(n,i,o);if(typeof n.sortColumn=="undefined"){return}n.PluginHooks.run("beforeColumnSort",n.sortColumn,n.sortOrder);e.sort.call(n);n.render();t.call(n);n.PluginHooks.run("afterColumnSort",n.sortColumn,n.sortOrder)};var t=function(){var e=this;var t={};if(typeof e.sortColumn!="undefined"){t.sortColumn=e.sortColumn}if(typeof e.sortOrder!="undefined"){t.sortOrder=e.sortOrder}if(t.hasOwnProperty("sortColumn")||t.hasOwnProperty("sortOrder")){e.PluginHooks.run("persistentStateSave","columnSorting",t)}};var i=function(){var e=this;var t={};e.PluginHooks.run("persistentStateLoad","columnSorting",t);return t.value};var o=function(){var t=this;t.rootElement.on("click.handsontable",".columnSorting",function(i){if(t.view.wt.wtDom.hasClass(i.target,"columnSorting")){var n=o(i.target);e.sortByColumn.call(t,n)}});function i(){var e=t.view.TBODY.querySelector("tr").querySelectorAll("th");return e.length}function o(e){var o=t.view.wt.wtDom.closest(e,"TH");return t.view.wt.wtDom.index(o)-i()}};function n(){var e=this;e.registerTimeout("enableObserveChanges",function(){e.updateSettings({observeChanges:true})},0)}function r(e){return function(t,i){if(t[1]===i[1]){return 0}if(t[1]===null){return 1}if(i[1]===null){return-1}if(t[1]<i[1])return e?-1:1;if(t[1]>i[1])return e?1:-1;return 0}}function s(e){return function(t,i){if(t[1]===i[1]){return 0}if(t[1]===null){return 1}if(i[1]===null){return-1}var o=new Date(t[1]);var n=new Date(i[1]);if(o<n)return e?-1:1;if(o>n)return e?1:-1;return 0}}this.sort=function(){var e=this;if(typeof e.sortOrder=="undefined"){return}e.sortingEnabled=false;e.sortIndex.length=0;var t=this.colOffset();for(var i=0,o=this.countRows()-e.getSettings()["minSpareRows"];i<o;i++){this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+t)])}var n=e.getCellMeta(0,e.sortColumn);var a;switch(n.type){case"date":a=s;break;default:a=r}this.sortIndex.sort(a(e.sortOrder));for(var i=this.sortIndex.length;i<e.countRows();i++){this.sortIndex.push([i,e.getDataAtCell(i,this.sortColumn+t)])}e.sortingEnabled=true};this.translateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]){return t.sortIndex[e][0]}return e};this.onBeforeGetSet=function(t){var i=this;t.row=e.translateRow.call(i,t.row)};this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length){for(var i=0;i<t.sortIndex.length;i++){if(t.sortIndex[i][0]==e){return i}}}};this.getColHeader=function(e,t){if(this.getSettings().columnSorting){this.view.wt.wtDom.addClass(t.querySelector(".colHeader"),"columnSorting")}};function a(e){return typeof e.sortColumn!="undefined"}this.afterCreateRow=function(e,i){var o=this;if(!a(o)){return}for(var n=0;n<o.sortIndex.length;n++){if(o.sortIndex[n][0]>=e){o.sortIndex[n][0]+=i}}for(var n=0;n<i;n++){o.sortIndex.splice(e+n,0,[e+n,o.getData()[e+n][o.sortColumn+o.colOffset()]])}t.call(o)};this.afterRemoveRow=function(i,o){var n=this;if(!a(n)){return}var r=e.translateRow.call(n,i);n.sortIndex.splice(i,o);for(var s=0;s<n.sortIndex.length;s++){if(n.sortIndex[s][0]>r){n.sortIndex[s][0]-=o}}t.call(n)};this.afterChangeSort=function(t){var i=this;var o=false;var n={};if(!t){return}for(var r=0;r<t.length;r++){if(t[r][1]==i.sortColumn){o=true;n.row=e.translateRow.call(i,t[r][0]);n.col=t[r][1];break}}if(o){setTimeout(function(){e.sort.call(i);i.render();i.selectCell(e.untranslateRow.call(i,n.row),n.col)},0)}}}var c=new l;i.PluginHooks.add("afterInit",function(){c.init.call(this,"afterInit")});i.PluginHooks.add("afterUpdateSettings",function(){c.init.call(this,"afterUpdateSettings")});i.PluginHooks.add("beforeGet",c.onBeforeGetSet);i.PluginHooks.add("beforeSet",c.onBeforeGetSet);i.PluginHooks.add("afterGetColHeader",c.getColHeader);(function(t){"use strict";function i(o,n){this.instance=o;var r=this;this.menu=s();this.enabled=true;this.bindMouseEvents();this.bindTableEvents();this.instance.addHook("afterDestroy",function(){r.destroy()});this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:i.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:i.SEPARATOR,remove_row:{name:"Remove row",callback:function(e,t){var i=t.end.row()-t.start.row()+1;this.alter("remove_row",t.start.row(),i)}},remove_col:{name:"Remove column",callback:function(e,t){var i=t.end.col()-t.start.col()+1;this.alter("remove_col",t.start.col(),i)}},hsep3:i.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}};this.options={};t.helper.extend(this.options,this.defaultOptions);this.updateOptions(n);function s(){var i=e("body > .htContextMenu")[0];if(!i){i=document.createElement("DIV");t.Dom.addClass(i,"htContextMenu");document.getElementsByTagName("body")[0].appendChild(i)}return i}}i.prototype.bindMouseEvents=function(){function o(o){o.preventDefault();if(o.target.nodeName!="TD"&&!(t.Dom.hasClass(o.target,"current")&&t.Dom.hasClass(o.target,"wtBorder"))){return}this.show(o.pageY,o.pageX);e(document).on("mousedown.htContextMenu",t.helper.proxy(i.prototype.close,this))}this.instance.rootElement.on("contextmenu.htContextMenu",t.helper.proxy(o,this))};i.prototype.bindTableEvents=function(){var e=this;this._afterScrollCallback=function(){e.close()};this.instance.addHook("afterScrollVertically",this._afterScrollCallback);this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)};i.prototype.unbindTableEvents=function(){var e=this;if(this._afterScrollCallback){this.instance.removeHook("afterScrollVertically",this._afterScrollCallback);this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback);this._afterScrollCallback=null}};i.prototype.performAction=function(){var t=e(this.menu).handsontable("getInstance");var o=t.getSelected()[0];var n=t.getData()[o];if(n.disabled===true||typeof n.disabled=="function"&&n.disabled.call(this.instance)===true){return}if(typeof n.callback!="function"){return}var r=this.instance.getSelected();var s=i.utils.normalizeSelection(r);n.callback.call(this.instance,n.key,s)};i.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu");e(document).off("mousedown.htContextMenu")};i.prototype.show=function(o,n){this.menu.style.display="block";e(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",t.helper.proxy(this.performAction,this));e(this.menu).handsontable({data:i.utils.convertItemsToArray(this.getItems()),colHeaders:false,colWidths:[160],readOnly:true,copyPaste:false,columns:[{data:"name",renderer:t.helper.proxy(this.renderer,this)}],beforeKeyDown:t.helper.proxy(this.onBeforeKeyDown,this)});this.bindTableEvents();this.setMenuPosition(o,n);e(this.menu).handsontable("listen")};i.prototype.close=function(){this.hide();e(document).off("mousedown.htContextMenu");this.unbindTableEvents();this.instance.listen()};i.prototype.hide=function(){this.menu.style.display="none";e(this.menu).handsontable("destroy")};i.prototype.renderer=function(o,n,r,s,a,l,c){var h=this;var u=o.getData()[r];var f=document.createElement("DIV");t.Dom.empty(n);n.appendChild(f);if(d(u)){t.Dom.addClass(n,"htSeparator")}else{t.Dom.fastInnerText(f,l)}if(p(u,h.instance)){t.Dom.addClass(n,"htDisabled");e(f).on("mouseenter",function(){o.deselectCell()})}else{t.Dom.removeClass(n,"htDisabled");e(f).on("mouseenter",function(){o.selectCell(r,s)})}function d(e){return new RegExp(i.SEPARATOR,"i").test(e.name)}function p(e,t){return e.disabled===true||typeof e.disabled=="function"&&e.disabled.call(h.instance)===true}};i.prototype.onBeforeKeyDown=function(o){var n=this;var r=e(n.menu).handsontable("getInstance");var s=r.getSelected();switch(o.keyCode){case t.helper.keyCode.ESCAPE:n.close();o.preventDefault();o.stopImmediatePropagation();break;case t.helper.keyCode.ENTER:if(r.getSelected()){n.performAction();n.close()}break;case t.helper.keyCode.ARROW_DOWN:if(!s){a(r)}else{c(s[0],s[1],r)}o.preventDefault();o.stopImmediatePropagation();break;case t.helper.keyCode.ARROW_UP:if(!s){l(r)}else{h(s[0],s[1],r)}o.preventDefault();o.stopImmediatePropagation();break}function a(e){var t=e.getCell(0,0);if(i.utils.isSeparator(t)||i.utils.isDisabled(t)){c(0,0,e)}else{e.selectCell(0,0)}}function l(e){var t=e.countRows()-1;var o=e.getCell(t,0);if(i.utils.isSeparator(o)||i.utils.isDisabled(o)){h(t,0,e)}else{e.selectCell(t,0)}}function c(e,t,o){var n=e+1;var r=n<o.countRows()?o.getCell(n,t):null;if(!r){return}if(i.utils.isSeparator(r)||i.utils.isDisabled(r)){c(n,t,o)}else{o.selectCell(n,t)}}function h(e,t,o){var n=e-1;var r=n>=0?o.getCell(n,t):null;if(!r){return}if(i.utils.isSeparator(r)||i.utils.isDisabled(r)){h(n,t,o)}else{o.selectCell(n,t)}}};i.prototype.getItems=function(){var e={};function i(e){if(typeof e=="string"){this.name=e}else{t.helper.extend(this,e)}}i.prototype=this.options;for(var o in this.options.items){if(this.options.items.hasOwnProperty(o)&&(!this.itemsFilter||this.itemsFilter.indexOf(o)!=-1)){e[o]=new i(this.options.items[o])}}return e};i.prototype.updateOptions=function(e){e=e||{};if(e.items){for(var i in e.items){var o={};if(e.items.hasOwnProperty(i)){if(this.defaultOptions.items.hasOwnProperty(i)&&t.helper.isObject(e.items[i])){t.helper.extend(o,this.defaultOptions.items[i]);t.helper.extend(o,e.items[i]);e.items[i]=o}}}}t.helper.extend(this.options,e)};i.prototype.setMenuPosition=function(e,t){var i={top:e,topRelative:e-document.documentElement.scrollTop,left:t,leftRelative:t-document.documentElement.scrollLeft};if(this.menuFitsBelowCursor(i)){this.positionMenuBelowCursor(i)}else{this.positionMenuAboveCursor(i)}if(this.menuFitsOnRightOfCursor(i)){this.positionMenuOnRightOfCursor(i)}else{this.positionMenuOnLeftOfCursor(i)}};i.prototype.menuFitsBelowCursor=function(e){return e.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight};i.prototype.menuFitsOnRightOfCursor=function(e){return e.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth};i.prototype.positionMenuBelowCursor=function(e){this.menu.style.top=e.top+"px"};i.prototype.positionMenuAboveCursor=function(e){this.menu.style.top=e.top-this.menu.offsetHeight+"px"};i.prototype.positionMenuOnRightOfCursor=function(e){this.menu.style.left=e.left+"px"};i.prototype.positionMenuOnLeftOfCursor=function(e){this.menu.style.left=e.left-this.menu.offsetWidth+"px"};i.utils={};i.utils.convertItemsToArray=function(e){var t=[];var i;for(var o in e){if(e.hasOwnProperty(o)){if(typeof e[o]=="string"){i={name:e[o]}}else if(e[o].visible!==false){i=e[o]}else{continue}i.key=o;t.push(i)}}return t};i.utils.normalizeSelection=function(e){var i={start:new t.SelectionPoint,end:new t.SelectionPoint};i.start.row(Math.min(e[0],e[2]));i.start.col(Math.min(e[1],e[3]));i.end.row(Math.max(e[0],e[2]));i.end.col(Math.max(e[1],e[3]));return i};i.utils.isSeparator=function(e){return t.Dom.hasClass(e,"htSeparator")};i.utils.isDisabled=function(e){return t.Dom.hasClass(e,"htDisabled")};i.prototype.enable=function(){if(!this.enabled){this.enabled=true;this.bindMouseEvents()}};i.prototype.disable=function(){if(this.enabled){this.enabled=false;this.close();this.unbindMouseEvents();this.unbindTableEvents()}};i.prototype.destroy=function(){this.close();this.unbindMouseEvents();this.unbindTableEvents();if(!this.isMenuEnabledByOtherHotInstance()){this.removeMenu()}};i.prototype.isMenuEnabledByOtherHotInstance=function(){var t=e(".handsontable");var i=false;for(var o=0,n=t.length;o<n;o++){var r=e(t[o]).handsontable("getInstance");if(r&&r.getSettings().contextMenu){i=true;break}}return i};i.prototype.removeMenu=function(){if(this.menu.parentNode){this.menu.parentNode.removeChild(this.menu)}};i.prototype.filterItems=function(e){this.itemsFilter=e};i.SEPARATOR="---------";function o(){var e=this;var o=e.getSettings().contextMenu;var n=t.helper.isObject(o)?o:{};if(o){if(!e.contextMenu){e.contextMenu=new i(e,n)}e.contextMenu.enable();if(t.helper.isArray(o)){e.contextMenu.filterItems(o)}}else if(e.contextMenu){e.contextMenu.destroy();delete e.contextMenu}}t.PluginHooks.add("afterInit",o);t.PluginHooks.add("afterUpdateSettings",o);t.ContextMenu=i})(i);i.PluginHooks.add("beforeGetCellMeta",function(e,t,i){i.isWritable=!i.readOnly;if(i.autoComplete){throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x")}});function h(){var t,i,o,n,r;var s=document.createElement("DIV"),a=s.style;s.className="ghost";a.position="absolute";a.top="25px";a.left=0;a.width="10px";a.height="10px";a.backgroundColor="#CCC";a.opacity=.7;var l=function(){var e=this;e.PluginHooks.run("persistentStateSave","manualColumnPositions",e.manualColumnPositions)};var c=function(){var e=this;var t={};e.PluginHooks.run("persistentStateLoad","manualColumnPositions",t);return t.value};var h=function(){var c=this;c.rootElement.on("mousemove.manualColumnMove",function(e){if(t){a.left=r+e.pageX-n+6+"px";if(a.display==="none"){a.display="block"}}});c.rootElement.on("mouseup.manualColumnMove",function(){if(t){if(i<o){o--}if(c.getSettings().rowHeaders){i--;o--}c.manualColumnPositions.splice(o,0,c.manualColumnPositions.splice(i,1)[0]);e(".manualColumnMover.active").removeClass("active");t=false;c.forceFullRender=true;c.view.render();a.display="none";l.call(c);c.PluginHooks.run("afterColumnMove",i,o)}});c.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(e){var l=e.currentTarget;var h=c.view.wt.wtDom.closest(l,"TH");i=c.view.wt.wtDom.index(h)+c.colOffset();o=i;t=true;n=e.pageX;var u=c.$table[0];u.parentNode.appendChild(s);a.width=c.view.wt.wtDom.outerWidth(h)+"px";a.height=c.view.wt.wtDom.outerHeight(u)+"px";r=parseInt(c.view.wt.wtDom.offset(h).left-c.view.wt.wtDom.offset(u).left,10);a.left=r+6+"px"});c.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(t){var e=c.view.THEAD.querySelector(".manualColumnMover.active");if(e){c.view.wt.wtDom.removeClass(e,"active")}o=c.view.wt.wtDom.index(this)+c.colOffset();var i=c.view.THEAD.querySelectorAll("th");var n=i[o].querySelector(".manualColumnMover");c.view.wt.wtDom.addClass(n,"active")}});c.addHook("afterDestroy",u)};var u=function(){var e=this;e.rootElement.off("mouseup.manualColumnMove");e.rootElement.off("mousemove.manualColumnMove");e.rootElement.off("mousedown.manualColumnMove");e.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(e){var t=this;var i=!!this.getSettings().manualColumnMove;if(i){var o=this.getSettings().manualColumnMove;var n=c.call(t);if(typeof n!="undefined"){this.manualColumnPositions=n}else if(o instanceof Array){this.manualColumnPositions=o}else{this.manualColumnPositions=[]}t.forceFullRender=true;if(e=="afterInit"){h.call(this);if(this.manualColumnPositions.length>0){this.forceFullRender=true;this.render()}}}else{u.call(this);this.manualColumnPositions=[]}};this.modifyCol=function(e){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[e]==="undefined"){this.manualColumnPositions[e]=e}return this.manualColumnPositions[e]}return e};this.getColHeader=function(e,t){if(this.getSettings().manualColumnMove){var i=document.createElement("DIV");i.className="manualColumnMover";t.firstChild.appendChild(i)}}}var u=new h;i.PluginHooks.add("beforeInit",u.beforeInit);i.PluginHooks.add("afterInit",function(){u.init.call(this,"afterInit")});i.PluginHooks.add("afterUpdateSettings",function(){u.init.call(this,"afterUpdateSettings")});i.PluginHooks.add("afterGetColHeader",u.getColHeader);i.PluginHooks.add("modifyCol",u.modifyCol);function f(){var t,i,o,n,r,s,a,l,c,h=document.createElement("DIV"),u=document.createElement("DIV"),f=document.createElement("DIV"),d=f.style;h.className="manualColumnResizer";u.className="manualColumnResizerHandle";h.appendChild(u);f.className="manualColumnResizerLine";h.appendChild(f);var p=e(document);p.mousemove(function(e){if(t){n=l+(e.pageX-a);s=C(o,n);h.style.left=c+n+"px"}});p.mouseup(function(){if(t){r.view.wt.wtDom.removeClass(h,"active");t=false;if(s!=l){r.forceFullRender=true;r.view.render();g.call(r);r.PluginHooks.run("afterColumnResize",o,s)}v.call(r,i)}});var g=function(){var e=this;e.PluginHooks.run("persistentStateSave","manualColumnWidths",e.manualColumnWidths)};var m=function(){var e=this;var t={};e.PluginHooks.run("persistentStateLoad","manualColumnWidths",t);return t.value};function v(e){r=this;i=e;var t=this.view.wt.wtTable.getCoords(e)[1];if(t>=0){o=t;var n=this.view.wt.wtDom.offset(this.rootElement[0]).left;var s=this.view.wt.wtDom.offset(e).left;c=s-n-6;h.style.left=c+parseInt(this.view.wt.wtDom.outerWidth(e),10)+"px";this.rootElement[0].appendChild(h)}}function w(){var e=this;l=parseInt(this.view.wt.wtDom.outerWidth(i),10);e.view.wt.wtDom.addClass(h,"active");d.height=e.view.wt.wtDom.outerHeight(e.$table[0])+"px";t=e}var y=function(){var e=this;var i=0;var n=null;this.rootElement.on("mouseenter.handsontable","th",function(i){if(!t){v.call(e,i.currentTarget)}});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){if(n==null){n=setTimeout(function(){if(i>=2){s=e.determineColumnWidth.call(e,o);C(o,s);e.forceFullRender=true;e.view.render();e.PluginHooks.run("afterColumnResize",o,s)}i=0;n=null},500)}i++});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(t){a=t.pageX;w.call(e);s=l})};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(e){var t=this;var i=!!this.getSettings().manualColumnResize;if(i){var o=this.getSettings().manualColumnResize;var n=m.call(t);if(typeof n!="undefined"){this.manualColumnWidths=n}else if(o instanceof Array){this.manualColumnWidths=o}else{this.manualColumnWidths=[]}if(e=="afterInit"){y.call(this);t.forceFullRender=true;t.render()}}};var C=function(e,t){t=Math.max(t,20);e=r.PluginHooks.execute("modifyCol",e);r.manualColumnWidths[e]=t;return t};this.getColWidth=function(e,t){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[e]){t.width=this.manualColumnWidths[e]}}}var d=new f;i.PluginHooks.add("beforeInit",d.beforeInit);i.PluginHooks.add("afterInit",function(){d.init.call(this,"afterInit")});i.PluginHooks.add("afterUpdateSettings",function(){d.init.call(this,"afterUpdateSettings")});i.PluginHooks.add("afterGetColWidth",d.getColWidth);(function e(){i.PluginHooks.add("afterLoadData",t);i.PluginHooks.add("afterUpdateSettings",t);function t(){var e=this;var t=e.getSettings().observeChanges;if(t){if(e.observer){r.call(e)}o.call(e);l.call(e)}else if(!t){r.call(e)}}function o(){var e=this;e.observeChangesActive=true;e.pauseObservingChanges=function(){e.observeChangesActive=false};e.resumeObservingChanges=function(){e.observeChangesActive=true};e.observedData=e.getData();e.observer=a.observe(e.observedData,function(t){if(e.observeChangesActive){n.call(e,t);e.render()}e.runHooks("afterChangesObserved")})}function n(e){var t=this;var i=a(e);for(var o=0,n=i.length;o<n;o++){var r=i[o];var s=h(r.path);switch(r.op){case"add":if(isNaN(s.col)){t.runHooks("afterCreateRow",s.row)}else{t.runHooks("afterCreateCol",s.col)}break;case"remove":if(isNaN(s.col)){t.runHooks("afterRemoveRow",s.row,1)}else{t.runHooks("afterRemoveCol",s.col,1)}break;case"replace":t.runHooks("afterChange",[s.row,s.col,null,r.value],"external");break}}function a(e){var t;t=c(e);t=l(t);return t}function l(e){var t=[];return e.filter(function(e){var i=h(e.path);if(["add","remove"].indexOf(e.op)!=-1&&!isNaN(i.col)){if(t.indexOf(i.col)!=-1){return false}else{t.push(i.col)}}return true})}function c(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function h(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}}function r(){var e=this;if(e.observer){s.call(e);c.call(e)}}function s(){var e=this;a.unobserve(e.observedData,e.observer);delete e.observeChangesActive;delete e.pauseObservingChanges;delete e.resumeObservingChanges}function l(){var e=this;e.addHook("afterDestroy",r);e.addHook("afterCreateRow",h);e.addHook("afterRemoveRow",h);e.addHook("afterCreateCol",h);e.addHook("afterRemoveCol",h);e.addHook("afterChange",function(e,t){if(t!="loadData"){h.call(this)}})}function c(){var e=this;e.removeHook("afterDestroy",r);e.removeHook("afterCreateRow",h);e.removeHook("afterRemoveRow",h);e.removeHook("afterCreateCol",h);e.removeHook("afterRemoveCol",h);e.removeHook("afterChange",h)}function h(){var e=this;e.pauseObservingChanges();e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}})();function p(e){var i;var o=function(){t.localStorage[e+"__"+"persistentStateKeys"]=JSON.stringify(i)};var n=function(){var o=t.localStorage[e+"__"+"persistentStateKeys"];var n=typeof o=="string"?JSON.parse(o):void 0;i=n?n:[]};var r=function(){i=[];o()};n();this.saveValue=function(n,r){t.localStorage[e+"_"+n]=JSON.stringify(r);if(i.indexOf(n)==-1){i.push(n);o()}};this.loadValue=function(i,o){i=typeof i!="undefined"?i:o;var n=t.localStorage[e+"_"+i];return typeof n=="undefined"?void 0:JSON.parse(n)};this.reset=function(i){t.localStorage.removeItem(e+"_"+i)};this.resetAll=function(){for(var o=0;o<i.length;o++){t.localStorage.removeItem(e+"_"+i[o])}r()}}(function(e){function t(){var t=this;this.init=function(){var i=this,r=i.getSettings()["persistentState"];t.enabled=!!r;if(!t.enabled){n.call(i);return}if(!i.storage){i.storage=new e(i.rootElement[0].id)}i.resetState=t.resetValue;o.call(i)};this.saveValue=function(e,t){var i=this;i.storage.saveValue(e,t)};this.loadValue=function(e,t){var i=this;t.value=i.storage.loadValue(e)};this.resetValue=function(e){var t=this;if(typeof e!="undefined"){t.storage.reset(e)}else{t.storage.resetAll()}};var i={persistentStateSave:t.saveValue,persistentStateLoad:t.loadValue,persistentStateReset:t.resetValue};function o(){var e=this;for(var t in i){if(i.hasOwnProperty(t)&&!r.call(e,t)){e.PluginHooks.add(t,i[t])}}}function n(){var e=this;for(var t in i){if(i.hasOwnProperty(t)&&r.call(e,t)){e.PluginHooks.remove(t,i[t])}}}function r(e){var t=this;return t.PluginHooks.hooks.hasOwnProperty(e)}}var o=new t;i.PluginHooks.add("beforeInit",o.init);i.PluginHooks.add("afterUpdateSettings",o.init)})(p);(function(t){t.UndoRedo=function(e){var i=this;this.instance=e;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;e.addHook("afterChange",function(e,o){if(e){var n=new t.UndoRedo.ChangeAction(e);i.done(n)}});e.addHook("afterCreateRow",function(e,o,n){if(n){return}var r=new t.UndoRedo.CreateRowAction(e,o);i.done(r)});e.addHook("beforeRemoveRow",function(e,o){var n=i.instance.getData();e=(n.length+e)%n.length;var r=n.slice(e,e+o);var s=new t.UndoRedo.RemoveRowAction(e,r);i.done(s)});e.addHook("afterCreateCol",function(e,o,n){if(n){return}var r=new t.UndoRedo.CreateColumnAction(e,o);i.done(r)});e.addHook("beforeRemoveCol",function(o,n){var r=i.instance.getData();o=(i.instance.countCols()+o)%i.instance.countCols();var s=[];for(var a=0,l=r.length;a<l;a++){s[a]=r[a].slice(o,o+n)}var c;if(t.helper.isArray(e.getSettings().colHeaders)){c=e.getSettings().colHeaders.slice(o,o+s.length)}var h=new t.UndoRedo.RemoveColumnAction(o,s,c);i.done(h)})};t.UndoRedo.prototype.done=function(e){if(!this.ignoreNewActions){this.doneActions.push(e);this.undoneActions.length=0}};t.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=true;e.undo(this.instance);this.ignoreNewActions=false;this.undoneActions.push(e)}};t.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=true;e.redo(this.instance);this.ignoreNewActions=true;this.doneActions.push(e)}};t.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};t.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};t.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};t.UndoRedo.Action=function(){};t.UndoRedo.Action.prototype.undo=function(){};t.UndoRedo.Action.prototype.redo=function(){};t.UndoRedo.ChangeAction=function(e){this.changes=e};t.helper.inherit(t.UndoRedo.ChangeAction,t.UndoRedo.Action);t.UndoRedo.ChangeAction.prototype.undo=function(t){var i=e.extend(true,[],this.changes);for(var o=0,n=i.length;o<n;o++){i[o].splice(3,1)}t.setDataAtRowProp(i,null,null,"undo")};t.UndoRedo.ChangeAction.prototype.redo=function(t){var i=e.extend(true,[],this.changes);for(var o=0,n=i.length;o<n;o++){i[o].splice(2,1)}t.setDataAtRowProp(i,null,null,"redo")};t.UndoRedo.CreateRowAction=function(e,t){this.index=e;this.amount=t};t.helper.inherit(t.UndoRedo.CreateRowAction,t.UndoRedo.Action);t.UndoRedo.CreateRowAction.prototype.undo=function(e){e.alter("remove_row",this.index,this.amount)};t.UndoRedo.CreateRowAction.prototype.redo=function(e){e.alter("insert_row",this.index+1,this.amount)};t.UndoRedo.RemoveRowAction=function(e,t){this.index=e;this.data=t};t.helper.inherit(t.UndoRedo.RemoveRowAction,t.UndoRedo.Action);t.UndoRedo.RemoveRowAction.prototype.undo=function(e){var t=[this.index,0];Array.prototype.push.apply(t,this.data);Array.prototype.splice.apply(e.getData(),t);e.render()};t.UndoRedo.RemoveRowAction.prototype.redo=function(e){e.alter("remove_row",this.index,this.data.length)};t.UndoRedo.CreateColumnAction=function(e,t){this.index=e;this.amount=t};t.helper.inherit(t.UndoRedo.CreateColumnAction,t.UndoRedo.Action);t.UndoRedo.CreateColumnAction.prototype.undo=function(e){e.alter("remove_col",this.index,this.amount)};t.UndoRedo.CreateColumnAction.prototype.redo=function(e){e.alter("insert_col",this.index+1,this.amount)};t.UndoRedo.RemoveColumnAction=function(e,t,i){this.index=e;this.data=t;this.amount=this.data[0].length;this.headers=i};t.helper.inherit(t.UndoRedo.RemoveColumnAction,t.UndoRedo.Action);t.UndoRedo.RemoveColumnAction.prototype.undo=function(e){var t,i;for(var o=0,n=e.getData().length;o<n;o++){t=e.getDataAtRow(o);i=[this.index,0];Array.prototype.push.apply(i,this.data[o]);Array.prototype.splice.apply(t,i)}if(typeof this.headers!="undefined"){i=[this.index,0];Array.prototype.push.apply(i,this.headers);Array.prototype.splice.apply(e.getSettings().colHeaders,i)}e.render()};t.UndoRedo.RemoveColumnAction.prototype.redo=function(e){e.alter("remove_col",this.index,this.amount)}})(i);(function(e){function t(){var t=this;var s=typeof t.getSettings().undo=="undefined"||t.getSettings().undo;if(s){if(!t.undoRedo){t.undoRedo=new e.UndoRedo(t);n(t);t.addHook("beforeKeyDown",i);t.addHook("afterChange",o)}}else{if(t.undoRedo){delete t.undoRedo;r(t);t.removeHook("beforeKeyDown",i);t.removeHook("afterChange",o)}}}function i(e){var t=this;var i=(e.ctrlKey||e.metaKey)&&!e.altKey;if(i){if(e.keyCode===89||e.shiftKey&&e.keyCode===90){t.undoRedo.redo();e.stopImmediatePropagation()}else if(e.keyCode===90){t.undoRedo.undo();e.stopImmediatePropagation()}}}function o(e,t){var i=this;if(t=="loadData"){return i.undoRedo.clear()}}function n(e){e.undo=function(){return e.undoRedo.undo()};e.redo=function(){return e.undoRedo.redo()};e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()};e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()};e.clearUndo=function(){return e.undoRedo.clear()}}function r(e){delete e.undo;delete e.redo;delete e.isUndoAvailable;delete e.isRedoAvailable;delete e.clearUndo}e.PluginHooks.add("afterInit",t);e.PluginHooks.add("afterUpdateSettings",t)})(i);function g(){this.boundaries=null;this.callback=null}g.prototype.setBoundaries=function(e){this.boundaries=e};g.prototype.setCallback=function(e){this.callback=e};g.prototype.check=function(e,t){var i=0;var o=0;if(t<this.boundaries.top){o=t-this.boundaries.top}else if(t>this.boundaries.bottom){o=t-this.boundaries.bottom}if(e<this.boundaries.left){i=e-this.boundaries.left}else if(e>this.boundaries.right){i=e-this.boundaries.right}this.callback(i,o)};var m=false;var v;var w;if(typeof i!=="undefined"){var y=function(e){var i=e.view.wt.wtScrollbars.vertical.scrollHandler;v=new g;if(i===t){return}else if(i){v.setBoundaries(i.getBoundingClientRect())}else{v.setBoundaries(e.$table[0].getBoundingClientRect())}v.setCallback(function(t,o){if(t<0){if(i){i.scrollLeft-=50}else{e.view.wt.scrollHorizontal(-1).draw()}}else if(t>0){if(i){i.scrollLeft+=50}else{e.view.wt.scrollHorizontal(1).draw()}}if(o<0){if(i){i.scrollTop-=20}else{e.view.wt.scrollVertical(-1).draw()}}else if(o>0){if(i){i.scrollTop+=20}else{e.view.wt.scrollVertical(1).draw()}}});m=true};i.PluginHooks.add("afterInit",function(){e(document).on("mouseup."+this.guid,function(){m=false});e(document).on("mousemove."+this.guid,function(e){if(m){v.check(e.clientX,e.clientY)}})});i.PluginHooks.add("destroy",function(){e(document).off("."+this.guid)});i.PluginHooks.add("afterOnCellMouseDown",function(){y(this)});i.PluginHooks.add("afterOnCellCornerMouseDown",function(){y(this)})}(function(e,t,i){function o(o){this.copyPasteInstance=t.getInstance();this.copyPasteInstance.onCut(r);this.copyPasteInstance.onPaste(s);var n=this;
o.addHook("beforeKeyDown",a);function r(){if(!o.isListening()){return}o.selection.empty()}function s(e){if(!o.isListening()||!o.selection.isSelected()){return}var t=e.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),n=i.parse(t),r=o.getSelected(),s=o.getCornerCoords([{row:r[0],col:r[1]},{row:r[2],col:r[3]}]),a=s.TL,l={row:Math.max(s.BR.row,n.length-1+s.TL.row),col:Math.max(s.BR.col,n[0].length-1+s.TL.col)};o.PluginHooks.once("afterChange",function(e,t){if(e&&e.length){this.selectCell(a.row,a.col,l.row,l.col)}});o.populateFromArray(a.row,a.col,n,l.row,l.col,"paste",o.getSettings().pasteMode)}function a(t){if(e.helper.isCtrlKey(t.keyCode)&&o.getSelected()){n.setCopyableText();t.stopImmediatePropagation();return}var i=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.keyCode==e.helper.keyCode.A&&i){setTimeout(e.helper.proxy(n.setCopyableText,n))}}this.destroy=function(){this.copyPasteInstance.removeCallback(r);this.copyPasteInstance.removeCallback(s);this.copyPasteInstance.destroy();o.removeHook("beforeKeyDown",a)};o.addHook("afterDestroy",e.helper.proxy(this.destroy,this));this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance);this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance);this.setCopyableText=function(){var e=o.getSelected();var t=o.getSettings();var i=t.copyRowsLimit;var n=t.copyColsLimit;var r=Math.min(e[0],e[2]);var s=Math.min(e[1],e[3]);var a=Math.max(e[0],e[2]);var l=Math.max(e[1],e[3]);var c=Math.min(a,r+i-1);var h=Math.min(l,s+n-1);o.copyPaste.copyPasteInstance.copyable(o.getCopyableData(r,s,c,h));if(a!==c||l!==h){o.PluginHooks.run("afterCopyLimit",a-r+1,l-s+1,i,n)}}}function n(){var e=this;var t=e.getSettings().copyPaste!==false;if(t&&!e.copyPaste){e.copyPaste=new o(e)}else if(!t&&e.copyPaste){e.copyPaste.destroy();delete e.copyPaste}}e.PluginHooks.add("afterInit",n);e.PluginHooks.add("afterUpdateSettings",n)})(i,r,SheetClip);function C(){this.maxOuts=10}C.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE;this.fixed=this.instance.wtTable.hider;this.fixedContainer=this.instance.wtTable.holder;this.fixed.style.position="absolute";this.fixed.style.left="0";this.scrollHandler=this.getScrollableElement(this.TABLE);this.$scrollHandler=e(this.scrollHandler)};C.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable";t.style.position="fixed";t.style.overflow="hidden";var i=document.createElement("TABLE");i.className=this.instance.wtTable.TABLE.className;t.appendChild(i);this.instance.wtTable.holder.parentNode.appendChild(t);return new D({cloneSource:this.instance,cloneOverlay:this,table:i})};C.prototype.getScrollableElement=function(e){var i=e.parentNode;while(i&&i.style){if(i.style.overflow!=="visible"&&i.style.overflow!==""){return i}if(this instanceof z&&i.style.overflowX!=="visible"&&i.style.overflowX!==""){return i}i=i.parentNode}return t};C.prototype.prepare=function(){};C.prototype.onScroll=function(e){this.windowScrollPosition=this.getScrollPosition();this.readSettings();if(e){this.windowScrollPosition=e}this.resetFixedPosition()};C.prototype.availableSize=function(){var e;if(this.windowScrollPosition>this.tableParentOffset){if(this.instance.wtTable.getLastVisibleRow()===this.total-1){e=this.instance.wtDom.outerHeight(this.TABLE)}else{e=this.windowSize}}else{e=this.windowSize-this.tableParentOffset}return e};C.prototype.refresh=function(e){var t=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset);if(t===-1){this.measureAfter=0}else{this.measureAfter=this.sumCellSizes(t,this.total-t)}this.applyToDOM();this.clone&&this.clone.draw(e)};C.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid);e(t).off("."+this.instance.guid);e(document).off("."+this.instance.guid)};function b(t,i){var o;this.instance=t;this.settings=i;this.wtDom=this.instance.wtDom;this.main=document.createElement("div");o=this.main.style;o.position="absolute";o.top=0;o.left=0;for(var n=0;n<5;n++){var r=document.createElement("DIV");r.className="wtBorder "+(i.className||"");o=r.style;o.backgroundColor=i.border.color;o.height=i.border.width+"px";o.width=i.border.width+"px";this.main.appendChild(r)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width="5px";this.cornerStyle.height="5px";this.cornerStyle.border="2px solid #FFF";this.disappear();if(!t.wtTable.bordersHolder){t.wtTable.bordersHolder=document.createElement("div");t.wtTable.bordersHolder.className="htBorders";t.wtTable.hider.appendChild(t.wtTable.bordersHolder)}t.wtTable.bordersHolder.appendChild(this.main);var s=false;var a=e(document.body);a.on("mousedown.walkontable."+t.guid,function(){s=true});a.on("mouseup.walkontable."+t.guid,function(){s=false});e(this.main.childNodes).on("mouseenter",function(i){if(!s||!t.getSetting("hideBorderOnMouseDownOver")){return}i.preventDefault();i.stopImmediatePropagation();var o=this.getBoundingClientRect();var n=e(this);n.hide();var r=function(e){if(e.clientY<Math.floor(o.top)){return true}if(e.clientY>Math.ceil(o.top+o.height)){return true}if(e.clientX<Math.floor(o.left)){return true}if(e.clientX>Math.ceil(o.left+o.width)){return true}};a.on("mousemove.border."+t.guid,function(e){if(r(e)){a.off("mousemove.border."+t.guid);n.show()}})})}b.prototype.appear=function(e){var t,i,o,n,r,s,a,l,c,h,u,f;if(this.disabled){return}var d=this.instance,p,g,m,v,w=false,y=false,C=false,b=false,S,T,E;if(!d.wtTable.isRowInViewport(e[0])){w=true}if(!d.wtTable.isRowInViewport(e[2])){C=true}T=d.wtTable.rowStrategy.countVisible();for(S=0;S<T;S++){E=d.wtTable.rowFilter.visibleToSource(S);if(E>=e[0]&&E<=e[2]){p=E;break}}for(S=T-1;S>=0;S--){E=d.wtTable.rowFilter.visibleToSource(S);if(E>=e[0]&&E<=e[2]){m=E;break}}if(w&&C){y=true;b=true}else{if(!d.wtTable.isColumnInViewport(e[1])){y=true}if(!d.wtTable.isColumnInViewport(e[3])){b=true}T=d.wtTable.columnStrategy.countVisible();for(S=0;S<T;S++){E=d.wtTable.columnFilter.visibleToSource(S);if(E>=e[1]&&E<=e[3]){g=E;break}}for(S=T-1;S>=0;S--){E=d.wtTable.columnFilter.visibleToSource(S);if(E>=e[1]&&E<=e[3]){v=E;break}}}if(p!==void 0&&g!==void 0){t=p!==m||g!==v;i=d.wtTable.getCell([p,g]);o=t?d.wtTable.getCell([m,v]):i;n=this.wtDom.offset(i);r=t?this.wtDom.offset(o):n;s=this.wtDom.offset(d.wtTable.TABLE);l=n.top;u=r.top+this.wtDom.outerHeight(o)-l;h=n.left;f=r.left+this.wtDom.outerWidth(o)-h;a=l-s.top-1;c=h-s.left-1;var R=this.wtDom.getComputedStyle(i);if(parseInt(R["borderTopWidth"],10)>0){a+=1;u=u>0?u-1:0}if(parseInt(R["borderLeftWidth"],10)>0){c+=1;f=f>0?f-1:0}}else{this.disappear();return}if(w){this.topStyle.display="none"}else{this.topStyle.top=a+"px";this.topStyle.left=c+"px";this.topStyle.width=f+"px";this.topStyle.display="block"}if(y){this.leftStyle.display="none"}else{this.leftStyle.top=a+"px";this.leftStyle.left=c+"px";this.leftStyle.height=u+"px";this.leftStyle.display="block"}var x=Math.floor(this.settings.border.width/2);if(C){this.bottomStyle.display="none"}else{this.bottomStyle.top=a+u-x+"px";this.bottomStyle.left=c+"px";this.bottomStyle.width=f+"px";this.bottomStyle.display="block"}if(b){this.rightStyle.display="none"}else{this.rightStyle.top=a+"px";this.rightStyle.left=c+f-x+"px";this.rightStyle.height=u+1+"px";this.rightStyle.display="block"}if(C||b||!this.hasSetting(this.settings.border.cornerVisible)){this.cornerStyle.display="none"}else{this.cornerStyle.top=a+u-4+"px";this.cornerStyle.left=c+f-4+"px";this.cornerStyle.display="block"}};b.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none"};b.prototype.hasSetting=function(e){if(typeof e==="function"){return e()}return!!e};function S(){this.offset=0;this.total=0;this.fixedCount=0}S.prototype.source=function(e){return e};S.prototype.offsetted=function(e){return e+this.offset};S.prototype.unOffsetted=function(e){return e-this.offset};S.prototype.fixed=function(e){if(e<this.fixedCount){return e-this.offset}else{return e}};S.prototype.unFixed=function(e){if(e<this.fixedCount){return e+this.offset}else{return e}};S.prototype.visibleToSource=function(e){return this.source(this.offsetted(this.fixed(e)))};S.prototype.sourceToVisible=function(e){return this.source(this.unOffsetted(this.unFixed(e)))};function T(e){this.instance=e}T.prototype.getSize=function(e){return this.cellSizes[e]};T.prototype.getContainerSize=function(e){return typeof this.containerSizeFn==="function"?this.containerSizeFn(e):this.containerSizeFn};T.prototype.countVisible=function(){return this.cellCount};T.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var e=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>e.sumCellSizes(e.offset,e.offset+e.curOuts+1)}else{return this.remainingSize>0}};function E(){this.cache=[]}E.prototype.add=function(e,t,i){if(!this.cache[e]){this.cache[e]=[]}if(!this.cache[e][t]){this.cache[e][t]=[]}this.cache[e][t][i]=true};E.prototype.test=function(e,t,i){return this.cache[e]&&this.cache[e][t]&&this.cache[e][t][i]};function R(){this.countTH=0}R.prototype=new S;R.prototype.readSettings=function(e){this.offset=e.wtSettings.settings.offsetColumn;this.total=e.getSetting("totalColumns");this.fixedCount=e.getSetting("fixedColumnsLeft");this.countTH=e.getSetting("rowHeaders").length};R.prototype.offsettedTH=function(e){return e-this.countTH};R.prototype.unOffsettedTH=function(e){return e+this.countTH};R.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.visibleToSource(this.offsettedTH(e))};R.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToVisible(e))};function x(e,t,i,o){var n,r=0;T.apply(this,arguments);this.containerSizeFn=t;this.cellSizesSum=0;this.cellSizes=[];this.cellStretch=[];this.cellCount=0;this.remainingSize=0;this.strategy=o;while(true){n=i(r);if(n===void 0){break}if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+n)){break}this.cellSizes.push(n);this.cellSizesSum+=n;this.cellCount++;r++}var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}x.prototype=new T;x.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)};x.prototype.stretch=function(){var e=this.getContainerSize(this.cellSizesSum),t=0;this.remainingSize=this.cellSizesSum-e;this.cellStretch.length=0;if(this.strategy==="all"){if(this.remainingSize<0){var i=e/this.cellSizesSum;var o;while(t<this.cellCount-1){o=Math.floor(i*this.cellSizes[t]);this.remainingSize+=o-this.cellSizes[t];this.cellStretch[t]=o-this.cellSizes[t];t++}this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}else if(this.strategy==="last"){if(this.remainingSize<0&&e!==Infinity){this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}};function D(e){var t=this,i=[];this.guid="wt_"+O();this.wtDom=new H;if(e.cloneSource){this.cloneSource=e.cloneSource;this.cloneOverlay=e.cloneOverlay;this.wtSettings=e.cloneSource.wtSettings;this.wtTable=new K(this,e.table);this.wtScroll=new V(this);this.wtViewport=e.cloneSource.wtViewport}else{this.wtSettings=new G(this,e);this.wtTable=new K(this,e.table);this.wtScroll=new V(this);this.wtViewport=new X(this);this.wtScrollbars=new U(this);this.wtWheel=new Y(this);this.wtEvent=new A(this)}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var o=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;o<n;o++){i.push(this.wtTable.THEAD.childNodes[0].childNodes[o].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(e,o){t.wtDom.fastInnerText(o,i[e])}])}}this.selections={};var r=this.getSetting("selections");if(r){for(var s in r){if(r.hasOwnProperty(s)){this.selections[s]=new $(this,r[s])}}}this.drawn=false;this.drawInterrupted=false}D.prototype.draw=function(e){this.drawInterrupted=false;if(!e&&!this.wtDom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=true;return}this.getSetting("beforeDraw",!e);e=e&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;if(this.drawn){this.scrollVertical(0);this.scrollHorizontal(0)}this.lastOffsetRow=this.getSetting("offsetRow");this.lastOffsetColumn=this.getSetting("offsetColumn");this.wtTable.draw(e);if(!this.cloneSource){this.getSetting("onDraw",!e)}return this};D.prototype.update=function(e,t){return this.wtSettings.update(e,t)};D.prototype.scrollVertical=function(e){var t=this.wtScroll.scrollVertical(e);this.getSetting("onScrollVertically");return t};D.prototype.scrollHorizontal=function(e){var t=this.wtScroll.scrollHorizontal(e);this.getSetting("onScrollHorizontally");return t};D.prototype.scrollViewport=function(e){this.wtScroll.scrollViewport(e);return this};D.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]};D.prototype.getSetting=function(e,t,i,o){return this.wtSettings.getSetting(e,t,i,o)};D.prototype.hasSetting=function(e){return this.wtSettings.has(e)};D.prototype.destroy=function(){e(document.body).off("."+this.guid);this.wtScrollbars.destroy();clearTimeout(this.wheelTimeout);this.wtEvent&&this.wtEvent.destroy()};function k(t){this.instance=t;this.init();this.clone=this.makeClone("debug");this.clone.wtTable.holder.style.opacity=.4;this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var i=this;var o;var n=0;var r=0;var s=i.clone.wtTable.holder.parentNode;e(document.body).on("mousemove."+this.instance.guid,function(e){if(!i.instance.wtTable.holder.parentNode){return}if(e.clientX-n>-5&&e.clientX-n<5&&(e.clientY-r>-5&&e.clientY-r<5)){return}n=e.clientX;r=e.clientY;H.prototype.addClass(s,"wtDebugHidden");H.prototype.removeClass(s,"wtDebugVisible");clearTimeout(o);o=setTimeout(function(){H.prototype.removeClass(s,"wtDebugHidden");H.prototype.addClass(s,"wtDebugVisible")},1e3)})}k.prototype=new C;k.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var t=this.instance.wtTable.holder.getBoundingClientRect();e.style.top=Math.ceil(t.top,10)+"px";e.style.left=Math.ceil(t.left,10)+"px"};k.prototype.prepare=function(){};k.prototype.refresh=function(e){this.clone&&this.clone.draw(e)};k.prototype.getScrollPosition=function(){};k.prototype.getLastCell=function(){};k.prototype.applyToDOM=function(){};k.prototype.scrollTo=function(){};k.prototype.readWindowSize=function(){};k.prototype.readSettings=function(){};function H(){}H.prototype.closest=function(e,t,i){while(e!=null&&e!==i){if(e.nodeType===1&&t.indexOf(e.nodeName)>-1){return e}e=e.parentNode}return null};H.prototype.isChildOf=function(e,t){var i=e.parentNode;while(i!=null){if(i==t){return true}i=i.parentNode}return false};H.prototype.index=function(e){var t=0;while(e=e.previousSibling){++t}return t};if(document.documentElement.classList){H.prototype.hasClass=function(e,t){return e.classList.contains(t)};H.prototype.addClass=function(e,t){e.classList.add(t)};H.prototype.removeClass=function(e,t){e.classList.remove(t)}}else{H.prototype.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))};H.prototype.addClass=function(e,t){if(!this.hasClass(e,t))e.className+=" "+t};H.prototype.removeClass=function(e,t){if(this.hasClass(e,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ").trim()}}}H.prototype.removeTextNodes=function(e,t){if(e.nodeType===3){t.removeChild(e)}else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){var i=e.childNodes;for(var o=i.length-1;o>=0;o--){this.removeTextNodes(i[o],e)}}};H.prototype.empty=function(e){var t;while(t=e.lastChild){e.removeChild(t)}};H.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;H.prototype.fastInnerHTML=function(e,t){if(this.HTML_CHARACTERS.test(t)){e.innerHTML=t}else{this.fastInnerText(e,t)}};if(document.createTextNode("test").textContent){H.prototype.fastInnerText=function(e,t){var i=e.firstChild;if(i&&i.nodeType===3&&i.nextSibling===null){i.textContent=t}else{this.empty(e);e.appendChild(document.createTextNode(t))}}}else{H.prototype.fastInnerText=function(e,t){var i=e.firstChild;if(i&&i.nodeType===3&&i.nextSibling===null){i.data=t}else{this.empty(e);e.appendChild(document.createTextNode(t))}}}H.prototype.isVisible=function(e){var t=e;while(t!==document.documentElement){if(t===null){return false}else if(t.nodeType===11){if(t.host){if(t.host.impl){return H.prototype.isVisible(t.host.impl)}else if(t.host){return H.prototype.isVisible(t.host)}else{throw new Error("Lost in Web Components world")}}else{return false}}else if(t.style.display==="none"){return false}t=t.parentNode}return true};H.prototype.offset=function(e){if(this.hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){var i=e.getBoundingClientRect();return{top:i.top+(t.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:i.left+(t.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}var o=e.offsetLeft,n=e.offsetTop,r=e;while(e=e.offsetParent){if(e===document.body){break}o+=e.offsetLeft;n+=e.offsetTop;r=e}if(r&&r.style.position==="fixed"){o+=t.pageXOffset||document.documentElement.scrollLeft;n+=t.pageYOffset||document.documentElement.scrollTop}return{left:o,top:n}};H.prototype.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)};H.prototype.outerWidth=function(e){return e.offsetWidth};H.prototype.outerHeight=function(e){if(this.hasCaptionProblem()&&e.firstChild&&e.firstChild.nodeName==="CAPTION"){return e.offsetHeight+e.firstChild.offsetHeight}else{return e.offsetHeight}};(function(){var e;function t(){var t=document.createElement("TABLE");t.style.borderSpacing=0;t.style.borderWidth=0;t.style.padding=0;var i=document.createElement("TBODY");t.appendChild(i);i.appendChild(document.createElement("TR"));i.firstChild.appendChild(document.createElement("TD"));i.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var o=document.createElement("CAPTION");o.innerHTML="c<br>c<br>c<br>c";o.style.padding=0;o.style.margin=0;t.insertBefore(o,i);document.body.appendChild(t);e=t.offsetHeight<2*t.lastChild.offsetHeight;document.body.removeChild(t)}H.prototype.hasCaptionProblem=function(){if(e===void 0){t()}return e};H.prototype.getCaretPosition=function(e){if(e.selectionStart){return e.selectionStart}else if(document.selection){e.focus();var t=document.selection.createRange();if(t==null){return 0}var i=e.createTextRange(),o=i.duplicate();i.moveToBookmark(t.getBookmark());o.setEndPoint("EndToStart",i);return o.text.length}return 0};H.prototype.setCaretPosition=function(e,t,i){if(i===void 0){i=t}if(e.setSelectionRange){e.focus();e.setSelectionRange(t,i)}else if(e.createTextRange){var o=e.createTextRange();o.collapse(true);o.moveEnd("character",i);o.moveStart("character",t);o.select()}};var i;function o(){var e=document.createElement("p");e.style.width="100%";e.style.height="200px";var t=document.createElement("div");t.style.position="absolute";t.style.top="0px";t.style.left="0px";t.style.visibility="hidden";t.style.width="200px";t.style.height="150px";t.style.overflow="hidden";t.appendChild(e);(document.body||document.documentElement).appendChild(t);var i=e.offsetWidth;t.style.overflow="scroll";var o=e.offsetWidth;if(i==o)o=t.clientWidth;(document.body||document.documentElement).removeChild(t);return i-o}H.prototype.getScrollbarWidth=function(){if(i===void 0){i=o()}return i}})();function A(t){var i=this;this.instance=t;this.wtDom=this.instance.wtDom;var o=[null,null];var n=[null,null];var r=function(e){var t=i.parentCell(e.target);if(i.wtDom.hasClass(e.target,"corner")){i.instance.getSetting("onCellCornerMouseDown",e,e.target)}else if(t.TD&&t.TD.nodeName==="TD"){if(i.instance.hasSetting("onCellMouseDown")){i.instance.getSetting("onCellMouseDown",e,t.coords,t.TD)}}if(e.button!==2){if(t.TD&&t.TD.nodeName==="TD"){o[0]=t.TD;clearTimeout(n[0]);n[0]=setTimeout(function(){o[0]=null},1e3)}}};var s;var a=function(e){if(i.instance.hasSetting("onCellMouseOver")){var t=i.instance.wtTable.TABLE;var o=i.wtDom.closest(e.target,["TD","TH"],t);if(o&&o!==s&&i.wtDom.isChildOf(o,t)){s=o;if(o.nodeName==="TD"){i.instance.getSetting("onCellMouseOver",e,i.instance.wtTable.getCoords(o),o)}}}};var l=function(e){if(e.button!==2){var t=i.parentCell(e.target);if(t.TD===o[0]&&t.TD===o[1]){if(i.wtDom.hasClass(e.target,"corner")){i.instance.getSetting("onCellCornerDblClick",e,t.coords,t.TD)}else if(t.TD){i.instance.getSetting("onCellDblClick",e,t.coords,t.TD)}o[0]=null;o[1]=null}else if(t.TD===o[0]){o[1]=t.TD;clearTimeout(n[1]);n[1]=setTimeout(function(){o[1]=null},500)}}};e(this.instance.wtTable.holder).on("mousedown",r);e(this.instance.wtTable.TABLE).on("mouseover",a);e(this.instance.wtTable.holder).on("mouseup",l)}A.prototype.parentCell=function(e){var t={};var i=this.instance.wtTable.TABLE;var o=this.wtDom.closest(e,["TD","TH"],i);if(o&&this.wtDom.isChildOf(o,i)){t.coords=this.instance.wtTable.getCoords(o);t.TD=o}else if(this.wtDom.hasClass(e,"wtBorder")&&this.wtDom.hasClass(e,"current")){t.coords=this.instance.selections.current.selected[0];t.TD=this.instance.wtTable.getCell(t.coords)}return t};A.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0);clearTimeout(this.dblClickTimeout1)};function P(){var e=arguments[0];var t=arguments[1];for(var i=1,o=arguments.length/2;i<o;i++){if(e<=arguments[2*i+1]&&t>=arguments[2*i]){return true}}return false}function O(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}t.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e,i){return t.setTimeout(e,1e3/60)}}();t.cancelRequestAnimFrame=function(){return t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}();if(!t.getComputedStyle){(function(){var e;var i={getPropertyValue:function t(i){if(i=="float")i="styleFloat";return e.currentStyle[i.toUpperCase()]||null}};t.getComputedStyle=function(t){e=t;return i}})()}if(!String.prototype.trim){var I=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(I,"")}}function M(){}M.prototype=new S;M.prototype.readSettings=function(e){if(e.cloneOverlay instanceof k){this.offset=0}else{this.offset=e.wtSettings.settings.offsetRow}this.total=e.getSetting("totalRows");this.fixedCount=e.getSetting("fixedRowsTop")};function N(e,t,i){T.apply(this,arguments);this.containerSizeFn=t;this.sizeAtIndex=i;this.cellSizesSum=0;this.cellSizes=[];this.cellCount=0;this.remainingSize=-Infinity}N.prototype=new T;N.prototype.add=function(e,t,i){if(!this.isLastIncomplete()&&this.remainingSize!=0){var o=this.sizeAtIndex(e,t);if(o===void 0){return false}var n=this.getContainerSize(this.cellSizesSum+o);if(i){this.cellSizes.unshift(o)}else{this.cellSizes.push(o)}this.cellSizesSum+=o;this.cellCount++;this.remainingSize=this.cellSizesSum-n;if(i&&this.isLastIncomplete()){return false}return true}return false};N.prototype.remove=function(){var e=this.cellSizes.pop();this.cellSizesSum-=e;this.cellCount--;this.remainingSize-=e};N.prototype.removeOutstanding=function(){while(this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize){this.remove()}};function V(e){this.instance=e}V.prototype.scrollVertical=function(e){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")}var t=this.instance,i,o=t.getSetting("offsetRow"),n=t.getSetting("fixedRowsTop"),r=t.getSetting("totalRows"),s=t.wtViewport.getViewportHeight();if(r>0){i=this.scrollLogicVertical(e,o,r,n,s,function(e){if(e-o<n&&e-o>=0){return t.getSetting("rowHeight",e-o)}else{return t.getSetting("rowHeight",e)}},function(e){t.wtTable.verticalRenderReverse=e})}else{i=0}if(i!==o){this.instance.wtScrollbars.vertical.scrollTo(i)}return t};V.prototype.scrollHorizontal=function(e){if(!this.instance.drawn){throw new Error("scrollHorizontal can only be called after table was drawn to DOM")}var t=this.instance,i,o=t.getSetting("offsetColumn"),n=t.getSetting("fixedColumnsLeft"),r=t.getSetting("totalColumns"),s=t.wtViewport.getViewportWidth();if(r>0){i=this.scrollLogicHorizontal(e,o,r,n,s,function(e){if(e-o<n&&e-o>=0){return t.getSetting("columnWidth",e-o)}else{return t.getSetting("columnWidth",e)}})}else{i=0}if(i!==o){this.instance.wtScrollbars.horizontal.scrollTo(i)}return t};V.prototype.scrollLogicVertical=function(e,t,i,o,n,r,s){var a=t+e;if(a>=i-o){a=i-o-1;s(true)}if(a<0){a=0}return a};V.prototype.scrollLogicHorizontal=function(e,t,i,o,n,r){var s=t+e,a=0,l;if(s>o){if(s>=i-o){s=i-o-1}l=s;while(a<n&&l<i){a+=r(l);l++}if(a<n){while(s>0){a+=r(s-1);if(a<n){s--}else{break}}}}else if(s<0){s=0}return s};V.prototype.scrollViewport=function(e){if(!this.instance.drawn){return}var i=this.instance.getSetting("offsetRow"),o=this.instance.getSetting("offsetColumn"),n=this.instance.wtTable.getLastVisibleRow(),r=this.instance.getSetting("totalRows"),s=this.instance.getSetting("totalColumns"),a=this.instance.getSetting("fixedRowsTop"),l=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var c=this.instance.wtTable.getCell(e);if(typeof c==="object"){var h=H.prototype.offset(c);var u=H.prototype.outerWidth(c);var f=H.prototype.outerHeight(c);var d=this.instance.wtScrollbars.horizontal.getScrollPosition();var p=this.instance.wtScrollbars.vertical.getScrollPosition();var g=H.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler);var m=H.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);if(this.instance.wtScrollbars.horizontal.scrollHandler!==t){h.left=h.left-H.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left}if(this.instance.wtScrollbars.vertical.scrollHandler!==t){h.top=h.top-H.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top}g-=20;m-=20;if(u<g){if(h.left<d){this.instance.wtScrollbars.horizontal.setScrollPosition(h.left)}else if(h.left+u>d+g){this.instance.wtScrollbars.horizontal.setScrollPosition(h.left-g+u)}}if(f<m){if(h.top<p){this.instance.wtScrollbars.vertical.setScrollPosition(h.top)}else if(h.top+f>p+m){this.instance.wtScrollbars.vertical.setScrollPosition(h.top-m+f)}}return}}if(e[0]<0||e[0]>r-1){throw new Error("row "+e[0]+" does not exist")}else if(e[1]<0||e[1]>s-1){throw new Error("column "+e[1]+" does not exist")}if(e[0]>n){this.scrollVertical(e[0]-a-i);this.instance.wtTable.verticalRenderReverse=true}else if(e[0]===n&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.scrollVertical(e[0]-a-i);this.instance.wtTable.verticalRenderReverse=true}else if(e[0]-a<i){this.scrollVertical(e[0]-a-i)}else{this.scrollVertical(0)}if(this.instance.wtTable.isColumnBeforeViewport(e[1])){this.instance.wtScrollbars.horizontal.scrollTo(e[1]-l)}else if(this.instance.wtTable.isColumnAfterViewport(e[1])||this.instance.wtTable.getLastVisibleColumn()===e[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){var v=0;for(var w=0;w<l;w++){v+=this.instance.getSetting("columnWidth",w)}var y=e[1];v+=this.instance.getSetting("columnWidth",y);var C=this.instance.wtViewport.getViewportWidth();if(v<C){var b=this.instance.getSetting("columnWidth",y-1);while(v+b<=C&&y>=l){y--;v+=b;b=this.instance.getSetting("columnWidth",y-1)}}this.instance.wtScrollbars.horizontal.scrollTo(y-l)}return this.instance};function L(){}L.prototype.init=function(){var t=this;this.$table=e(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.sliderStyle=this.slider.style;this.sliderStyle.position="absolute";this.sliderStyle.top="0";this.sliderStyle.left="0";this.sliderStyle.display="none";this.slider.className="dragdealer "+this.type;this.handle=document.createElement("DIV");this.handleStyle=this.handle.style;this.handle.className="handle";this.slider.appendChild(this.handle);this.container=this.instance.wtTable.holder;this.container.appendChild(this.slider);var i=true;this.dragTimeout=null;var o;var n=function(){t.onScroll(o)};this.dragdealer=new J(this.slider,{vertical:this.type==="vertical",horizontal:this.type==="horizontal",slide:false,speed:100,animationCallback:function(e,r){if(i){i=false;return}t.skipRefresh=true;o=t.type==="vertical"?r:e;if(t.dragTimeout===null){t.dragTimeout=setInterval(n,100);n()}},callback:function(e,i){t.skipRefresh=false;clearInterval(t.dragTimeout);t.dragTimeout=null;o=t.type==="vertical"?i:e;t.onScroll(o)}});this.skipRefresh=false};L.prototype.onScroll=function(e){if(this.instance.drawn){this.readSettings();if(this.total>this.visibleCount){var t=Math.round(this.handlePosition*this.total/this.sliderSize);if(e===1){if(this.type==="vertical"){this.instance.scrollVertical(Infinity).draw()}else{this.instance.scrollHorizontal(Infinity).draw()}}else if(t!==this.offset){if(this.type==="vertical"){this.instance.scrollVertical(t-this.offset).draw()}else{this.instance.scrollHorizontal(t-this.offset).draw()}}else{this.refresh()}}}};L.prototype.getHandleSizeRatio=function(e,t){if(!t||e>t||e==t){return 1}return 1/t};L.prototype.prepare=function(){if(this.skipRefresh){return}var e=this.getHandleSizeRatio(this.visibleCount,this.total);if((e===1||isNaN(e))&&this.scrollMode==="auto"||this.scrollMode==="none"){this.visible=false}else{this.visible=true}};L.prototype.refresh=function(){if(this.skipRefresh){return}else if(!this.visible){this.sliderStyle.display="none";return}var e,t,i,o,n=this.visibleCount,r=this.instance.wtViewport.getWorkspaceWidth(),s=this.instance.wtViewport.getWorkspaceHeight();if(r===Infinity){r=this.instance.wtViewport.getWorkspaceActualWidth()}if(s===Infinity){s=this.instance.wtViewport.getWorkspaceActualHeight()}if(this.type==="vertical"){if(this.instance.wtTable.rowStrategy.isLastIncomplete()){n--}t=s-2;this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px";this.sliderStyle.left=r-1+"px";this.sliderStyle.height=Math.max(t,0)+"px"}else{t=r-2;this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px";this.sliderStyle.top=s-1+"px";this.sliderStyle.width=Math.max(t,0)+"px"}e=this.getHandleSizeRatio(n,this.total);i=Math.round(t*e);if(i<10){i=15}o=Math.floor(t*(this.offset/this.total));if(i+o>t){o=t-i}if(this.type==="vertical"){this.handleStyle.height=i+"px";this.handleStyle.top=o+"px"}else{this.handleStyle.width=i+"px";this.handleStyle.left=o+"px"}this.sliderStyle.display="block"};L.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var B=function(e){this.instance=e;this.type="vertical";this.init()};B.prototype=new L;B.prototype.scrollTo=function(e){this.instance.update("offsetRow",e)};B.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV");this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows");this.visibleCount=this.instance.wtTable.rowStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.top,10);this.sliderSize=parseInt(this.sliderStyle.height,10);this.fixedCount=this.instance.getSetting("fixedRowsTop")};var W=function(e){this.instance=e;this.type="horizontal";
this.init()};W.prototype=new L;W.prototype.scrollTo=function(e){this.instance.update("offsetColumn",e)};W.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH");this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns");this.visibleCount=this.instance.wtTable.columnStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.left,10);this.sliderSize=parseInt(this.sliderStyle.width,10);this.fixedCount=this.instance.getSetting("fixedColumnsLeft")};W.prototype.getHandleSizeRatio=function(e,t){if(!t||e>t||e==t){return 1}return e/t};function _(e){this.instance=e;this.init();this.clone=this.makeClone("corner")}_.prototype=new C;_.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var i;if(this.scrollHandler===t){i=this.instance.wtTable.hider.getBoundingClientRect();var o=Math.ceil(i.top,10);var n=Math.ceil(i.bottom,10);if(o<0&&n>0){e.style.top="0"}else{e.style.top=o+"px"}var r=Math.ceil(i.left,10);var s=Math.ceil(i.right,10);if(r<0&&s>0){e.style.left="0"}else{e.style.left=r+"px"}}else{i=this.scrollHandler.getBoundingClientRect();e.style.top=Math.ceil(i.top,10)+"px";e.style.left=Math.ceil(i.left,10)+"px"}e.style.width=H.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px";e.style.height=H.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"};_.prototype.prepare=function(){};_.prototype.refresh=function(e){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(e)};_.prototype.getScrollPosition=function(){};_.prototype.getLastCell=function(){};_.prototype.applyToDOM=function(){};_.prototype.scrollTo=function(){};_.prototype.readWindowSize=function(){};_.prototype.readSettings=function(){};function z(e){this.instance=e;this.type="horizontal";this.cellSize=50;this.init();this.clone=this.makeClone("left")}z.prototype=new C;z.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var i;if(this.scrollHandler===t){i=this.instance.wtTable.hider.getBoundingClientRect();var o=Math.ceil(i.left,10);var n=Math.ceil(i.right,10);if(o<0&&n>0){e.style.left="0"}else{e.style.left=o+"px"}}else{i=this.scrollHandler.getBoundingClientRect();e.style.top=Math.ceil(i.top,10)+"px";e.style.left=Math.ceil(i.left,10)+"px"}};z.prototype.react=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;if(this.instance.wtScrollbars.vertical.scrollHandler===t){var i=this.instance.wtTable.hider.getBoundingClientRect();e.style.top=Math.ceil(i.top,10)+"px";e.style.height=H.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"}else{this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px";e.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px"}e.style.width=H.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px"};z.prototype.prepare=function(){};z.prototype.refresh=function(e){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(e)};z.prototype.getScrollPosition=function(){if(this.scrollHandler===t){return this.scrollHandler.scrollX}else{return this.scrollHandler.scrollLeft}};z.prototype.setScrollPosition=function(e){this.scrollHandler.scrollLeft=e};z.prototype.onScroll=function(){C.prototype.onScroll.apply(this,arguments);this.instance.getSetting("onScrollHorizontally")};z.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()};z.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px";this.fixedContainer.style.paddingRight=this.measureAfter+"px"};z.prototype.scrollTo=function(e){this.$scrollHandler.scrollLeft(this.tableParentOffset+e*this.cellSize)};z.prototype.readWindowSize=function(){if(this.scrollHandler===t){this.windowSize=document.documentElement.clientWidth;this.tableParentOffset=this.instance.wtTable.holderOffset.left}else{this.windowSize=H.prototype.outerWidth(this.scrollHandler);this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()};z.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns")};function F(e){this.instance=e;this.type="vertical";this.cellSize=23;this.init();this.clone=this.makeClone("top")}F.prototype=new C;F.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var e=this.clone.wtTable.holder.parentNode;var i;if(this.scrollHandler===t){i=this.instance.wtTable.hider.getBoundingClientRect();var o=Math.ceil(i.top,10);var n=Math.ceil(i.bottom,10);if(o<0&&n>0){e.style.top="0"}else{e.style.top=o+"px"}}else{i=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect();e.style.top=Math.ceil(i.top,10)+"px";e.style.left=Math.ceil(i.left,10)+"px"}if(this.instance.wtScrollbars.horizontal.scrollHandler===t){e.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px"}else{e.style.width=H.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px"}e.style.height=H.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"};F.prototype.react=function(){if(!this.instance.wtTable.holder.parentNode){return}if(this.instance.wtScrollbars.horizontal.scrollHandler!==t){var e=this.clone.wtTable.holder.parentNode;e.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"}};F.prototype.getScrollPosition=function(){if(this.scrollHandler===t){return this.scrollHandler.scrollY}else{return this.scrollHandler.scrollTop}};F.prototype.setScrollPosition=function(e){this.scrollHandler.scrollTop=e};F.prototype.onScroll=function(e){C.prototype.onScroll.apply(this,arguments);var t;var i=0;if(1==1||this.windowScrollPosition>this.tableParentOffset){t=this.windowScrollPosition-this.tableParentOffset;j=0;if(t>0){var o=0;var n;for(var r=0;r<this.total;r++){n=this.instance.getSetting("rowHeight",r);o+=n;if(o>t){break}}if(this.offset>0){j=o-t}i=r;i=Math.min(i,this.total)}}this.curOuts=i>this.maxOuts?this.maxOuts:i;i-=this.curOuts;this.instance.update("offsetRow",i);this.readSettings();this.instance.draw();this.instance.getSetting("onScrollVertically")};F.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};var j=0;F.prototype.sumCellSizes=function(e,t){var i=0;while(e<t){i+=this.instance.getSetting("rowHeight",e);e++}return i};F.prototype.applyToDOM=function(){var e=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=e+this.sumCellSizes(0,this.total)+4+"px";this.fixed.style.top=this.measureBefore+"px";this.fixed.style.bottom=""};F.prototype.scrollTo=function(e){var t=this.tableParentOffset+e*this.cellSize;this.$scrollHandler.scrollTop(t);this.onScroll(t)};F.prototype.readWindowSize=function(){if(this.scrollHandler===t){this.windowSize=document.documentElement.clientHeight;this.tableParentOffset=this.instance.wtTable.holderOffset.top}else{this.windowSize=this.scrollHandler.clientHeight;this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()};F.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows")};function U(e){this.instance=e;if(e.getSetting("nativeScrollbars")){e.update("scrollbarWidth",e.wtDom.getScrollbarWidth());e.update("scrollbarHeight",e.wtDom.getScrollbarWidth());this.vertical=new F(e);this.horizontal=new z(e);this.corner=new _(e);if(e.getSetting("debug")){this.debug=new k(e)}this.registerListeners()}else{this.vertical=new B(e);this.horizontal=new W(e)}}U.prototype.registerListeners=function(){var i=this;var o,n,r,s,a,l;function c(){if(!i.instance.wtTable.holder.parentNode){i.destroy();return}i.vertical.windowScrollPosition=i.vertical.getScrollPosition();i.horizontal.windowScrollPosition=i.horizontal.getScrollPosition();i.box=i.instance.wtTable.hider.getBoundingClientRect();if((i.box.width!==a||i.box.height!==l)&&i.instance.rowHeightCache){a=i.box.width;l=i.box.height;i.instance.draw()}if(i.vertical.windowScrollPosition!==o||i.horizontal.windowScrollPosition!==n||i.box.top!==r||i.box.left!==s){i.vertical.onScroll();i.horizontal.onScroll();i.vertical.react();i.horizontal.react();o=i.vertical.windowScrollPosition;n=i.horizontal.windowScrollPosition;r=i.box.top;s=i.box.left}}var h=e(t);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,c);if(this.vertical.scrollHandler!==this.horizontal.scrollHandler){this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,c)}if(this.vertical.scrollHandler!==t&&this.horizontal.scrollHandler!==t){h.on("scroll."+this.instance.guid,c)}h.on("load."+this.instance.guid,c);h.on("resize."+this.instance.guid,c);e(document).on("ready."+this.instance.guid,c);setInterval(c,100)};U.prototype.destroy=function(){this.vertical&&this.vertical.destroy();this.horizontal&&this.horizontal.destroy()};U.prototype.refresh=function(e){this.horizontal&&this.horizontal.readSettings();this.vertical&&this.vertical.readSettings();this.horizontal&&this.horizontal.prepare();this.vertical&&this.vertical.prepare();this.horizontal&&this.horizontal.refresh(e);this.vertical&&this.vertical.refresh(e);this.corner&&this.corner.refresh(e);this.debug&&this.debug.refresh(e)};function $(e,t){this.instance=e;this.settings=t;this.selected=[];if(t.border){this.border=new b(e,t)}}$.prototype.add=function(e){this.selected.push(e)};$.prototype.clear=function(){this.selected.length=0};$.prototype.getCorners=function(){var e,t,i,o,n,r=this.selected.length;if(r>0){e=i=this.selected[0][0];t=o=this.selected[0][1];if(r>1){for(n=1;n<r;n++){if(this.selected[n][0]<e){e=this.selected[n][0]}else if(this.selected[n][0]>i){i=this.selected[n][0]}if(this.selected[n][1]<t){t=this.selected[n][1]}else if(this.selected[n][1]>o){o=this.selected[n][1]}}}}return[e,t,i,o]};$.prototype.draw=function(){var e,t,i,o,n;var r=this.instance.wtTable.rowStrategy.countVisible(),s=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){e=this.getCorners();for(t=0;t<r;t++){for(i=0;i<s;i++){o=this.instance.wtTable.rowFilter.visibleToSource(t);n=this.instance.wtTable.columnFilter.visibleToSource(i);if(o>=e[0]&&o<=e[2]&&n>=e[1]&&n<=e[3]){this.instance.wtTable.currentCellCache.add(t,i,this.settings.className)}else if(o>=e[0]&&o<=e[2]){this.instance.wtTable.currentCellCache.add(t,i,this.settings.highlightRowClassName)}else if(n>=e[1]&&n<=e[3]){this.instance.wtTable.currentCellCache.add(t,i,this.settings.highlightColumnClassName)}}}this.border&&this.border.appear(e)}else{this.border&&this.border.disappear()}};function G(e,t){var i=this;this.instance=e;this.defaults={table:void 0,debug:false,scrollH:"auto",scrollV:"auto",nativeScrollbars:false,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(e,t,o){var n=i.getSetting("data",e,t);i.instance.wtDom.fastInnerText(o,n===void 0||n===null?"":n)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:false,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(var o in this.defaults){if(this.defaults.hasOwnProperty(o)){if(t[o]!==void 0){this.settings[o]=t[o]}else if(this.defaults[o]===void 0){throw new Error('A required setting "'+o+'" was not provided')}else{this.settings[o]=this.defaults[o]}}}}G.prototype.update=function(e,t){if(t===void 0){for(var i in e){if(e.hasOwnProperty(i)){this.settings[i]=e[i]}}}else{this.settings[e]=t}return this.instance};G.prototype.getSetting=function(e,t,i,o){if(this[e]){return this[e](t,i,o)}else{return this._getSetting(e,t,i,o)}};G.prototype._getSetting=function(e,t,i,o){if(typeof this.settings[e]==="function"){return this.settings[e](t,i,o)}else if(t!==void 0&&Object.prototype.toString.call(this.settings[e])==="[object Array]"){return this.settings[e][t]}else{return this.settings[e]}};G.prototype.has=function(e){return!!this.settings[e]};G.prototype.rowHeight=function(e,t){if(!this.instance.rowHeightCache){this.instance.rowHeightCache=[]}if(this.instance.rowHeightCache[e]===void 0){var i=23;if(t){i=this.instance.wtDom.outerHeight(t);this.instance.rowHeightCache[e]=i}return i}else{return this.instance.rowHeightCache[e]}};function K(e,t){this.instance=e;this.TABLE=t;this.wtDom=this.instance.wtDom;this.wtDom.removeTextNodes(this.TABLE);var i=this.TABLE.parentNode;if(!i||i.nodeType!==1||!this.wtDom.hasClass(i,"wtHolder")){var o=document.createElement("DIV");o.className="wtSpreader";if(i){i.insertBefore(o,this.TABLE)}o.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;i=this.spreader.parentNode;if(!i||i.nodeType!==1||!this.wtDom.hasClass(i,"wtHolder")){var n=document.createElement("DIV");n.className="wtHider";if(i){i.insertBefore(n,this.spreader)}n.appendChild(this.spreader)}this.hider=this.spreader.parentNode;this.hiderStyle=this.hider.style;this.hiderStyle.position="relative";i=this.hider.parentNode;if(!i||i.nodeType!==1||!this.wtDom.hasClass(i,"wtHolder")){var r=document.createElement("DIV");r.style.position="relative";r.className="wtHolder";if(i){i.insertBefore(r,this.hider)}r.appendChild(this.hider)}this.holder=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.getSetting("columnHeaders").length){if(!this.THEAD.childNodes.length){var s=document.createElement("TR");this.THEAD.appendChild(s)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.oldCellCache=new E;this.currentCellCache=new E;this.rowFilter=new M;this.columnFilter=new R;this.verticalRenderReverse=false}K.prototype.refreshHiderDimensions=function(){var e=this.instance.wtViewport.getWorkspaceHeight();var t=this.instance.wtViewport.getWorkspaceWidth();var i=this.spreader.style;if((e!==Infinity||t!==Infinity)&&!this.instance.getSetting("nativeScrollbars")){if(e===Infinity){e=this.instance.wtViewport.getWorkspaceActualHeight()}if(t===Infinity){t=this.instance.wtViewport.getWorkspaceActualWidth()}this.hiderStyle.overflow="hidden";i.position="absolute";i.top="0";i.left="0";if(!this.instance.getSetting("nativeScrollbars")){i.height="4000px";i.width="4000px"}if(e<0){e=0}this.hiderStyle.height=e+"px";this.hiderStyle.width=t+"px"}else{i.position="relative";i.width="auto";i.height="auto"}};K.prototype.refreshStretching=function(){if(this.instance.cloneSource){return}var e=this.instance,t=e.getSetting("stretchH"),i=e.getSetting("totalRows"),o=e.getSetting("totalColumns"),n=e.getSetting("offsetColumn");var r=function(e){var t=s.instance.wtViewport.getViewportWidth(e);if(t<e&&s.instance.getSetting("nativeScrollbars")){return Infinity}return t};var s=this;var a=function(t){var i=s.columnFilter.visibleToSource(t);if(i<o){return e.getSetting("columnWidth",i)}};if(t==="hybrid"){if(n>0){t="last"}else{t="none"}}var l=function(e){if(s.instance.getSetting("nativeScrollbars")){if(s.instance.cloneOverlay instanceof k){return Infinity}else{return 2*s.instance.wtViewport.getViewportHeight(e)}}return s.instance.wtViewport.getViewportHeight(e)};var c=function(e,t){if(s.instance.getSetting("nativeScrollbars")){return 20}var o=s.rowFilter.visibleToSource(e);if(o<i){if(s.verticalRenderReverse&&e===0){return s.instance.getSetting("rowHeight",o,t)-1}else{return s.instance.getSetting("rowHeight",o,t)}}};this.columnStrategy=new x(e,r,a,t);this.rowStrategy=new N(e,l,c)};K.prototype.adjustAvailableNodes=function(){var e,t=this.instance.getSetting("rowHeaders"),i=t.length,o=this.instance.getSetting("columnHeaders"),n,r,s;while(this.colgroupChildrenLength<i){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}this.refreshStretching();if(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof z||this.instance.cloneOverlay instanceof _)){e=this.instance.getSetting("fixedColumnsLeft")}else{e=this.columnStrategy.cellCount}while(this.colgroupChildrenLength<e+i){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}while(this.colgroupChildrenLength>e+i){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.colgroupChildrenLength--}n=this.THEAD.firstChild;if(o.length){if(!n){n=document.createElement("TR");this.THEAD.appendChild(n)}this.theadChildrenLength=n.childNodes.length;while(this.theadChildrenLength<e+i){n.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>e+i){n.removeChild(n.lastChild);this.theadChildrenLength--}}else if(n){this.wtDom.empty(n)}for(s=0;s<this.colgroupChildrenLength;s++){if(s<i){this.wtDom.addClass(this.COLGROUP.childNodes[s],"rowHeader")}else{this.wtDom.removeClass(this.COLGROUP.childNodes[s],"rowHeader")}}if(o.length){n=this.THEAD.firstChild;if(i){r=n.firstChild;for(s=0;s<i;s++){t[s](-i+s,r);r=r.nextSibling}}}for(s=0;s<e;s++){if(o.length){o[0](this.columnFilter.visibleToSource(s),n.childNodes[i+s])}}};K.prototype.adjustColumns=function(e,t){var i=e.childNodes.length;while(i<t){var o=document.createElement("TD");e.appendChild(o);i++}while(i>t){e.removeChild(e.lastChild);i--}};K.prototype.draw=function(e){if(this.instance.getSetting("nativeScrollbars")){this.verticalRenderReverse=false}this.rowFilter.readSettings(this.instance);this.columnFilter.readSettings(this.instance);if(!e){if(this.instance.getSetting("nativeScrollbars")){if(this.instance.cloneSource){this.tableOffset=this.instance.cloneSource.wtTable.tableOffset}else{this.holderOffset=this.wtDom.offset(this.holder);this.tableOffset=this.wtDom.offset(this.TABLE);this.instance.wtScrollbars.vertical.readWindowSize();this.instance.wtScrollbars.horizontal.readWindowSize();this.instance.wtViewport.resetSettings()}}else{this.tableOffset=this.wtDom.offset(this.TABLE);this.instance.wtViewport.resetSettings()}this._doDraw()}else{this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(true)}this.refreshPositions(e);if(!e){if(this.instance.getSetting("nativeScrollbars")){if(!this.instance.cloneSource){this.instance.wtScrollbars.vertical.resetFixedPosition();this.instance.wtScrollbars.horizontal.resetFixedPosition();this.instance.wtScrollbars.corner.resetFixedPosition();this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition()}}}this.instance.drawn=true;return this};K.prototype._doDraw=function(){var e=0,t,i,o,n=this.instance.getSetting("offsetRow"),r=this.instance.getSetting("totalRows"),s=this.instance.getSetting("totalColumns"),a,l=this.instance.getSetting("rowHeaders"),c=l.length,h,u,f,d=false,p,g,m;if(this.verticalRenderReverse){g=n}var v=false;if(this.verticalRenderReverse){if(n===r-this.rowFilter.fixedCount-1){v=true}else{this.instance.update("offsetRow",n+1);this.rowFilter.readSettings(this.instance)}}if(this.instance.cloneSource){this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy;this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy}if(s>0){t=this.rowFilter.visibleToSource(e);var w=this.instance.getSetting("fixedRowsTop");var y;if(this.instance.cloneSource){if(this.instance.cloneOverlay instanceof F||this.instance.cloneOverlay instanceof _){y=w}else if(this.instance.cloneOverlay instanceof z){y=this.rowStrategy.countVisible()}}this.adjustAvailableNodes();d=true;if(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof z||this.instance.cloneOverlay instanceof _)){a=this.instance.getSetting("fixedColumnsLeft")}else{a=this.columnStrategy.cellCount}if(!this.instance.cloneSource){p=this.instance.wtViewport.getWorkspaceWidth();this.columnStrategy.stretch()}for(i=0;i<a;i++){this.COLGROUP.childNodes[i+c].style.width=this.columnStrategy.getSize(i)+"px"}while(t<r&&t>=0){if(e>1e3){throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.")}if(y!==void 0&&e===y){break}if(e>=this.tbodyChildrenLength||this.verticalRenderReverse&&e>=this.rowFilter.fixedCount){h=document.createElement("TR");for(i=0;i<c;i++){h.appendChild(document.createElement("TH"))}if(this.verticalRenderReverse&&e>=this.rowFilter.fixedCount){this.TBODY.insertBefore(h,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild)}else{this.TBODY.appendChild(h)}this.tbodyChildrenLength++}else if(e===0){h=this.TBODY.firstChild}else{h=h.nextSibling}f=h.firstChild;for(i=0;i<c;i++){if(f.nodeName=="TD"){u=f;f=document.createElement("TH");h.insertBefore(f,u);h.removeChild(u)}l[i](t,f);f=f.nextSibling}this.adjustColumns(h,a+c);for(i=0;i<a;i++){o=this.columnFilter.visibleToSource(i);if(i===0){u=h.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]}else{u=u.nextSibling}if(u.nodeName=="TH"){f=u;u=document.createElement("TD");h.insertBefore(u,f);h.removeChild(f)}u.className="";u.removeAttribute("style");this.instance.getSetting("cellRenderer",t,o,u)}n=this.instance.getSetting("offsetRow");if(this.verticalRenderReverse&&v){if(-this.wtDom.outerHeight(h.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(h);this.instance.update("offsetRow",n+1);this.tbodyChildrenLength--;this.rowFilter.readSettings(this.instance);break}else if(!this.instance.cloneSource){m=this.rowStrategy.add(e,u,this.verticalRenderReverse);if(m===false){this.rowStrategy.removeOutstanding()}}}else if(!this.instance.cloneSource){m=this.rowStrategy.add(e,u,this.verticalRenderReverse);if(m===false){if(!this.instance.getSetting("nativeScrollbars")){this.rowStrategy.removeOutstanding()}}if(this.rowStrategy.isLastIncomplete()){if(this.verticalRenderReverse&&!this.isRowInViewport(g)){this.verticalRenderReverse=false;this.instance.update("offsetRow",g);this.draw();return}break}}if(this.instance.getSetting("nativeScrollbars")){if(this.instance.cloneSource){h.style.height=this.instance.getSetting("rowHeight",t)+"px"}else{this.instance.getSetting("rowHeight",t,u)}}if(this.verticalRenderReverse&&e>=this.rowFilter.fixedCount){if(n===0){break}this.instance.update("offsetRow",n-1);this.rowFilter.readSettings(this.instance)}else{e++}t=this.rowFilter.visibleToSource(e)}}if(!d){this.adjustAvailableNodes()}if(!(this.instance.cloneOverlay instanceof k)){e=this.rowStrategy.countVisible();while(this.tbodyChildrenLength>e){this.TBODY.removeChild(this.TBODY.lastChild);this.tbodyChildrenLength--}}this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(false);if(!this.instance.cloneSource){if(p!==this.instance.wtViewport.getWorkspaceWidth()){this.columnStrategy.stretch();for(i=0;i<this.columnStrategy.cellCount;i++){this.COLGROUP.childNodes[i+c].style.width=this.columnStrategy.getSize(i)+"px"}}}this.verticalRenderReverse=false};K.prototype.refreshPositions=function(e){this.refreshHiderDimensions();this.refreshSelections(e)};K.prototype.refreshSelections=function(e){var t,i,o,n,r,s,a=[],l=this.rowStrategy.countVisible(),c=this.columnStrategy.countVisible();this.oldCellCache=this.currentCellCache;this.currentCellCache=new E;if(this.instance.selections){for(i in this.instance.selections){if(this.instance.selections.hasOwnProperty(i)){this.instance.selections[i].draw();if(this.instance.selections[i].settings.className){a.push(this.instance.selections[i].settings.className)}if(this.instance.selections[i].settings.highlightRowClassName){a.push(this.instance.selections[i].settings.highlightRowClassName)}if(this.instance.selections[i].settings.highlightColumnClassName){a.push(this.instance.selections[i].settings.highlightColumnClassName)}}}}s=a.length;for(t=0;t<l;t++){for(o=0;o<c;o++){i=this.rowFilter.visibleToSource(t);n=this.columnFilter.visibleToSource(o);for(r=0;r<s;r++){if(this.currentCellCache.test(t,o,a[r])){this.wtDom.addClass(this.getCell([i,n]),a[r])}else if(e&&this.oldCellCache.test(t,o,a[r])){this.wtDom.removeClass(this.getCell([i,n]),a[r])}}}}};K.prototype.getCell=function(e){if(this.isRowBeforeViewport(e[0])){return-1}else if(this.isRowAfterViewport(e[0])){return-2}else{if(this.isColumnBeforeViewport(e[1])){return-3}else if(this.isColumnAfterViewport(e[1])){return-4}else{return this.TBODY.childNodes[this.rowFilter.sourceToVisible(e[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e[1])]}}};K.prototype.getCoords=function(e){return[this.rowFilter.visibleToSource(this.wtDom.index(e.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex)]};K.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)};K.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)};K.prototype.isRowBeforeViewport=function(e){return this.rowFilter.sourceToVisible(e)<this.rowFilter.fixedCount&&e>=this.rowFilter.fixedCount};K.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()};K.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToVisible(e)<this.columnFilter.fixedCount&&e>=this.columnFilter.fixedCount};K.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()};K.prototype.isRowInViewport=function(e){return!this.isRowBeforeViewport(e)&&!this.isRowAfterViewport(e)};K.prototype.isColumnInViewport=function(e){return!this.isColumnBeforeViewport(e)&&!this.isColumnAfterViewport(e)};K.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()};K.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()};function X(i){this.instance=i;this.resetSettings();if(this.instance.getSetting("nativeScrollbars")){var o=this;e(t).on("resize",function(){o.clientHeight=o.getWorkspaceHeight()})}}X.prototype.getWorkspaceHeight=function(e){if(this.instance.getSetting("nativeScrollbars")){return this.instance.wtScrollbars.vertical.windowSize}var t=this.instance.getSetting("height");if(t===Infinity||t===void 0||t===null||t<1){if(this.instance.wtScrollbars.vertical instanceof C){t=this.instance.wtScrollbars.vertical.availableSize()}else{t=Infinity}}if(t!==Infinity){if(e>=t){t-=this.instance.getSetting("scrollbarHeight")}else if(this.instance.wtScrollbars.horizontal.visible){t-=this.instance.getSetting("scrollbarHeight")}}return t};X.prototype.getWorkspaceWidth=function(e){var t=this.instance.getSetting("width");if(t===Infinity||t===void 0||t===null||t<1){if(this.instance.wtScrollbars.horizontal instanceof C){t=this.instance.wtScrollbars.horizontal.availableSize()}else{t=Infinity}}if(t!==Infinity){if(e>=t){t-=this.instance.getSetting("scrollbarWidth")}else if(this.instance.wtScrollbars.vertical.visible){t-=this.instance.getSetting("scrollbarWidth")}}return t};X.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)};X.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)};X.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var e=this.instance.wtDom.offset(this.instance.wtTable.TBODY),t=this.instance.wtTable.tableOffset;this.columnHeaderHeight=e.top-t.top}return this.columnHeaderHeight};X.prototype.getViewportHeight=function(e){var t=this.getWorkspaceHeight(e);if(t===Infinity){return t}var i=this.getColumnHeaderHeight();if(i>0){return t-i}else{return t}};X.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource){return this.instance.cloneSource.wtViewport.getRowHeaderWidth()}if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var t=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,o=e.length;i<o;i++){if(t){this.rowHeaderWidth+=this.instance.wtDom.outerWidth(t);t=t.nextSibling}else{this.rowHeaderWidth+=50}}}else{this.rowHeaderWidth=0}}return this.rowHeaderWidth};X.prototype.getViewportWidth=function(e){var t=this.getWorkspaceWidth(e);if(t===Infinity){return t}var i=this.getRowHeaderWidth();if(i>0){return t-i}else{return t}};X.prototype.resetSettings=function(){this.rowHeaderWidth=NaN;this.columnHeaderHeight=NaN};function Y(t){if(t.getSetting("nativeScrollbars")){return}e(t.wtTable.spreader).on("mousewheel",function(e,i,o,n){if(!o&&!n&&i){n=i}if(!o&&!n){return}if(n>0&&t.getSetting("offsetRow")===0){return}else if(n<0&&t.wtTable.isLastRowFullyVisible()){return}else if(o<0&&t.getSetting("offsetColumn")===0){return}else if(o>0&&t.wtTable.isLastColumnFullyVisible()){return}clearTimeout(t.wheelTimeout);t.wheelTimeout=setTimeout(function(){if(n){if(t.wtScrollbars.vertical.visible){t.scrollVertical(-Math.ceil(n)).draw()}}else if(o){if(t.wtScrollbars.horizontal.visible){t.scrollHorizontal(Math.ceil(o)).draw()}}},0);e.preventDefault()})}var q={x:0,y:0,init:function(){this.setEvent("mouse");this.setEvent("touch")},setEvent:function(e){var t=document["on"+e+"move"]||function(){};document["on"+e+"move"]=function(e){t(e);q.refresh(e)}},refresh:function(e){if(!e){e=t.event}if(e.type=="mousemove"){this.set(e)}else if(e.touches){this.set(e.touches[0])}},set:function(e){if(e.pageX||e.pageY){this.x=e.pageX;this.y=e.pageY}else if(document.body&&(e.clientX||e.clientY)){this.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;this.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}}};q.init();var Q={get:function(e){var t=0,i=0;if(e.offsetParent){do{i+=e.offsetLeft;t+=e.offsetTop}while(e=e.offsetParent)}return[i,t]}};var J=function(e,t){if(typeof e=="string"){e=document.getElementById(e)}if(!e){return}var i=e.getElementsByTagName("div")[0];if(!i||i.className.search(/(^|\s)handle(\s|$)/)==-1){return}this.init(e,i,t||{});this.setup()};J.prototype={init:function(e,t,i){this.wrapper=e;this.handle=t;this.options=i;this.disabled=this.getOption("disabled",false);this.horizontal=this.getOption("horizontal",true);this.vertical=this.getOption("vertical",false);this.slide=this.getOption("slide",true);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",false);this.loose=this.getOption("loose",false);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=i.callback||null;this.animationCallback=i.animationCallback||null;this.bounds={left:i.left||0,right:-(i.right||0),top:i.top||0,bottom:-(i.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[i.x||0,i.y||0],target:[i.x||0,i.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.activity=false;this.dragging=false;this.tapping=false},getOption:function(e,t){return this.options[e]!==undefined?this.options[e]:t},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=Q.get(this.wrapper)
},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=Q.get(this.handle)[0]-this.offset.wrapper[0];this.bounds.right=-this.bounds.left}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=Q.get(this.handle)[1]-this.offset.wrapper[1];this.bounds.bottom=-this.bounds.top}},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth;this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var e=0;e<=this.steps-1;e++){this.stepRatios[e]=e/(this.steps-1)}}},addListeners:function(){var e=this;this.wrapper.onselectstart=function(){return false};this.handle.onmousedown=this.handle.ontouchstart=function(t){e.handleDownHandler(t)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(t){e.wrapperDownHandler(t)};var i=document.onmouseup||function(){};document.onmouseup=function(t){i(t);e.documentUpHandler(t)};var o=document.ontouchend||function(){};document.ontouchend=function(t){o(t);e.documentUpHandler(t)};var n=t.onresize||function(){};t.onresize=function(t){n(t);e.documentResizeHandler(t)};this.wrapper.onmousemove=function(t){e.activity=true};this.wrapper.onclick=function(t){return!e.activity};this.interval=setInterval(function(){e.animate()},25);e.animate(false,true)},handleDownHandler:function(e){this.activity=false;q.refresh(e);this.preventDefaults(e,true);this.startDrag()},wrapperDownHandler:function(e){q.refresh(e);this.preventDefaults(e,true);this.startTap()},documentUpHandler:function(e){this.stopDrag();this.stopTap()},documentResizeHandler:function(e){this.setWrapperOffset();this.setBounds();this.update()},enable:function(){this.disabled=false;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=true;this.handle.className+=" disabled"},setStep:function(e,t,i){this.setValue(this.steps&&e>1?(e-1)/(this.steps-1):0,this.steps&&t>1?(t-1)/(this.steps-1):0,i)},setValue:function(e,t,i){this.setTargetValue([e,t||0]);if(i){this.groupCopy(this.value.current,this.value.target)}},startTap:function(e){if(this.disabled){return}this.tapping=true;this.setWrapperOffset();this.setBounds();if(e===undefined){e=[q.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,q.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]}this.setTargetOffset(e)},stopTap:function(){if(this.disabled||!this.tapping){return}this.tapping=false;this.setTargetValue(this.value.current);this.result()},startDrag:function(){if(this.disabled){return}this.setWrapperOffset();this.setBounds();this.offset.mouse=[q.x-Q.get(this.handle)[0],q.y-Q.get(this.handle)[1]];this.dragging=true},stopDrag:function(){if(this.disabled||!this.dragging){return}this.dragging=false;var e=this.groupClone(this.value.current);if(this.slide){var t=this.change;e[0]+=t[0]*4;e[1]+=t[1]*4}this.setTargetValue(e);this.result()},feedback:function(){var e=this.value.current;if(this.snap&&this.steps>1){e=this.getClosestSteps(e)}if(!this.groupCompare(e,this.value.prev)){if(typeof this.animationCallback=="function"){this.animationCallback(e[0],e[1])}this.groupCopy(this.value.prev,e)}},result:function(){if(typeof this.callback=="function"){this.callback(this.value.target[0],this.value.target[1])}},animate:function(e,t){if(e&&!this.dragging){return}if(this.dragging){var i=this.groupClone(this.value.target);var o=[q.x-this.offset.wrapper[0]-this.offset.mouse[0],q.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(o,this.loose);this.change=[this.value.target[0]-i[0],this.value.target[1]-i[1]]}if(this.dragging||t){this.groupCopy(this.value.current,this.value.target)}if(this.dragging||this.glide()||t){this.update();this.feedback()}},glide:function(){var e=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];if(!e[0]&&!e[1]){return false}if(Math.abs(e[0])>this.bounds.xStep||Math.abs(e[1])>this.bounds.yStep){this.value.current[0]+=e[0]*this.speed;this.value.current[1]+=e[1]*this.speed}else{this.groupCopy(this.value.current,this.value.target)}return true},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))}this.show()},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"}this.groupCopy(this.offset.prev,this.offset.current)}},setTargetValue:function(e,t){var i=t?this.getLooseValue(e):this.getProperValue(e);this.groupCopy(this.value.target,i);this.offset.target=this.getOffsetsByRatios(i)},setTargetOffset:function(e,t){var i=this.getRatiosByOffsets(e);var o=t?this.getLooseValue(i):this.getProperValue(i);this.groupCopy(this.value.target,o);this.offset.target=this.getOffsetsByRatios(o)},getLooseValue:function(e){var t=this.getProperValue(e);return[t[0]+(e[0]-t[0])/4,t[1]+(e[1]-t[1])/4]},getProperValue:function(e){var t=this.groupClone(e);t[0]=Math.max(t[0],0);t[1]=Math.max(t[1],0);t[0]=Math.min(t[0],1);t[1]=Math.min(t[1],1);if(!this.dragging&&!this.tapping||this.snap){if(this.steps>1){t=this.getClosestSteps(t)}}return t},getRatiosByOffsets:function(e){return[this.getRatioByOffset(e[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(e[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(e,t,i){return t?(e-i)/t:0},getOffsetsByRatios:function(e){return[this.getOffsetByRatio(e[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(e[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(e,t,i){return Math.round(e*t)+i},getClosestSteps:function(e){return[this.getClosestStep(e[0]),this.getClosestStep(e[1])]},getClosestStep:function(e){var t=0;var i=1;for(var o=0;o<=this.steps-1;o++){if(Math.abs(this.stepRatios[o]-e)<i){i=Math.abs(this.stepRatios[o]-e);t=o}}return this.stepRatios[t]},groupCompare:function(e,t){return e[0]==t[0]&&e[1]==t[1]},groupCopy:function(e,t){e[0]=t[0];e[1]=t[1]},groupClone:function(e){return[e[0],e[1]]},preventDefaults:function(e,i){if(!e){e=t.event}if(e.preventDefault){e.preventDefault()}e.returnValue=false;if(i&&document.selection){document.selection.empty()}},cancelEvent:function(e){if(!e){e=t.event}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true}};(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e}else{e(jQuery)}})(function(e){var i=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"];var o="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];var n,r;if(e.event.fixHooks){for(var s=i.length;s;){e.event.fixHooks[i[--s]]=e.event.mouseHooks}}e.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var e=o.length;e;){this.addEventListener(o[--e],a,false)}}else{this.onmousewheel=a}},teardown:function(){if(this.removeEventListener){for(var e=o.length;e;){this.removeEventListener(o[--e],a,false)}}else{this.onmousewheel=null}}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}});function a(i){var o=i||t.event,s=[].slice.call(arguments,1),a=0,l=0,c=0,h=0,u=0,f;i=e.event.fix(o);i.type="mousewheel";if(o.wheelDelta){a=o.wheelDelta}if(o.detail){a=o.detail*-1}if(o.deltaY){c=o.deltaY*-1;a=c}if(o.deltaX){l=o.deltaX;a=l*-1}if(o.wheelDeltaY!==undefined){c=o.wheelDeltaY}if(o.wheelDeltaX!==undefined){l=o.wheelDeltaX*-1}h=Math.abs(a);if(!n||h<n){n=h}u=Math.max(Math.abs(c),Math.abs(l));if(!r||u<r){r=u}f=a>0?"floor":"ceil";a=Math[f](a/n);l=Math[f](l/r);c=Math[f](c/r);s.unshift(i,a,l,c);return(e.event.dispatch||e.event.handle).apply(this,s)}})})(jQuery,window,Handsontable);(function(){var e,t="1.4.7",i={},o="en",n=null,r=typeof module!=="undefined"&&module.exports;function s(e){this._n=e}function a(e,t,i){var o=Math.pow(10,t),n;n=(Math.round(e*o)/o).toFixed(t);if(i){var r=new RegExp("0{1,"+i+"}$");n=n.replace(r,"")}return n}function l(e,t){var i;if(t.indexOf("$")>-1){i=h(e,t)}else if(t.indexOf("%")>-1){i=u(e,t)}else if(t.indexOf(":")>-1){i=f(e,t)}else{i=p(e,t)}return i}function c(e,t){if(t.indexOf(":")>-1){e._n=d(t)}else{if(t===n){e._n=0}else{var r=t;if(i[o].delimiters.decimal!=="."){t=t.replace(/\./g,"").replace(i[o].delimiters.decimal,".")}var s=new RegExp(i[o].abbreviations.thousand+"(?:\\)|(\\"+i[o].currency.symbol+")?(?:\\))?)?$"),a=new RegExp(i[o].abbreviations.million+"(?:\\)|(\\"+i[o].currency.symbol+")?(?:\\))?)?$"),l=new RegExp(i[o].abbreviations.billion+"(?:\\)|(\\"+i[o].currency.symbol+")?(?:\\))?)?$"),c=new RegExp(i[o].abbreviations.trillion+"(?:\\)|(\\"+i[o].currency.symbol+")?(?:\\))?)?$");var h=["KB","MB","GB","TB","PB","EB","ZB","YB"],u=false;for(var f=0;f<=h.length;f++){u=t.indexOf(h[f])>-1?Math.pow(1024,f+1):false;if(u){break}}e._n=(u?u:1)*(r.match(s)?Math.pow(10,3):1)*(r.match(a)?Math.pow(10,6):1)*(r.match(l)?Math.pow(10,9):1)*(r.match(c)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*Number((t.indexOf("(")>-1?"-":"")+t.replace(/[^0-9\.-]+/g,""));e._n=u?Math.ceil(e._n):e._n}}return e._n}function h(e,t){var n=t.indexOf("$")<=1?true:false;var r="";if(t.indexOf(" $")>-1){r=" ";t=t.replace(" $","")}else if(t.indexOf("$ ")>-1){r=" ";t=t.replace("$ ","")}else{t=t.replace("$","")}var s=l(e,t);if(n){if(s.indexOf("(")>-1||s.indexOf("-")>-1){s=s.split("");s.splice(1,0,i[o].currency.symbol+r);s=s.join("")}else{s=i[o].currency.symbol+r+s}}else{if(s.indexOf(")")>-1){s=s.split("");s.splice(-1,0,r+i[o].currency.symbol);s=s.join("")}else{s=s+r+i[o].currency.symbol}}return s}function u(e,t){var i="";if(t.indexOf(" %")>-1){i=" ";t=t.replace(" %","")}else{t=t.replace("%","")}e._n=e._n*100;var o=l(e,t);if(o.indexOf(")")>-1){o=o.split("");o.splice(-1,0,i+"%");o=o.join("")}else{o=o+i+"%"}return o}function f(e,t){var i=Math.floor(e._n/60/60),o=Math.floor((e._n-i*60*60)/60),n=Math.round(e._n-i*60*60-o*60);return i+":"+(o<10?"0"+o:o)+":"+(n<10?"0"+n:n)}function d(e){var t=e.split(":"),i=0;if(t.length===3){i=i+Number(t[0])*60*60;i=i+Number(t[1])*60;i=i+Number(t[2])}else if(t.lenght===2){i=i+Number(t[0])*60;i=i+Number(t[1])}return Number(i)}function p(e,t){var r=false,s=false,l="",c="",h="",u=Math.abs(e._n);if(e._n===0&&n!==null){return n}else{if(t.indexOf("(")>-1){r=true;t=t.slice(1,-1)}if(t.indexOf("a")>-1){if(t.indexOf(" a")>-1){l=" ";t=t.replace(" a","")}else{t=t.replace("a","")}if(u>=Math.pow(10,12)){l=l+i[o].abbreviations.trillion;e._n=e._n/Math.pow(10,12)}else if(u<Math.pow(10,12)&&u>=Math.pow(10,9)){l=l+i[o].abbreviations.billion;e._n=e._n/Math.pow(10,9)}else if(u<Math.pow(10,9)&&u>=Math.pow(10,6)){l=l+i[o].abbreviations.million;e._n=e._n/Math.pow(10,6)}else if(u<Math.pow(10,6)&&u>=Math.pow(10,3)){l=l+i[o].abbreviations.thousand;e._n=e._n/Math.pow(10,3)}}if(t.indexOf("b")>-1){if(t.indexOf(" b")>-1){c=" ";t=t.replace(" b","")}else{t=t.replace("b","")}var f=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],d,p;for(var g=0;g<=f.length;g++){d=Math.pow(1024,g);p=Math.pow(1024,g+1);if(e._n>=d&&e._n<p){c=c+f[g];if(d>0){e._n=e._n/d}break}}}if(t.indexOf("o")>-1){if(t.indexOf(" o")>-1){h=" ";t=t.replace(" o","")}else{t=t.replace("o","")}h=h+i[o].ordinal(e._n)}if(t.indexOf("[.]")>-1){s=true;t=t.replace("[.]",".")}var m=e._n.toString().split(".")[0],v=t.split(".")[1],w=t.indexOf(","),y="",C=false;if(v){if(v.indexOf("[")>-1){v=v.replace("]","");v=v.split("[");y=a(e._n,v[0].length+v[1].length,v[1].length)}else{y=a(e._n,v.length)}m=y.split(".")[0];if(y.split(".")[1].length){y=i[o].delimiters.decimal+y.split(".")[1]}else{y=""}if(s&&Number(y)===0){y=""}}else{m=a(e._n,null)}if(m.indexOf("-")>-1){m=m.slice(1);C=true}if(w>-1){m=m.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+i[o].delimiters.thousands)}if(t.indexOf(".")===0){m=""}return(r&&C?"(":"")+(!r&&C?"-":"")+m+y+(h?h:"")+(l?l:"")+(c?c:"")+(r&&C?")":"")}}e=function(t){if(e.isNumeral(t)){t=t.value()}else if(!Number(t)){t=0}return new s(Number(t))};e.version=t;e.isNumeral=function(e){return e instanceof s};e.language=function(t,n){if(!t){return o}if(t&&!n){o=t}if(n||!i[t]){g(t,n)}return e};e.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return~~(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th"},currency:{symbol:"$"}});e.zeroFormat=function(e){if(typeof e==="string"){n=e}else{n=null}};function g(e,t){i[e]=t}e.fn=s.prototype={clone:function(){return e(this)},format:function(t){return l(this,t?t:e.defaultFormat)},unformat:function(t){return c(this,t?t:e.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(e){this._n=Number(e);return this},add:function(e){this._n=this._n+Number(e);return this},subtract:function(e){this._n=this._n-Number(e);return this},multiply:function(e){this._n=this._n*Number(e);return this},divide:function(e){this._n=this._n/Number(e);return this},difference:function(e){var t=this._n-Number(e);if(t<0){t=-t}return t}};if(r){module.exports=e}if(typeof ender==="undefined"){this["numeral"]=e}if(typeof define==="function"&&define.amd){define([],function(){return e})}}).call(this);
